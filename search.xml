<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>win10çš„typoraé…ç½®giteeäº‘å›¾åºŠ</title>
    <url>/posts/fd71e1c8/</url>
    <content><![CDATA[<h5 id="1-ç›¸å…³å‡†å¤‡å‡†å¤‡"><a href="#1-ç›¸å…³å‡†å¤‡å‡†å¤‡" class="headerlink" title="1.ç›¸å…³å‡†å¤‡å‡†å¤‡"></a>1.ç›¸å…³å‡†å¤‡å‡†å¤‡</h5><ul>
<li><a href="https://www.typora.io/">Typora</a></li>
<li><a href="https://github.com/Molunerfinn/PicGo/releases">PicGo</a></li>
<li>gitee/githubè´¦å·</li>
</ul>
<h5 id="2-gitee-githubç›¸å…³é…ç½®"><a href="#2-gitee-githubç›¸å…³é…ç½®" class="headerlink" title="2. gitee/githubç›¸å…³é…ç½®"></a>2. gitee/githubç›¸å…³é…ç½®</h5><ol>
<li><p>æ–°å»ºä»“åº“ï¼ˆ<strong>ä¸€å®šè¦æ˜¯å…¬å¼€çš„ï¼Œä¸ç„¶mdåˆ°æ—¶å€™æ— æ³•è®¿é—®</strong>ï¼‰</p>
</li>
<li><p>ç”ŸæˆToken ï¼Œ<strong>ä¿å­˜Token</strong></p>
<p> åœ¨è‡ªå·²çš„ç”¨æˆ·ä¸­å¿ƒç”Ÿæˆç§äººä»¤ç‰Œ</p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224175635.png" alt="image-20210224175635044"></p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224175714.png" alt="image-20210224175714200"></p>
</li>
</ol>
<h5 id="3-PicGOç›¸å…³é…ç½®"><a href="#3-PicGOç›¸å…³é…ç½®" class="headerlink" title="3. PicGOç›¸å…³é…ç½®"></a>3. PicGOç›¸å…³é…ç½®</h5><h6 id="3-1-GitHubè®¾ç½®"><a href="#3-1-GitHubè®¾ç½®" class="headerlink" title="3.1 GitHubè®¾ç½®"></a>3.1 GitHubè®¾ç½®</h6><p><a href="https://blog.csdn.net/yefcion/article/details/88412025">åŸæ–‡åœ°å€</a></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224180016.png" alt="image-20210224180016463"></p>
<ul>
<li>ä»“åº“å å³ä½ çš„ä»“åº“å</li>
<li>åˆ†æ”¯å é»˜è®¤ <code>master</code></li>
<li>Token å°±æ˜¯åˆšåˆšå¤åˆ¶çš„é‚£ä¸€ä¸²å­—ç¬¦</li>
<li>å­˜å‚¨è·¯å¾„ è¿™ä¸ªå¯ä»¥å¡«ä¹Ÿå¯ä»¥ä¸å¡«ï¼Œå¡«äº†çš„è¯å›¾ç‰‡å°±ä¸Šä¼ åˆ° git ä¸­ <code>data</code> è¿™ä¸ªæ–‡ä»¶å¤¹</li>
<li>åŸŸå <code>https://raw.githubusercontent.com/yefcion/cloudimg/master</code>è¿™ä¸ªè¦æ”¹ä¸€ä¸‹ æ ¼å¼ <code>https://raw.githubusercontent.com/[username]/[ä»“åº“å]/master</code></li>
</ul>
<h6 id="3-2-Giteeè®¾ç½®"><a href="#3-2-Giteeè®¾ç½®" class="headerlink" title="3.2 Giteeè®¾ç½®"></a>3.2 Giteeè®¾ç½®</h6><ol>
<li><p>ä¸‹è½½æ’ä»¶gitee-uploader</p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224180247.png" alt="image-20210224180247392"></p>
</li>
<li><p>è®¾ç½®Giteeå¹¶è®¾ç½®ä¸ºé»˜è®¤å›¾åºŠï¼ˆGithubæ˜¯å¤–ç½‘ï¼Œå¯èƒ½ä¼šæ…¢ï¼Œæ•…é€‰æ‹©giteeä¸ºé»˜è®¤ï¼‰</p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224195106.png" alt="image-20210224195106781"></p>
</li>
</ol>
<h6 id="3-3-PicGOè®¾ç½®"><a href="#3-3-PicGOè®¾ç½®" class="headerlink" title="3.3 PicGOè®¾ç½®"></a>3.3 PicGOè®¾ç½®</h6><p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224195211.png" alt="image-20210224195211867"></p>
<h5 id="4-Typoraè®¾ç½®"><a href="#4-Typoraè®¾ç½®" class="headerlink" title="4.Typoraè®¾ç½®"></a>4.Typoraè®¾ç½®</h5><p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224195433.png" alt="image-20210224195433511"></p>
]]></content>
      <categories>
        <category>Typora</category>
        <category>Gitee</category>
        <category>Github</category>
      </categories>
      <tags>
        <tag>Typora</tag>
        <tag>Gitee</tag>
        <tag>Github</tag>
      </tags>
  </entry>
  <entry>
    <title>win10çš„æ­å»ºhexoåšå®¢</title>
    <url>/posts/1bab7c20/</url>
    <content><![CDATA[<h5 id="1-ç¯å¢ƒé…ç½®"><a href="#1-ç¯å¢ƒé…ç½®" class="headerlink" title="1. ç¯å¢ƒé…ç½®"></a>1. ç¯å¢ƒé…ç½®</h5><p><strong>å®‰è£…å‰å‡†å¤‡</strong></p>
<ul>
<li>git</li>
<li>Nodejs</li>
</ul>
<h5 id="2ã€Hexoå®‰è£…"><a href="#2ã€Hexoå®‰è£…" class="headerlink" title="2ã€Hexoå®‰è£…"></a>2ã€Hexoå®‰è£…</h5><ol>
<li><p>é¦–å…ˆé…ç½®npmçš„<strong>æ·˜å®æº</strong>,å®‰è£…å®Œæˆåå¯é€šè¿‡npm info hexoæŸ¥çœ‹æ˜¯å¦é…ç½®æ·˜å®æºæˆåŠŸ</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®‰è£…hexo</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">npm install -g hexo</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŒ‡å®šå®‰è£…çš„hexoç›®å½•</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">hexo init test</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> test     </span><br><span class="line"></span><br><span class="line">npm install</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸ</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">hexo clean      #æ¸…é™¤ç¼“å­˜</span><br><span class="line">hexo g      #ç”Ÿæˆé™æ€ç½‘é¡µ</span><br><span class="line">hexo s      #å¯åŠ¨æœ¬åœ°æœåŠ¡</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224200606.png" alt="image-20210224200605821"></p>
</li>
</ol>
<h5 id="3-Gtihubç›¸å…³é…ç½®"><a href="#3-Gtihubç›¸å…³é…ç½®" class="headerlink" title="3. Gtihubç›¸å…³é…ç½®"></a>3. Gtihubç›¸å…³é…ç½®</h5><p>New repositoryåˆ›å»ºæ–°ä»“åº“ï¼Œä»“åº“ååº”è¯¥ä¸ºï¼š<strong>ç”¨æˆ·å</strong>.<a href="https://link.zhihu.com/?target=http://github.io">http://github.io</a> è¿™ä¸ª<strong>ç”¨æˆ·å</strong>ä½¿ç”¨ä½ çš„GitHubå¸å·åç§°ä»£æ›¿ï¼Œè¿™æ˜¯å›ºå®šå†™æ³•ï¼Œæ¯”å¦‚æˆ‘çš„ä»“åº“åä¸ºï¼š</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224200752.png" alt="image-20210224200752872"></p>
<h5 id="4-hexoé…ç½®è¿œç¨‹éƒ¨ç½²"><a href="#4-hexoé…ç½®è¿œç¨‹éƒ¨ç½²" class="headerlink" title="4. hexoé…ç½®è¿œç¨‹éƒ¨ç½²"></a>4. hexoé…ç½®è¿œç¨‹éƒ¨ç½²</h5><p>ä¿®æ”¹æ ¹ç›®å½•ä¸‹çš„<strong>_config.yml</strong> æ–‡ä»¶ä¸­é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/CNRF/CNRF.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ç›¸å…³å‘½ä»¤è¿›è¡Œéƒ¨ç½²</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo d  # ç¬¬ä¸€æ¬¡éƒ¨ç½²ä¼šæç¤ºè¾“å…¥githubçš„è´¦å·å’Œå¯†ç </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoéƒ¨ç½²ç¬¬ä¸‰æ–¹ä¸»é¢˜next 7.8ç‰ˆæœ¬</title>
    <url>/posts/d23fb963/</url>
    <content><![CDATA[<h5 id="1-next-7-8-ä¸»é¢˜å®‰è£…"><a href="#1-next-7-8-ä¸»é¢˜å®‰è£…" class="headerlink" title="1. next 7.8 ä¸»é¢˜å®‰è£…"></a>1. next 7.8 ä¸»é¢˜å®‰è£…</h5><p><a href="https://github.com/theme-next/hexo-theme-next/archive/v7.8.0.zip">7.8.0ç‰ˆæœ¬ä¸‹è½½è¿æ¥</a></p>
<ol>
<li><p>å°†ä¸‹è½½å¥½çš„ä¸»é¢˜æ–‡ä»¶è§£å‹åˆ°hexoä¸»ç›®å½•ä¸‹çš„themesæ–‡ä»¶å¤¹ä¸‹</p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224204119.png" alt="image-20210224204118992"></p>
</li>
<li><p>åœ¨ä¸»ç›®å½•çš„sourceä¸‹æ–°å»º<strong>_data</strong>ç›®å½•ï¼Œå°†<strong>ç¬¬ä¸‰æ–¹ä¸»é¢˜</strong>ä¸­çš„<strong>_config.yml</strong>æ–‡ä»¶å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸‹é‡å‘½åä¸ºnext.yml,å¹¶ä¿®æ”¹æ–‡ä»¶ä¸­<strong>overrideä¸ºtrue</strong></p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224203110.png" alt="image-20210224203110673"></p>
 <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">override:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹ä¸»ç›®å½•çš„<strong>_config.yml</strong>æ–‡ä»¶ï¼Œå¯ç”¨ä¸»é¢˜</p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224203236.png" alt="image-20210224203236580"></p>
 <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”Ÿæˆnextä¸»é¢˜å¼€å¯çš„ç•Œé¢</p>
<p> <img src="https://gitee.com/CNRF/image/raw/master/img/20210224203417.png"></p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">hexo new page home</span><br><span class="line">hexo new page archives</span><br><span class="line">hexo new page about</span><br><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br><span class="line">hexo new page commonweal</span><br></pre></td></tr></table></figure>

</li>
</ol>
]]></content>
      <categories>
        <category>Hexo</category>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¿®å¤ç‚¹å‡»ç›®å½•æ— æ³•è·³è½¬</title>
    <url>/posts/14f8dec7/</url>
    <content><![CDATA[<p>åœ¨ themes/next/source/js/util.js ä¸­å¢åŠ ä¸¤è¡Œä»£ç ï¼Œåˆ é™¤ä¸¤è¡Œä»£ç ã€‚ä¿å­˜ï¼Œhexo clean &amp; hexo g &amp; hexo s å³å¯è§£å†³ã€‚ï¼ˆå¦‚æœè¿˜æ˜¯ä¸è¡Œå°±åˆ é™¤æµè§ˆå™¨ç¼“å­˜é‡è¯•ï¼‰</p>
<p><a href="https://github.com/theme-next/hexo-theme-next/pull/1540/files">ä¸­æ–‡ç›®å½•å±‚çº§æ— æ³•è·³è½¬</a></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210225115114.png" alt="image-20210225115114883"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">registerSidebarTOC: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> navItems = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;.post-toc li&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> sections = [...navItems].map(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> link = element.querySelector(<span class="string">&#x27;a.nav-link&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> target = <span class="built_in">document</span>.getElementById(<span class="built_in">decodeURI</span>(link.getAttribute(<span class="string">&#x27;href&#x27;</span>)).replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>));</span><br><span class="line">    <span class="comment">// TOC item animation navigate.</span></span><br><span class="line">    link.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">      event.preventDefault();</span><br><span class="line">      <span class="comment">// var target = document.getElementById(event.currentTarget.getAttribute(&#x27;href&#x27;).replace(&#x27;#&#x27;, &#x27;&#x27;));</span></span><br><span class="line">      <span class="keyword">var</span> offset = target.getBoundingClientRect().top + <span class="built_in">window</span>.scrollY;</span><br><span class="line">      <span class="built_in">window</span>.anime(&#123;</span><br><span class="line">        targets  : <span class="built_in">document</span>.scrollingElement,</span><br><span class="line">        duration : <span class="number">500</span>,</span><br><span class="line">        easing   : <span class="string">&#x27;linear&#x27;</span>,</span><br><span class="line">        scrollTop: offset + <span class="number">10</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">    <span class="comment">// return document.getElementById(link.getAttribute(&#x27;href&#x27;).replace(&#x27;#&#x27;, &#x27;&#x27;));</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Hexo</category>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo+NexTåšå®¢å½’æ¡£/æ ‡ç­¾/åˆ†ç±»é¡µç¾åŒ–</title>
    <url>/posts/be9758cd/</url>
    <content><![CDATA[<p>NexTè‡ªå¸¦çš„<code>å½’æ¡£</code>ã€<code>æ ‡ç­¾</code>ã€<code>åˆ†ç±»</code>é¡µçš„æ ·å¼æ¯”è¾ƒå•ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ ·å¼æ–‡ä»¶ä¸­æ·»åŠ ä¸€äº›<code>css</code>é…ç½®æ¥å°†æˆ‘ä»¬æƒ³è¦çš„æ ·å¼æ·»åŠ åˆ°è¿™äº›é¡µé¢ä¸­ï¼Œæœ¬æ–‡å°±æ¥ä»‹ç»å¦‚ä½•æ·»åŠ æˆ–ä¿®æ”¹è¿™äº›é¡µé¢çš„æ ·å¼ã€‚</p>
<h1 id="å½©è‰²æ ‡ç­¾é¡µ"><a href="#å½©è‰²æ ‡ç­¾é¡µ" class="headerlink" title="å½©è‰²æ ‡ç­¾é¡µ"></a>å½©è‰²æ ‡ç­¾é¡µ</h1><ol>
<li>åœ¨ /themes/next/layout/ ç›®å½•ä¸‹ï¼Œæ–°å¢ tag-color.swig æ–‡ä»¶ï¼Œå¡«å…¥å¦‚ä¸‹å†…å®¹:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">     var alltags &#x3D; document.getElementsByClassName(&#39;tag-cloud-tags&#39;);</span><br><span class="line">     var tags &#x3D; alltags[0].getElementsByTagName(&#39;a&#39;);</span><br><span class="line">     for (var i &#x3D; tags.length - 1; i &gt;&#x3D; 0; i--) &#123;</span><br><span class="line">       var r&#x3D;Math.floor(Math.random()*75+130);</span><br><span class="line">       var g&#x3D;Math.floor(Math.random()*75+100);</span><br><span class="line">       var b&#x3D;Math.floor(Math.random()*75+80);</span><br><span class="line">       tags[i].style.background &#x3D; &quot;rgb(&quot;+r+&quot;,&quot;+g+&quot;,&quot;+b+&quot;)&quot;;</span><br><span class="line">     &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .tag-cloud-tags&#123;</span><br><span class="line">    &#x2F;*font-family: Helvetica, Tahoma, Arial;*&#x2F;</span><br><span class="line">    &#x2F;*font-weight: 100;*&#x2F;</span><br><span class="line">    text-align: center;</span><br><span class="line">    counter-reset: tags;</span><br><span class="line">  &#125;</span><br><span class="line">  .tag-cloud-tags a&#123;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    padding-right: 5px;</span><br><span class="line">    padding-left: 5px;</span><br><span class="line">    margin: 8px 5px 0px 0px;</span><br><span class="line">  &#125;</span><br><span class="line">  .tag-cloud-tags a:before&#123;</span><br><span class="line">    content: &quot;ğŸ”–&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tag-cloud-tags a:hover&#123;</span><br><span class="line">     box-shadow: 0px 5px 15px 0px rgba(0,0,0,.4);</span><br><span class="line">     transform: scale(1.1);</span><br><span class="line">     &#x2F;*box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);*&#x2F;</span><br><span class="line">     transition-duration: 0.15s;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨åŒçº§ç›®å½•çš„ page.swig ä¸­å¼•å…¥ tag-color.swig</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;tag-cloud&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- ç›®å‰å…±è®¡xxxä¸ªæ ‡ç­¾</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;tag-cloud-title&quot;</span>&gt;</span><br><span class="line">            &#123;&#123; _p(<span class="string">&#x27;counter.tag_cloud&#x27;</span>, site.tags.length) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        --&gt;</span><br><span class="line">    </span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;tag-cloud-tags&quot;</span>&gt;</span><br><span class="line">          &#123;&#123; tagcloud(&#123;<span class="attr">min_font</span>: <span class="number">10</span>, <span class="attr">max_font</span>: <span class="number">15</span>, <span class="attr">amount</span>: <span class="number">300</span>, <span class="attr">color</span>: <span class="literal">true</span>, <span class="attr">start_color</span>: <span class="string">&#x27;#ccc&#x27;</span>, <span class="attr">end_color</span>: <span class="string">&#x27;#111&#x27;</span>&#125;) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">+     &#123;% include <span class="string">&#x27;tag-color.swig&#x27;</span> %&#125;</span><br><span class="line">    </span><br><span class="line">    &#123;% elif page.type === <span class="string">&#x27;categories&#x27;</span> %&#125;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;category-all-page&quot;</span>&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;category-all-title&quot;</span>&gt;</span><br><span class="line">            &#123;&#123; _p(<span class="string">&#x27;counter.categories&#x27;</span>, site.categories.length) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;category-all&quot;</span>&gt;</span><br><span class="line">          &#123;&#123; list_categories() &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ä»¥ä¸‹æ˜¯æ–‡ç« åº•éƒ¨çš„æ ‡ç­¾æ ·å¼ï¼ˆä»£ç æ‹·å…¥ /themes/next/source/css/_schemes/(è‡ªå·±é€‰æ‹©çš„ä¸»é¢˜)/index.styl å³å¯ï¼‰ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*æ–‡ç« åº•éƒ¨æ ‡ç­¾æ ·å¼*&#x2F;</span><br><span class="line">.posts-expand .post-tags a &#123;</span><br><span class="line">  -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  font-family: &#39;Comic Sans MS&#39;, sans-serif;</span><br><span class="line">  transition: .2s ease-out;</span><br><span class="line">  padding: 3px 5px;</span><br><span class="line">  margin: 5px;</span><br><span class="line">  background: #f5f5f5;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-radius: 15px;</span><br><span class="line"></span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    padding: 1px 3px;</span><br><span class="line">    font-size: 8px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    background: rgba(100,154,182,0.902);</span><br><span class="line">    color: #fff;</span><br><span class="line">    -webkit-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">    -moz-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226130811.png" alt="image-20210226130811067"></p>
<h1 id="å½’æ¡£é¡µç¾åŒ–"><a href="#å½’æ¡£é¡µç¾åŒ–" class="headerlink" title="å½’æ¡£é¡µç¾åŒ–"></a>å½’æ¡£é¡µç¾åŒ–</h1><ol>
<li>ä¿®æ”¹ /themes/next/ layout/_ macro/post collapse.swig åçš„ä»£ç å¦‚ä¸‹:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% macro render(posts) %&#125;</span><br><span class="line">&#123;%- set current_year &#x3D; &#39;1970&#39; %&#125;</span><br><span class="line">&#123;%- for post in posts.toArray() %&#125;</span><br><span class="line"></span><br><span class="line">  &#123;%- set year &#x3D; date(post.date, &#39;YYYY&#39;) %&#125;</span><br><span class="line"></span><br><span class="line">  &#123;%- if year !&#x3D;&#x3D; current_year %&#125;</span><br><span class="line">    &#123;%- set current_year &#x3D; year %&#125;</span><br><span class="line">    &lt;div class&#x3D;&quot;collection-year&quot;&gt;</span><br><span class="line">      &lt;&#123;%- if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;%- endif %&#125; class&#x3D;&quot;collection-header&quot;&gt;&#123;&#123; current_year &#125;&#125;&lt;&#x2F;&#123;%- if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;%- endif %&#125;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &#123;%- endif %&#125;</span><br><span class="line"></span><br><span class="line">  &lt;article class&#x3D;&quot;my-post post-type-&#123;&#123; post.type | default(&#39;normal&#39;) &#125;&#125;&quot; itemscope itemtype&#x3D;&quot;http:&#x2F;&#x2F;schema.org&#x2F;Article&quot;&gt;</span><br><span class="line">    &lt;header class&#x3D;&quot;my-post-header&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class&#x3D;&quot;my-post-meta&quot;&gt;</span><br><span class="line">        &lt;time class&#x3D;&quot;my-post-time&quot; itemprop&#x3D;&quot;dateCreated&quot;</span><br><span class="line">              datetime&#x3D;&quot;&#123;&#123; moment(post.date).format() &#125;&#125;&quot;</span><br><span class="line">              content&#x3D;&quot;&#123;&#123; date(post.date, config.date_format) &#125;&#125;&quot;&gt;</span><br><span class="line">          &#123;&#123; date(post.date, &#39;MM-DD&#39;) &#125;&#125;</span><br><span class="line">        &lt;&#x2F;time&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;&#123;%- if theme.seo %&#125;h3&#123;% else %&#125;h2&#123;%- endif %&#125; class&#x3D;&quot;my-post-title&quot;&gt;</span><br><span class="line">        &#123;%- if post.link %&#125;&#123;# Link posts #&#125;</span><br><span class="line">          &lt;a class&#x3D;&quot;my-post-title-link post-title-link-external&quot; target&#x3D;&quot;_blank&quot; href&#x3D;&quot;&#123;&#123; url_for(post.link) &#125;&#125;&quot; itemprop&#x3D;&quot;url&quot;&gt;</span><br><span class="line">            &#123;&#123; post.title or post.link &#125;&#125;</span><br><span class="line">            &lt;i class&#x3D;&quot;fa fa-external-link&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">          &lt;&#x2F;a&gt;</span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">          &lt;a class&#x3D;&quot;my-post-title-link&quot; href&#x3D;&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot; itemprop&#x3D;&quot;url&quot;&gt;</span><br><span class="line">            &#123;% if post.type &#x3D;&#x3D;&#x3D; &#39;picture&#39; %&#125;</span><br><span class="line">              &#123;&#123; post.content &#125;&#125;</span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">              &lt;span itemprop&#x3D;&quot;name&quot;&gt;&#123;&#123; post.title or __(&#39;post.untitled&#39;) &#125;&#125;&lt;&#x2F;span&gt;</span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">          &lt;&#x2F;a&gt;</span><br><span class="line">        &#123;%- endif %&#125;</span><br><span class="line">      &lt;&#x2F;&#123;%- if theme.seo %&#125;h3&#123;% else %&#125;h2&#123;%- endif %&#125;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;header&gt;</span><br><span class="line">  &lt;&#x2F;article&gt;</span><br><span class="line"></span><br><span class="line">&#123;%- endfor %&#125;</span><br><span class="line">&#123;% endmacro %&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸»è¦ä¿®æ”¹ï¼šä¸€æ˜¯å°† post-metaè¿™ä¸ªdivç§»åˆ°å‰é¢header æ ‡ç­¾ä¸‹ï¼›äºŒæ˜¯å°†æ‰€æœ‰çš„ class å±æ€§éƒ½åŠ ä¸Š my-ï¼Œä¾‹å¦‚ my-post-metaï¼Œè¿™æ ·æ”¹åŠ¨æ˜¯ä¸ºäº†ä¸å½±å“å…¶å®ƒé¡µé¢å¼•ç”¨çš„æ ·å¼ã€‚</p>
<ol>
<li>åœ¨ /themes/next/source/css/_schemes/(è‡ªå·±é€‰æ‹©çš„ä¸»é¢˜)/index.styl æ–°å¢å¦‚ä¸‹æ ·å¼ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* å½’æ¡£é¡µæ ·å¼ began *&#x2F;</span><br><span class="line">.page-archive .archive-page-counter &#123;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  background-color: #49b1f5;</span><br><span class="line">  padding-left: 10px;</span><br><span class="line">  padding-right: 10px;</span><br><span class="line">  border-radius: 8px;</span><br><span class="line">  color: #fff;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.my-post-time&#123;</span><br><span class="line">  font-size: 11px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  color: #fff;</span><br><span class="line">  background-color: #49b1f5;</span><br><span class="line">  border-radius: 5px;</span><br><span class="line">  padding-left: 5px;</span><br><span class="line">  padding-right: 5px;</span><br><span class="line">  margin-left: 15px;</span><br><span class="line">&#125;</span><br><span class="line">.mypost&#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  margin-bottom: 1rem;</span><br><span class="line">  -webkit-transition: all .2s ease-in-out;</span><br><span class="line">  -moz-transition: all .2s ease-in-out;</span><br><span class="line">  -o-transition: all .2s ease-in-out;</span><br><span class="line">  -ms-transition: all .2s ease-in-out;</span><br><span class="line">  transition: all .2s ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line">a.my-post-title-link:before&#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;ğŸ“š&quot;;</span><br><span class="line">  margin-right: 5px;</span><br><span class="line">  font: normal normal normal 14px&#x2F;1 FontAwesome;</span><br><span class="line">  font-size: 15px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">&#125;</span><br><span class="line">.my-post:hover&#123;</span><br><span class="line">  transform: scale(1.1);</span><br><span class="line">  box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);</span><br><span class="line">  border-radius: 30px;</span><br><span class="line">  width: 400px;</span><br><span class="line">  padding: 1px 10px;</span><br><span class="line">  margin-left: 25px;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">  transition-duration: 0.15s;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    width: 260px;</span><br><span class="line">    margin-left: 18px;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;display:flex;</span><br><span class="line">&#125;</span><br><span class="line">a.my-post-title-link&#123;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">  font-size: 15px;</span><br><span class="line">  font-weight: 400;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.my-post-title&#123;</span><br><span class="line">  display: block;</span><br><span class="line">  margin-left: 4.5rem;</span><br><span class="line">  color: #4c4948;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">  font-size: .8rem;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    &#x2F;&#x2F;margin-left: 4rem;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.my-post-header&#123;</span><br><span class="line">  position: top;</span><br><span class="line">  margin-bottom: 1rem;</span><br><span class="line">  -webkit-transition: all .2s ease-in-out;</span><br><span class="line">  -moz-transition: all .2s ease-in-out;</span><br><span class="line">  -o-transition: all .2s ease-in-out;</span><br><span class="line">  -ms-transition: all .2s ease-in-out;</span><br><span class="line">  transition: all .2s ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;.my-post-title-link&#123;</span><br><span class="line">&#x2F;&#x2F;  font-size: 16px;</span><br><span class="line">&#x2F;&#x2F;  font-weight: 500;</span><br><span class="line">&#x2F;&#x2F;&#125;</span><br><span class="line">.my-post-meta&#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  color: #99a9bf;</span><br><span class="line">  width: 80px;</span><br><span class="line">  color: #114142;</span><br><span class="line">&#125;</span><br><span class="line">div.post-block.tag .collection-title h2 &#123;</span><br><span class="line">  border-width: 1px;</span><br><span class="line">  border-style: solid;</span><br><span class="line">  border-color: #3f3f3f;</span><br><span class="line">  border-radius: 20px;</span><br><span class="line">  font-size: 22px;</span><br><span class="line">  background-color: #b4e8fa;</span><br><span class="line">  padding: 2px 15px;</span><br><span class="line">  letter-spacing: 1.5px;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  color: #3f3f3f;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  margin: 10px 0 10px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;* å½’æ¡£é¡µæ ·å¼ end *&#x2F;</span><br></pre></td></tr></table></figure>

<p>å®ç°æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><a href="https://img-blog.csdnimg.cn/20200720163209724.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNTY5Mzgz,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20200720163209724.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNTY5Mzgz,size_16,color_FFFFFF,t_70" alt="img"></a></p>
<h1 id="åˆ†ç±»é¡µç¾åŒ–"><a href="#åˆ†ç±»é¡µç¾åŒ–" class="headerlink" title="åˆ†ç±»é¡µç¾åŒ–"></a>åˆ†ç±»é¡µç¾åŒ–</h1><p>åœ¨ /themes/next/source/css/_schemes/(è‡ªå·±é€‰æ‹©çš„ä¸»é¢˜)/index.styl æ–°å¢å¦‚ä¸‹æ ·å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* åˆ†ç±»é¡µæ ·å¼ began *&#x2F;</span><br><span class="line">.category-list-link:hover&#123;</span><br><span class="line">  transform: scale(1.1);</span><br><span class="line">  box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);</span><br><span class="line">  border-radius: 15px;</span><br><span class="line">  padding: 6px 16px;</span><br><span class="line">  margin-left: 0px;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">  transition-duration: 0.15s;</span><br><span class="line">  &#x2F;&#x2F;display:flex;</span><br><span class="line">&#125;</span><br><span class="line">a.category-list-link:before&#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;ğŸ“š&quot;;</span><br><span class="line">  margin-right: 5px;</span><br><span class="line">  font: normal normal normal 14px&#x2F;1 FontAwesome;</span><br><span class="line">  font-size: 15px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;* åˆ†ç±»é¡µæ ·å¼ end *&#x2F;</span><br></pre></td></tr></table></figure>

<p>å®ç°æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><a href="https://img-blog.csdnimg.cn/20200720172136778.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNTY5Mzgz,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20200720172136778.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNTY5Mzgz,size_16,color_FFFFFF,t_70" alt="img"></a></p>
]]></content>
      <categories>
        <category>Hexo</category>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>win10æ·»åŠ æ–°å»ºæ–‡ä»¶mdæ–¹å¼ä»¥åŠè®¾ç½®mdæ¨¡ç‰ˆ</title>
    <url>/posts/558e0cc4/</url>
    <content><![CDATA[<p><strong><em>åŠ¡å¿…å…ˆåˆ›å»ºç³»ç»Ÿè¿˜åŸç‚¹æˆ–è€…å¤‡ä»½æ³¨å†Œè¡¨</em></strong></p>
<h1 id="æ·»åŠ æ–°å»ºæ–¹å¼æ­¥éª¤"><a href="#æ·»åŠ æ–°å»ºæ–¹å¼æ­¥éª¤" class="headerlink" title="æ·»åŠ æ–°å»ºæ–¹å¼æ­¥éª¤"></a>æ·»åŠ æ–°å»ºæ–¹å¼æ­¥éª¤</h1><p>æ–°å»º<code>temp.txt</code>è¾“å…¥ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\.md]</span><br><span class="line">@&#x3D;&quot;.md&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\.md\ShellNew]</span><br><span class="line">&quot;NullFile&quot;&#x3D;&quot;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>æŠŠ<code>temp.txt</code>æ”¹åä¸º<code>temp.reg</code></p>
</li>
<li><p>åŒå‡»è¿è¡Œï¼Œå°±okäº†ï¼Œæœ‰é—®é¢˜è®°å¾—å…ˆé‡å¯ï¼Œå¦‚æœä¸è¡Œï¼Œå°±é‡‡ç”¨ä¸‹é¢è¿™ä¸ª</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\.md]</span><br><span class="line">@&#x3D;&quot;typora.md&quot;</span><br><span class="line">&quot;icon&quot;&#x3D;&quot;E:\\Typora\\bin\\typora.exe&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\.md\OpenWithProgids]</span><br><span class="line">&quot;Typora.md&quot;&#x3D;&quot;&quot;</span><br><span class="line">&quot;VSCode.md&quot;&#x3D;&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\.md\ShellNew]</span><br><span class="line">&quot;NullFile&quot;&#x3D;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="é…ç½®mdæ–‡ä»¶æ¨¡ç‰ˆ"><a href="#é…ç½®mdæ–‡ä»¶æ¨¡ç‰ˆ" class="headerlink" title="é…ç½®mdæ–‡ä»¶æ¨¡ç‰ˆ"></a>é…ç½®mdæ–‡ä»¶æ¨¡ç‰ˆ</h1><p>1ã€ä½¿ç”¨<code>notepad++</code>æ–°å»º<code>æ–°å»º Markdown.md</code>æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: </span><br><span class="line">date: </span><br><span class="line">tags: []</span><br><span class="line">categories:</span><br><span class="line">- []</span><br><span class="line">- []</span><br><span class="line">description: </span><br><span class="line">updated: </span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>å°†æ–‡ä»¶ç§»åŠ¨åˆ°ä¸ä¼š<strong>è½»æ˜“åˆ é™¤çš„æ–‡ä»¶å¤¹</strong></p>
<p>æ‰“å¼€æ³¨å†Œè¡¨ï¼ŒæŒ‰å¦‚ä¸‹(æ²¡æœ‰å°±åˆ›å»º)</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226105517.png" alt="image-20210226105516945"></p>
]]></content>
      <categories>
        <category>Typora</category>
        <category>Win10</category>
      </categories>
      <tags>
        <tag>Typora</tag>
        <tag>Win10</tag>
      </tags>
  </entry>
  <entry>
    <title>å®‰è£…rediså‡ºç°çš„é—®é¢˜</title>
    <url>/posts/5e07a887/</url>
    <content><![CDATA[<p><strong>æ“ä½œç³»ç»Ÿä¸ºcentOs7  redisä¸º6.0.8ç‰ˆæœ¬</strong></p>
<h3 id="1-å½“Makeå‘½ä»¤æç¤ºæ— ccç¯å¢ƒæ—¶éœ€è¦è¿›è¡Œå®‰è£…Gccå®‰è£…åŒ…é‡æ–°å®‰è£…ï¼ŒåŒæ—¶éœ€è¦æ‰§è¡Œmake-distcleanæ¸…ç†ç›¸å…³æ–‡ä»¶ï¼Œå†æ‰§è¡Œmakeå‘½ä»¤"><a href="#1-å½“Makeå‘½ä»¤æç¤ºæ— ccç¯å¢ƒæ—¶éœ€è¦è¿›è¡Œå®‰è£…Gccå®‰è£…åŒ…é‡æ–°å®‰è£…ï¼ŒåŒæ—¶éœ€è¦æ‰§è¡Œmake-distcleanæ¸…ç†ç›¸å…³æ–‡ä»¶ï¼Œå†æ‰§è¡Œmakeå‘½ä»¤" class="headerlink" title="1.å½“Makeå‘½ä»¤æç¤ºæ— ccç¯å¢ƒæ—¶éœ€è¦è¿›è¡Œå®‰è£…Gccå®‰è£…åŒ…é‡æ–°å®‰è£…ï¼ŒåŒæ—¶éœ€è¦æ‰§è¡Œmake distcleanæ¸…ç†ç›¸å…³æ–‡ä»¶ï¼Œå†æ‰§è¡Œmakeå‘½ä»¤"></a>1.å½“Makeå‘½ä»¤æç¤ºæ— ccç¯å¢ƒæ—¶éœ€è¦è¿›è¡Œå®‰è£…Gccå®‰è£…åŒ…é‡æ–°å®‰è£…ï¼ŒåŒæ—¶éœ€è¦æ‰§è¡Œmake distcleanæ¸…ç†ç›¸å…³æ–‡ä»¶ï¼Œå†æ‰§è¡Œmakeå‘½ä»¤</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;ä¸€èˆ¬é”™è¯¯ä¸ºgccå¥—è£…é”™è¯¯</span><br><span class="line">yum install cpp</span><br><span class="line">yum install binutils</span><br><span class="line">yum install glibc</span><br><span class="line">yum install glibc-kernheaders</span><br><span class="line">yum install glibc-common</span><br><span class="line">yum install glibc-devel</span><br><span class="line">yum install gcc</span><br><span class="line">yum install make</span><br><span class="line">&#x2F;&#x2F;æ¸…ç†é”™è¯¯æ–‡ä»¶</span><br><span class="line">make distclean</span><br><span class="line">&#x2F;&#x2F;é‡æ–°å®‰è£…</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/m0_37952284/article/details/109012324">server.c:5307:31: é”™è¯¯:â€˜struct redisServerâ€™æ²¡æœ‰åä¸ºâ€˜server_xxxâ€™çš„æˆå‘˜</a></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113217.png" alt="image-20201103103148896"></p>
<ol start="2">
<li><h3 id="ä¸‹è½½äº†redisç‰ˆæœ¬6-0-6ï¼Œæ­£å¸¸è§£å‹ï¼ŒCentosç”¨çš„7-6ï¼Œmakeå®‰è£…æ—¶æŠ¥é”™"><a href="#ä¸‹è½½äº†redisç‰ˆæœ¬6-0-6ï¼Œæ­£å¸¸è§£å‹ï¼ŒCentosç”¨çš„7-6ï¼Œmakeå®‰è£…æ—¶æŠ¥é”™" class="headerlink" title="ä¸‹è½½äº†redisç‰ˆæœ¬6.0.6ï¼Œæ­£å¸¸è§£å‹ï¼ŒCentosç”¨çš„7.6ï¼Œmakeå®‰è£…æ—¶æŠ¥é”™:"></a>ä¸‹è½½äº†redisç‰ˆæœ¬6.0.6ï¼Œæ­£å¸¸è§£å‹ï¼ŒCentosç”¨çš„7.6ï¼Œmakeå®‰è£…æ—¶æŠ¥é”™:</h3></li>
</ol>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113232.png" alt="image-20201103104749570"></p>
<p>åŸå› æ˜¯rediesç”¨äº†cè¯­è¨€ç¼–å†™ï¼Œcentos7.6åº”è¯¥ä¹Ÿæœ‰ä»¥ä¸‹ç‰ˆæœ¬ï¼Œé»˜è®¤å®‰è£…çš„gcc4.8.5ç‰ˆæœ¬è¾ƒä½ï¼Œéœ€è¦åœ¨5.3ä»¥ä¸Šç‰ˆæœ¬ï¼Œç°æ›´æ¢ä¸º9.3ï¼Œå…ˆæŸ¥çœ‹å½“å‰ç‰ˆæœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gcc -v</span><br></pre></td></tr></table></figure>

<p>å¼€å§‹æ›´æ¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum -y install centos-release-scl</span><br><span class="line">yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br><span class="line">echo &quot;source &#x2F;opt&#x2F;rh&#x2F;devtoolset-9&#x2F;enable&quot; &gt;&gt;&#x2F;etc&#x2F;profile</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>é‡è¿shell</strong>(ä¸é‡è¿gccç‰ˆæœ¬ä¸å˜)ï¼Œé‡æ–°makeï¼Œå³æˆåŠŸäº†</p>
<h3 id="3-å®‰è£…Redis-6-0-6-install-server-shæŠ¥é”™"><a href="#3-å®‰è£…Redis-6-0-6-install-server-shæŠ¥é”™" class="headerlink" title="3.å®‰è£…Redis 6.0.6 ./install_server.shæŠ¥é”™"></a>3.å®‰è£…Redis 6.0.6 ./install_server.shæŠ¥é”™</h3><p>äº§ç”ŸåŸå› :gcc9ç‰ˆæœ¬æ ¡éªŒæ›´åŠ ä¸¥æ ¼å¯¼è‡´</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113249.png" alt="image-20201103111330639"></p>
<p>è§£å†³æ–¹æ¡ˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vi .&#x2F;install_server.sh</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113254.png" alt="image-20201103111506170"></p>
<p><strong>æ³¨é‡Šæ‰ä»£ç </strong>é‡æ–°è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#bail if this system is managed by systemd</span><br><span class="line">#_pid_1_exe&#x3D;&quot;$(readlink -f &#x2F;proc&#x2F;1&#x2F;exe)&quot;</span><br><span class="line">#if [ &quot;$&#123;_pid_1_exe##*&#x2F;&#125;&quot; &#x3D; systemd ]</span><br><span class="line">#then</span><br><span class="line">#       echo &quot;This systems seems to use systemd.&quot;</span><br><span class="line">#       echo &quot;Please take a look at the provided example service unit files in this directory, and adapt and install them. Sorry!&quot;</span><br><span class="line">#       exit 1</span><br><span class="line">#fi</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>centoså®‰è£…redis</title>
    <url>/posts/725846d4/</url>
    <content><![CDATA[<p><strong>æ“ä½œç³»ç»Ÿä¸ºcentOS7  redisä¸º6.0.8ç‰ˆæœ¬</strong></p>
<ol>
<li>å®‰è£…wgetå‘½ä»¤ </li>
</ol>
   <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum install wget</span><br></pre></td></tr></table></figure>

<p>   <img src="https://gitee.com/CNRF/image/raw/master/img/20210223112933.png" alt="image-20201026172631943"></p>
<ol start="2">
<li><p>å®‰è£…GCCåŒ…ï¼ˆredisæ˜¯cè¯­è¨€ç¼–å†™ï¼Œliunxéœ€è¦å®‰è£…ç›¸å…³è½¯ä»¶ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum install gcc</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223112947.png" alt="image-20201026172608587"></p>
</li>
<li><p>åœ¨æŒ‡å®šç›®å½•è·å–å®‰è£…åŒ…ï¼ˆæˆ–è€…ä¸‹è½½ä¹‹åç§»åŠ¨åˆ°æŒ‡å®šç›®å½•  ï¼‰</p>
<p><a href="https://redis.io/download%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E7%89%88%E6%9C%AC%E8%BF%9E%E6%8E%A5%EF%BC%8C%E8%BF%99%E9%87%8C%E4%B8%8B%E8%BD%BD6.0%E7%89%88%E6%9C%AC">https://redis.io/downloadè·å–ç›¸å…³ç‰ˆæœ¬è¿æ¥ï¼Œè¿™é‡Œä¸‹è½½6.0ç‰ˆæœ¬</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-6.0.8.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113024.png" alt="image-20201026172901823"></p>
</li>
<li><p>è§£å‹gzåŒ…ï¼ˆä¸‹è½½çš„æ˜¯æºç ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar xf redis-6.0.8.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ ¹æ®è§£å‹åŒ…ä¸­æ–‡ä»¶çš„REDME.mdæ–‡æ¡£è¿›è¡Œç›¸å…³æ“ä½œï¼ˆé‡è¦ï¼šå®‰è£…å…¶ä»–è½¯ä»¶åŒç†ï¼‰</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113031.png" alt="image-20201103102727621"></p>
</li>
<li><p>ä½¿ç”¨makeç›¸å…³å‘½ä»¤è¿›è¡Œå®‰è£…ç¨‹åº</p>
</li>
<li><p>å®‰è£…å¯æ‰§è¡Œåˆ°æŒ‡å®šç›®å½•ï¼ˆåˆ†ç¦»æºç ï¼‰</p>
<p>æŸ¥çœ‹/home/redis-6.0.8/INSTALLï¼Œæ ¹æ®æ–‡æ¡£å®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">make install PREFIX&#x3D;&#x2F;home&#x2F;redis6</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨å†Œredisä¸ºæœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;æ‰§è¡Œvi &#x2F;etc&#x2F;profileå‘½ä»¤ï¼Œåœ¨æ–‡ä»¶æœ€åæ–°å¢å†…å®¹</span><br><span class="line">vi &#x2F;etc&#x2F;profile</span><br><span class="line">&#x2F;&#x2F;REDIS_HOMEçš„è·¯å¾„ä¸ºç¬¬ä¸ƒæ­¥çš„å®‰è£…è·¯å¾„</span><br><span class="line">export REDIS_HOME&#x3D;&#x2F;home&#x2F;redis6</span><br><span class="line">export PATH&#x3D;$PATH:$REDIS_HOME&#x2F;bin</span><br><span class="line">&#x2F;&#x2F;ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ</span><br><span class="line">source &#x2F;etc&#x2F;profile</span><br><span class="line">&#x2F;&#x2F;éªŒè¯æ˜¯å¦æ·»åŠ æˆåŠŸ</span><br><span class="line">echo $PATH</span><br><span class="line">&#x2F;&#x2F;æ‰§è¡Œ</span><br><span class="line">&#x2F;home&#x2F;redis-6.0.8&#x2F;utils&#x2F;install_server.shè„šæœ¬æ³¨å†Œä¸ºæœåŠ¡</span><br><span class="line">.&#x2F;install_server.sh</span><br></pre></td></tr></table></figure>


</li>
</ol>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113126.png" alt="image-20201103103148896"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113145.png" alt="image-20201103112714896">   </p>
<ol start="9">
<li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå®‰è£…éœ€æ±‚ä¿®æ”¹ç›¸å…³é…ç½®</p>
<p>rediså¸¸è§é…ç½®å‚è§<a href="https://blog.csdn.net/suprezheng/article/details/90679790">https://blog.csdn.net/suprezheng/article/details/90679790</a></p>
</li>
<li><p>å°†redis_6379(æ ¹æ®ç”Ÿæˆçš„é…ç½®æ–‡ä»¶åç§°)è®¾ç½®ä¸ºå¼€å¯</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;etc&#x2F;init.d</span><br><span class="line">  #init.dæ²¡æœ‰redis_6379æ–‡ä»¶çš„å¯ä»¥åœ¨æºæ–‡ä»¶ä¸­æ‰¾åˆ°redis.confæ–‡ä»¶è¿›è¡Œä¿®æ”¹</span><br><span class="line">  chkconfig --add redis_6379</span><br><span class="line">  chkconfig redis_6379 on</span><br><span class="line">  #æŸ¥çœ‹å¼€æœºè‡ªå¯çš„åˆ—è¡¨</span><br><span class="line">  chkconfig --list</span><br><span class="line">  #é‡å¯redis</span><br><span class="line">  service redis_6379 restart</span><br><span class="line">  #æ‰‹åŠ¨å¯ç”¨</span><br><span class="line">  redis-server &#x2F;etc&#x2F;redis&#x2F;6379.conf</span><br><span class="line">  chkconfig --listçš„å‚æ•°æ„ä¹‰</span><br><span class="line">  1è¡¨ç¤ºï¼šå•ç”¨æˆ·æ¨¡å¼</span><br><span class="line">  2è¡¨ç¤ºï¼šæ— ç½‘ç»œè¿æ¥çš„å¤šç”¨æˆ·å‘½ä»¤è¡Œæ¨¡å¼</span><br><span class="line">  3è¡¨ç¤ºï¼šæœ‰ç½‘ç»œè¿æ¥çš„å¤šç”¨æˆ·å‘½ä»¤è¡Œæ¨¡å¼</span><br><span class="line">  4è¡¨ç¤ºï¼šä¸å¯ç”¨</span><br><span class="line">  5è¡¨ç¤ºï¼šå¸¦å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼</span><br><span class="line">  6è¡¨ç¤ºï¼šé‡æ–°å¯åŠ¨</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>rediså…¥é—¨</title>
    <url>/posts/eca8b4a8/</url>
    <content><![CDATA[<h4 id="1-redisç›¸å…³ä»‹ç»"><a href="#1-redisç›¸å…³ä»‹ç»" class="headerlink" title="1.redisç›¸å…³ä»‹ç»"></a>1.redisç›¸å…³ä»‹ç»</h4><p><a href="http://redis.cn/">redisä¸­æ–‡ç½‘</a></p>
<h5 id="1-1-redisçš„ä»‹ç»"><a href="#1-1-redisçš„ä»‹ç»" class="headerlink" title="1.1 redisçš„ä»‹ç»"></a>1.1 redisçš„ä»‹ç»</h5><p>Redis æ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSDè®¸å¯ï¼‰çš„ï¼Œå†…å­˜ä¸­çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚ å®ƒæ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œå¦‚ <a href="http://redis.cn/topics/data-types-intro.html#strings">å­—ç¬¦ä¸²ï¼ˆstringsï¼‰</a>ï¼Œ <a href="http://redis.cn/topics/data-types-intro.html#hashes">æ•£åˆ—ï¼ˆhashesï¼‰</a>ï¼Œ <a href="http://redis.cn/topics/data-types-intro.html#lists">åˆ—è¡¨ï¼ˆlistsï¼‰</a>ï¼Œ <a href="http://redis.cn/topics/data-types-intro.html#sets">é›†åˆï¼ˆsetsï¼‰</a>ï¼Œ <a href="http://redis.cn/topics/data-types-intro.html#sorted-sets">æœ‰åºé›†åˆï¼ˆsorted setsï¼‰</a> ä¸èŒƒå›´æŸ¥è¯¢ï¼Œ <a href="http://redis.cn/topics/data-types-intro.html#bitmaps">bitmaps</a>ï¼Œ <a href="http://redis.cn/topics/data-types-intro.html#hyperloglogs">hyperloglogs</a> å’Œ <a href="http://redis.cn/commands/geoadd.html">åœ°ç†ç©ºé—´ï¼ˆgeospatialï¼‰</a> ç´¢å¼•åŠå¾„æŸ¥è¯¢ã€‚ Redis å†…ç½®äº† <a href="http://redis.cn/topics/replication.html">å¤åˆ¶ï¼ˆreplicationï¼‰</a>ï¼Œ<a href="http://redis.cn/commands/eval.html">LUAè„šæœ¬ï¼ˆLua scriptingï¼‰</a>ï¼Œ <a href="http://redis.cn/topics/lru-cache.html">LRUé©±åŠ¨äº‹ä»¶ï¼ˆLRU evictionï¼‰</a>ï¼Œ<a href="http://redis.cn/topics/transactions.html">äº‹åŠ¡ï¼ˆtransactionsï¼‰</a> å’Œä¸åŒçº§åˆ«çš„ <a href="http://redis.cn/topics/persistence.html">ç£ç›˜æŒä¹…åŒ–ï¼ˆpersistenceï¼‰</a>ï¼Œ å¹¶é€šè¿‡ <a href="http://redis.cn/topics/sentinel.html">Rediså“¨å…µï¼ˆSentinelï¼‰</a>å’Œè‡ªåŠ¨ <a href="http://redis.cn/topics/cluster-tutorial.html">åˆ†åŒºï¼ˆClusterï¼‰</a>æä¾›é«˜å¯ç”¨æ€§ï¼ˆhigh availabilityï¼‰ã€‚</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113311.png" alt="image-20210211203040301"></p>
<h5 id="1-2-rediså’Œmemcachedçš„åŒºåˆ«"><a href="#1-2-rediså’Œmemcachedçš„åŒºåˆ«" class="headerlink" title="1.2  .rediså’Œmemcachedçš„åŒºåˆ«"></a>1.2  .rediså’Œmemcachedçš„åŒºåˆ«</h5><p>rediså’Œmemcachedç›¸æ¯”æœ¬è´¨æ˜¯è§£è€¦ï¼Œç”¨å¤§æ•°æ®è¯´æ³•æ˜¯è®¡ç®—å‘æ•°æ®ç§»åŠ¨</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113409.png" alt="image-20210218095611832"></p>
<h5 id="1-3-liunxä¸‹å¸¸è§çš„rediså‘½ä»¤"><a href="#1-3-liunxä¸‹å¸¸è§çš„rediså‘½ä»¤" class="headerlink" title="1.3 . liunxä¸‹å¸¸è§çš„rediså‘½ä»¤"></a>1.3 . liunxä¸‹å¸¸è§çš„rediså‘½ä»¤</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#è¿æ¥redis</span><br><span class="line">redis-cli</span><br><span class="line">#è¿æ¥redisæ˜¯6379ç«¯å£çš„8å·åº“ æŒ‡å®šåº“(ä¸åŒåº“æ•°æ®ä¸å¯è§)</span><br><span class="line">redis-cli -p 6379 -n 8</span><br><span class="line">#è¿æ¥redisåä½¿ç”¨helpè¿›è¡ŒæŸ¥è¯¢</span><br><span class="line">help </span><br></pre></td></tr></table></figure>

<h4 id="2-redisç›¸å…³æ•°æ®çš„æ“ä½œå¸¸è§å‘½ä»¤"><a href="#2-redisç›¸å…³æ•°æ®çš„æ“ä½œå¸¸è§å‘½ä»¤" class="headerlink" title="2.redisç›¸å…³æ•°æ®çš„æ“ä½œå¸¸è§å‘½ä»¤"></a>2.redisç›¸å…³æ•°æ®çš„æ“ä½œå¸¸è§å‘½ä»¤</h4><p>åœ¨rediså®¢æˆ·ç«¯ä¸­ä½¿ç”¨helpå‘½ä»¤è¿›è¡Œç›¸å…³æŸ¥è¯¢ç›¸å…³å‘½ä»¤</p>
<h5 id="2-1-Stringsç±»å‹"><a href="#2-1-Stringsç±»å‹" class="headerlink" title="2.1 Stringsç±»å‹"></a>2.1 Stringsç±»å‹</h5><p><a href="https://redis.io/commands#string">Strings æ•°æ®æ“ä½œç›¸å…³æ–‡æ¡£</a></p>
<h6 id="2-1-1-æŸ¥çœ‹stringç±»å‹å¸®åŠ©å‘½ä»¤"><a href="#2-1-1-æŸ¥çœ‹stringç±»å‹å¸®åŠ©å‘½ä»¤" class="headerlink" title="2.1.1 æŸ¥çœ‹stringç±»å‹å¸®åŠ©å‘½ä»¤"></a>2.1.1 æŸ¥çœ‹stringç±»å‹å¸®åŠ©å‘½ä»¤</h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">help @string</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113419.png" alt="image-20210219155031906"></p>
<h6 id="2-1-2-stringæ•°æ®ç±»å‹åŠç›¸å…³çš„åº”ç”¨åœºæ™¯"><a href="#2-1-2-stringæ•°æ®ç±»å‹åŠç›¸å…³çš„åº”ç”¨åœºæ™¯" class="headerlink" title="2.1.2  stringæ•°æ®ç±»å‹åŠç›¸å…³çš„åº”ç”¨åœºæ™¯"></a>2.1.2  stringæ•°æ®ç±»å‹åŠç›¸å…³çš„åº”ç”¨åœºæ™¯</h6><ol>
<li><p>å­—ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#setè®¾ç½®keyçš„value</span><br><span class="line">set k1 ooxx nx  ï¼ˆå¸¦nxï¼Œxxå¯ç”¨åœ¨åˆ†å¸ƒå¼é”ä¸­ï¼‰</span><br><span class="line">set k1 ooxx xx</span><br><span class="line">#msetæ‰¹é‡è®¾ç½®</span><br><span class="line">mset k3 k3mest k4 k4mest</span><br><span class="line">#getè·å–keyçš„value</span><br><span class="line">get k1</span><br><span class="line">#mgetæ‰¹é‡è·å–</span><br><span class="line">mget k3 k4</span><br><span class="line">#APPENDåœ¨å­—ç¬¦ä¸²åé¢è¿½åŠ </span><br><span class="line">append k1 &quot; world&quot;</span><br><span class="line">#GETRANGEè·å–æŒ‡å®šèŒƒå›´æ•°æ®</span><br><span class="line">getrange k1 5 10</span><br><span class="line">#strlenè·å–å­—ç¬¦ä¸²é•¿åº¦</span><br><span class="line">strlen k1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113426.png" alt="image-20210219155108071"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113517.png" alt="image-20210219160021217"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113555.png" alt="image-20210219160343269"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113600.png" alt="image-20210219160751857"></p>
</li>
<li><p>æ•°å€¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">incr  å°†valueçš„æ•´æ•°å‹+1</span><br><span class="line">incrby å°†valueçš„æ•´æ•°å‹åŠ æŒ‡å®šæ•°</span><br><span class="line">decr </span><br><span class="line">descby</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>  <strong>åº”ç”¨åœºæ™¯</strong> ï¼š æŠ¢è´­ï¼Œç§’æ€ï¼Œè¯¦æƒ…é¡µï¼Œç‚¹èµï¼Œè¯„è®ºè§„é¿å¹¶å‘ä¸‹ï¼Œå¯¹æ•°æ®åº“çš„äº‹åŠ¡æ“ä½œå®Œå…¨ç”±rediså†…å­˜æ“ä½œä»£æ›¿ï¼Œé¿å…å› æ•°æ®åº“äº‹åŠ¡å¯¼è‡´å“åº”æ—¶é—´è¶…æ—¶ï¼Œ<strong>ä½†åœ¨é“¶è¡Œç­‰é‡‘èæ¶‰åŠé‡‘é¢ä¸è¦æ”¾åœ¨redisä¸­è¿›è¡Œç›¸å…³è®¡ç®—</strong></p>
<ol start="3">
<li><p>bitmap</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setbit  &#x2F;&#x2F;è®¾ç½®bitæ•°å€¼</span><br><span class="line">bitcount  </span><br><span class="line">bitpos</span><br><span class="line">bitop</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>åº”ç”¨åœºæ™¯</strong> ï¼š</p>
<pre><code>1. ç»Ÿè®¡ç”¨æˆ·ç™»é™†å¤©æ•°

    æ–¹æ¡ˆï¼šç”¨æˆ·idä¸ºkeyï¼Œè®¾è®¡é•¿åº¦ä¸º9bitçš„æ•°æ®å³å¯å­˜å‚¨ç”¨æˆ·å½“å¹´æ‰€æœ‰ç™»é™†å¤©æ•°æ•°æ®ï¼Œå½“å¤©ç™»é™†ä¸º1ï¼Œå³å¯ç»Ÿè®¡æŒ‡å®šæ—¶é—´æ®µçš„ç›¸å…³æ•°æ®

2. ç»Ÿè®¡å½“å¤©æ‰€æœ‰ç”¨æˆ·ç™»é™†æƒ…å†µ

    æ–¹æ¡ˆï¼šæ—¥æœŸä¸ºKeyï¼Œè®¾è®¡ä¸€ä¸ªåˆé€‚é•¿åº¦çš„æ•°æ®å­˜å‚¨ï¼Œæ¯ä¸€ä½å¯¹åº”ä¸€ä½å®¢æˆ·ï¼Œç™»é™†åˆ™ä¸º1ï¼Œç»Ÿè®¡æ—¶ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶ä¸è¿ç®—ï¼Œåˆ™å¯ä»¥å»é‡ï¼Œç»Ÿè®¡é‚£äº›ç”¨æˆ·ç™»é™†
</code></pre>
<h5 id="2-2-Listsç±»å‹"><a href="#2-2-Listsç±»å‹" class="headerlink" title="2.2  Listsç±»å‹"></a>2.2  Listsç±»å‹</h5><h6 id="2-2-1-Listså¸¸è§å‘½ä»¤"><a href="#2-2-1-Listså¸¸è§å‘½ä»¤" class="headerlink" title="2.2.1 Listså¸¸è§å‘½ä»¤"></a>2.2.1 Listså¸¸è§å‘½ä»¤</h6><p><a href="https://redis.io/commands#list">Listsæ•°æ®ç›¸å…³æ“ä½œå‘½ä»¤</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#lpush å­˜æ”¾é¡ºåºä¸ºf e d c b a</span><br><span class="line">lpush k1 a b c d e f</span><br><span class="line">#rpush å­˜æ”¾é¡ºåºä¸ºa b c d e f</span><br><span class="line">rpush k2 a b c d e f</span><br><span class="line">#å–æ•°æ® lpop</span><br><span class="line">lpop k1 </span><br><span class="line">#lrangeæŒ‰ç…§èŒƒå›´å–</span><br><span class="line">lrange k1 0 -1ï¼ˆå–å…¨éƒ¨ï¼‰</span><br><span class="line">#lindex</span><br><span class="line">#lset</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113620.png" alt="image-20210219205233457"></p>
<h6 id="2-2-2åº”ç”¨åœºæ™¯"><a href="#2-2-2åº”ç”¨åœºæ™¯" class="headerlink" title="2.2.2åº”ç”¨åœºæ™¯"></a>2.2.2åº”ç”¨åœºæ™¯</h6><ol>
<li>ä½¿ç”¨lpushæ¨¡æ‹Ÿæ ˆï¼Œåè¿›å…ˆå‡º</li>
<li>ä½¿ç”¨rpushæ¨¡æ‹Ÿé˜Ÿåˆ—ï¼Œå…ˆè¿›å…ˆå‡ºï¼ˆä¹°ç¥¨æ’é˜Ÿé—®é¢˜ï¼‰</li>
<li>lindexæ¨¡æ‹Ÿæ•°ç»„ï¼Œç›´æ¥æ ¹æ®ä¸‹æ ‡å–ç›¸å…³æ•°æ®</li>
<li>blpopæ¨¡æ‹Ÿé˜»å¡å•æ’­é˜Ÿåˆ—ï¼ˆblpopä¼šè®©å¯¹åº”keyæœ‰åˆ™å¼¹å‡ºvalueï¼Œæ²¡æœ‰ä¼šé˜»å¡ç­‰å¾…keyæœ‰å€¼ï¼Œå¹¶ä¸”åªä¼šå¼¹å‡ºä¸€æ¬¡ï¼Œå½“å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å¯¹ä¸€ä¸ªkeyä½¿ç”¨blpopåˆ™å¯ä»¥å®ç°é˜»å¡å•æ’­ï¼‰</li>
</ol>
<h5 id="2-3-hashesç±»å‹"><a href="#2-3-hashesç±»å‹" class="headerlink" title="2.3 hashesç±»å‹"></a>2.3 hashesç±»å‹</h5><p>ç±»ä¼¼javaä¸­çš„hashmapï¼ˆkeyï¼Œhashmapï¼ˆkeyï¼Œvalueï¼‰ï¼‰ã€‚è¿™é‡Œé¢ç¬¬ä¸€ä¸ªkeyæ˜¯hashesçš„keyï¼Œhashmapï¼ˆkeyï¼Œvalueï¼‰æ‰æ˜¯value</p>
<h6 id="2-3-1-hasheså¸¸è§å‘½ä»¤"><a href="#2-3-1-hasheså¸¸è§å‘½ä»¤" class="headerlink" title="2.3.1 hasheså¸¸è§å‘½ä»¤"></a>2.3.1 hasheså¸¸è§å‘½ä»¤</h6><p><a href="https://redis.io/commands#hash">hasheså¸¸è§çš„å‘½ä»¤</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hdel</span><br><span class="line">hget</span><br><span class="line">hset</span><br><span class="line">hlen</span><br><span class="line">hincrbyfloat</span><br></pre></td></tr></table></figure>

<h6 id="2-3-2-åº”ç”¨åœºæ™¯ï¼š"><a href="#2-3-2-åº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="2.3.2 åº”ç”¨åœºæ™¯ï¼š"></a>2.3.2 åº”ç”¨åœºæ™¯ï¼š</h6><ol>
<li>å¯¹å‘˜å·¥è–ªæ°´è¿›è¡Œç»Ÿè®¡</li>
</ol>
<h5 id="2-4-setsæ•°æ®ç±»å‹"><a href="#2-4-setsæ•°æ®ç±»å‹" class="headerlink" title="2.4 setsæ•°æ®ç±»å‹"></a>2.4 setsæ•°æ®ç±»å‹</h5><p>Redis Set æ˜¯ String çš„æ— åºæ’åˆ—ã€‚<code>SADD</code> æŒ‡ä»¤æŠŠæ–°çš„å…ƒç´ æ·»åŠ åˆ° set ä¸­ã€‚å¯¹ set ä¹Ÿå¯åšä¸€äº›å…¶ä»–çš„æ“ä½œï¼Œæ¯”å¦‚æµ‹è¯•ä¸€ä¸ªç»™å®šçš„å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå¯¹ä¸åŒ set å–äº¤é›†ï¼Œå¹¶é›†æˆ–å·®ï¼Œç­‰ç­‰ã€‚</p>
<h6 id="2-4-1å¸¸è§å‘½ä»¤"><a href="#2-4-1å¸¸è§å‘½ä»¤" class="headerlink" title="2.4.1å¸¸è§å‘½ä»¤"></a>2.4.1å¸¸è§å‘½ä»¤</h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sadd &#x2F;&#x2F;æ·»åŠ å…ƒç´ </span><br><span class="line">sadd myset 1 2 3</span><br><span class="line">smembers &#x2F;&#x2F;è¯»å–é›†åˆå…ƒç´ </span><br><span class="line">smembers myset</span><br><span class="line">sismember &#x2F;&#x2F;åˆ¤æ–­å…ƒç´ å­˜åœ¨</span><br><span class="line">sismember myset 3 &#x2F;&#x2F;å­˜åœ¨è¿”å›1ï¼Œä¸å­˜åœ¨ä¸º0</span><br><span class="line"> SINTER  &#x2F;&#x2F;è·å–å¤šä¸ªé›†åˆçš„äº¤é›†</span><br><span class="line"> SUNIONSTORE  &#x2F;&#x2F;å¤šä¸ªé›†åˆå–å¹¶é›†</span><br></pre></td></tr></table></figure>

<h6 id="2-4-2-åº”ç”¨åœºæ™¯"><a href="#2-4-2-åº”ç”¨åœºæ™¯" class="headerlink" title="2.4.2 åº”ç”¨åœºæ™¯"></a>2.4.2 åº”ç”¨åœºæ™¯</h6><ol>
<li><p>å…¬å¹³æŠ½å¥–(éšæœºäº‹ä»¶) ï¼š  SRANDMEMBER key countï¼ˆç”¨æˆ·ä½œä¸ºvalueï¼‰</p>
<p> â€‹                        æ­£æ•°ï¼šå–å‡ºä¸€ä¸ªå»é‡çš„ç»“æœé›†ï¼ˆä¸èƒ½è¶…è¿‡å·²æœ‰é›†ï¼‰</p>
<p> â€‹                        è´Ÿæ•°ï¼šå–å‡ºä¸€ä¸ªå¸¦é‡å¤çš„ç»“æœé›†ï¼Œä¸€å®šæ»¡è¶³ä½ è¦çš„æ•°é‡å¦‚æœï¼š</p>
<p> â€‹                        0ï¼Œä¸è¿”å›</p>
</li>
</ol>
<h5 id="2-5-sorted-setsæ•°æ®ç±»å‹"><a href="#2-5-sorted-setsæ•°æ®ç±»å‹" class="headerlink" title="2.5 sorted setsæ•°æ®ç±»å‹"></a>2.5 sorted setsæ•°æ®ç±»å‹</h5><h6 id="2-5-1-å¸¸è§å‘½ä»¤"><a href="#2-5-1-å¸¸è§å‘½ä»¤" class="headerlink" title="2.5.1 å¸¸è§å‘½ä»¤"></a>2.5.1 å¸¸è§å‘½ä»¤</h6><p><a href="https://redis.io/commands#sorted_set">sorted setså¸¸è§å‘½ä»¤</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">zadd</span><br><span class="line">zmenmber</span><br><span class="line">zinter</span><br><span class="line">zscore &#x2F;&#x2F;æŒ‰ç…§ä»€ä¹ˆæ’åº</span><br></pre></td></tr></table></figure>

<h6 id="2-5-2-æ’åºåº•å±‚å®ç°"><a href="#2-5-2-æ’åºåº•å±‚å®ç°" class="headerlink" title="2.5.2 æ’åºåº•å±‚å®ç°"></a>2.5.2 æ’åºåº•å±‚å®ç°</h6><p>é€šè¿‡Skip listï¼ˆè·³è·ƒè¡¨ï¼‰å®ç°å¢åˆ æŸ¥æ”¹</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113634.png" alt="image-20210220102659707"></p>
]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>redisçš„æ¶ˆæ¯è®¢é˜…ï¼Œpipelineï¼Œäº‹åŠ¡</title>
    <url>/posts/d09e787/</url>
    <content><![CDATA[<h5 id="1-Redis-ç®¡é“ï¼ˆPipeliningï¼‰"><a href="#1-Redis-ç®¡é“ï¼ˆPipeliningï¼‰" class="headerlink" title="1.Redis ç®¡é“ï¼ˆPipeliningï¼‰"></a>1.Redis ç®¡é“ï¼ˆPipeliningï¼‰</h5><p><a href="http://redis.cn/topics/pipelining.html">Redis ç®¡é“ï¼ˆPipeliningï¼‰</a></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113641.png" alt="image-20210220103817162"></p>
<p>ä¸€æ¬¡è¯·æ±‚/å“åº”æœåŠ¡å™¨èƒ½å®ç°å¤„ç†æ–°çš„è¯·æ±‚å³ä½¿æ—§çš„è¯·æ±‚è¿˜æœªè¢«å“åº”ã€‚è¿™æ ·å°±å¯ä»¥å°†<em>å¤šä¸ªå‘½ä»¤</em>å‘é€åˆ°æœåŠ¡å™¨ï¼Œè€Œä¸ç”¨ç­‰å¾…å›å¤ï¼Œæœ€ååœ¨ä¸€ä¸ªæ­¥éª¤ä¸­è¯»å–è¯¥ç­”å¤ã€‚</p>
<p><strong>é‡è¦è¯´æ˜</strong>: ä½¿ç”¨ç®¡é“å‘é€å‘½ä»¤æ—¶ï¼ŒæœåŠ¡å™¨å°†è¢«è¿«å›å¤ä¸€ä¸ªé˜Ÿåˆ—ç­”å¤ï¼Œå ç”¨å¾ˆå¤šå†…å­˜ã€‚å¦‚æœéœ€è¦å‘é€å¤§é‡çš„å‘½ä»¤ï¼Œæœ€å¥½æ˜¯æŒ‰ç…§åˆç†æ•°é‡åˆ†æ‰¹æ¬¡çš„å¤„ç†ï¼Œä¾‹å¦‚10Kçš„å‘½ä»¤ï¼Œè¯»å›å¤ï¼Œç„¶åå†å‘é€å¦ä¸€ä¸ª10kçš„å‘½ä»¤ï¼Œç­‰ç­‰ã€‚è¿™æ ·é€Ÿåº¦å‡ ä¹æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯åœ¨å›å¤è¿™10kå‘½ä»¤é˜Ÿåˆ—éœ€è¦éå¸¸å¤§é‡çš„å†…å­˜ç”¨æ¥ç»„ç»‡è¿”å›æ•°æ®å†…å®¹ã€‚</p>
<h5 id="2-redisçš„æ¶ˆæ¯è®¢é˜…"><a href="#2-redisçš„æ¶ˆæ¯è®¢é˜…" class="headerlink" title="2. redisçš„æ¶ˆæ¯è®¢é˜…"></a>2. redisçš„æ¶ˆæ¯è®¢é˜…</h5><p><a href="http://redis.cn/topics/pubsub.html">redisçš„æ¶ˆæ¯è®¢é˜…</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PUBLISH  &#x2F;&#x2F;å‘å¸ƒæ¶ˆæ¯</span><br><span class="line">SUBSCRIBE foo bar</span><br><span class="line">SUBSCRIBE  &#x2F;&#x2F;æ¥æ”¶æŒ‡å®šé˜Ÿåˆ—æ¶ˆæ¯</span><br><span class="line">SUBSCRIBE foo</span><br></pre></td></tr></table></figure>

<h5 id="3-redisçš„äº‹åŠ¡"><a href="#3-redisçš„äº‹åŠ¡" class="headerlink" title="3. redisçš„äº‹åŠ¡"></a>3. redisçš„äº‹åŠ¡</h5><p><a href="http://redis.cn/topics/transactions.html">redisçš„äº‹åŠ¡</a></p>
<p><a href="http://redis.cn/commands/multi.html">MULTI</a> ã€ <a href="http://redis.cn/commands/exec.html">EXEC</a> ã€ <a href="http://redis.cn/commands/discard.html">DISCARD</a> å’Œ <a href="http://redis.cn/commands/watch.html">WATCH</a> æ˜¯ Redis äº‹åŠ¡ç›¸å…³çš„å‘½ä»¤ã€‚äº‹åŠ¡å¯ä»¥ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œ å¹¶ä¸”å¸¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªé‡è¦çš„ä¿è¯ï¼š</p>
<ul>
<li>äº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚</li>
<li>äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚</li>
</ul>
<p><a href="http://redis.cn/commands/exec.html">EXEC</a> å‘½ä»¤è´Ÿè´£è§¦å‘å¹¶æ‰§è¡Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼š</p>
<ul>
<li>å¦‚æœå®¢æˆ·ç«¯åœ¨ä½¿ç”¨ <a href="http://redis.cn/commands/multi.html">MULTI</a> å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ä¹‹åï¼Œå´å› ä¸ºæ–­çº¿è€Œæ²¡æœ‰æˆåŠŸæ‰§è¡Œ <a href="http://redis.cn/commands/exec.html">EXEC</a> ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚</li>
<li>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå®¢æˆ·ç«¯æˆåŠŸåœ¨å¼€å¯äº‹åŠ¡ä¹‹åæ‰§è¡Œ <a href="http://redis.cn/commands/exec.html">EXEC</a> ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œ</li>
</ul>
<blockquote>
<p><code> AOF æ–¹å¼åšæŒä¹…åŒ–</code>çš„æ—¶å€™ï¼ŒRedis ä¼šä½¿ç”¨å•ä¸ª write(2) å‘½ä»¤å°†äº‹åŠ¡å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚ç„¶è€Œï¼Œå¦‚æœ Redis æœåŠ¡å™¨å› ä¸ºæŸäº›åŸå› è¢«ç®¡ç†å‘˜æ€æ­»ï¼Œæˆ–è€…é‡ä¸ŠæŸç§ç¡¬ä»¶æ•…éšœï¼Œé‚£ä¹ˆå¯èƒ½åªæœ‰éƒ¨åˆ†äº‹åŠ¡å‘½ä»¤ä¼šè¢«æˆåŠŸå†™å…¥åˆ°ç£ç›˜ä¸­ã€‚å¦‚æœ Redis åœ¨é‡æ–°å¯åŠ¨æ—¶å‘ç° AOF æ–‡ä»¶å‡ºäº†è¿™æ ·çš„é—®é¢˜ï¼Œé‚£ä¹ˆå®ƒä¼šé€€å‡ºï¼Œå¹¶æ±‡æŠ¥ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>Redis (2.2ç‰ˆæœ¬å¼€å§‹)è¿˜å¯ä»¥é€šè¿‡ä¹è§‚é”ï¼ˆoptimistic lockï¼‰å®ç° CAS ï¼ˆcheck-and-setï¼‰æ“ä½œ</p>
</blockquote>
<h6 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h6><p><a href="http://redis.cn/commands/multi.html">MULTI</a> å‘½ä»¤ç”¨äºå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå®ƒæ€»æ˜¯è¿”å› <code>OK</code> ã€‚ <a href="http://redis.cn/commands/multi.html">MULTI</a> æ‰§è¡Œä¹‹åï¼Œ å®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘æœåŠ¡å™¨å‘é€ä»»æ„å¤šæ¡å‘½ä»¤ï¼Œ è¿™äº›å‘½ä»¤ä¸ä¼šç«‹å³è¢«æ‰§è¡Œï¼Œ è€Œæ˜¯è¢«æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œ å½“ <a href="http://redis.cn/commands/exec.html">EXEC</a>å‘½ä»¤è¢«è°ƒç”¨æ—¶ï¼Œ æ‰€æœ‰é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œ é€šè¿‡è°ƒç”¨ <a href="http://redis.cn/commands/discard.html">DISCARD</a> ï¼Œ å®¢æˆ·ç«¯å¯ä»¥æ¸…ç©ºäº‹åŠ¡é˜Ÿåˆ—ï¼Œ å¹¶æ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªäº‹åŠ¡ä¾‹å­ï¼Œ å®ƒåŸå­åœ°å¢åŠ äº† <code>foo</code> å’Œ <code>bar</code> ä¸¤ä¸ªé”®çš„å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">&gt; INCR foo</span><br><span class="line">QUEUED</span><br><span class="line">&gt; INCR bar</span><br><span class="line">QUEUED</span><br><span class="line">&gt; EXEC</span><br><span class="line">1) (integer) 1</span><br><span class="line">2) (integer) 1</span><br></pre></td></tr></table></figure>

<p><a href="http://redis.cn/commands/exec.html">EXEC</a> å‘½ä»¤çš„å›å¤æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ‰§è¡Œäº‹åŠ¡ä¸­çš„å‘½ä»¤æ‰€äº§ç”Ÿçš„å›å¤ã€‚ å…¶ä¸­ï¼Œ å›å¤å…ƒç´ çš„å…ˆåé¡ºåºå’Œå‘½ä»¤å‘é€çš„å…ˆåé¡ºåºä¸€è‡´ã€‚</p>
<p>å½“å®¢æˆ·ç«¯å¤„äºäº‹åŠ¡çŠ¶æ€æ—¶ï¼Œ æ‰€æœ‰ä¼ å…¥çš„å‘½ä»¤éƒ½ä¼šè¿”å›ä¸€ä¸ªå†…å®¹ä¸º <code>QUEUED</code> çš„çŠ¶æ€å›å¤ï¼ˆstatus replyï¼‰ï¼Œ è¿™äº›è¢«å…¥é˜Ÿçš„å‘½ä»¤å°†åœ¨ EXEC å‘½ä»¤è¢«è°ƒç”¨æ—¶æ‰§è¡Œ</p>
<h6 id="äº‹åŠ¡ä¸­çš„é”™è¯¯"><a href="#äº‹åŠ¡ä¸­çš„é”™è¯¯" class="headerlink" title="äº‹åŠ¡ä¸­çš„é”™è¯¯"></a>äº‹åŠ¡ä¸­çš„é”™è¯¯</h6><ul>
<li>äº‹åŠ¡åœ¨æ‰§è¡Œ <a href="http://redis.cn/commands/exec.html">EXEC</a> ä¹‹å‰ï¼Œå…¥é˜Ÿçš„å‘½ä»¤å¯èƒ½ä¼šå‡ºé”™ã€‚æ¯”å¦‚è¯´ï¼Œå‘½ä»¤å¯èƒ½ä¼šäº§ç”Ÿè¯­æ³•é”™è¯¯ï¼ˆå‚æ•°æ•°é‡é”™è¯¯ï¼Œå‚æ•°åé”™è¯¯ï¼Œç­‰ç­‰ï¼‰ï¼Œæˆ–è€…å…¶ä»–æ›´ä¸¥é‡çš„é”™è¯¯ï¼Œæ¯”å¦‚å†…å­˜ä¸è¶³ï¼ˆå¦‚æœæœåŠ¡å™¨ä½¿ç”¨ <code>maxmemory</code> è®¾ç½®äº†æœ€å¤§å†…å­˜é™åˆ¶çš„è¯ï¼‰ã€‚</li>
<li>å‘½ä»¤å¯èƒ½åœ¨ <a href="http://redis.cn/commands/exec.html">EXEC</a> è°ƒç”¨ä¹‹åå¤±è´¥ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œäº‹åŠ¡ä¸­çš„å‘½ä»¤å¯èƒ½å¤„ç†äº†é”™è¯¯ç±»å‹çš„é”®ï¼Œæ¯”å¦‚å°†åˆ—è¡¨å‘½ä»¤ç”¨åœ¨äº†å­—ç¬¦ä¸²é”®ä¸Šé¢ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</li>
</ul>
<p>æœåŠ¡å™¨ä¼šå¯¹å‘½ä»¤å…¥é˜Ÿå¤±è´¥çš„æƒ…å†µè¿›è¡Œè®°å½•ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯è°ƒç”¨ <a href="http://redis.cn/commands/exec.html">EXEC</a> å‘½ä»¤æ—¶ï¼Œ<strong>æ‹’ç»æ‰§è¡Œå¹¶è‡ªåŠ¨æ”¾å¼ƒè¿™ä¸ªäº‹åŠ¡</strong>ã€‚</p>
<h6 id="Redis-ä¸æ”¯æŒå›æ»šï¼ˆroll-backï¼‰åŸå› "><a href="#Redis-ä¸æ”¯æŒå›æ»šï¼ˆroll-backï¼‰åŸå› " class="headerlink" title="Redis ä¸æ”¯æŒå›æ»šï¼ˆroll backï¼‰åŸå› "></a>Redis ä¸æ”¯æŒå›æ»šï¼ˆroll backï¼‰åŸå› </h6><ul>
<li>Redis å‘½ä»¤åªä¼šå› ä¸ºé”™è¯¯çš„è¯­æ³•è€Œå¤±è´¥ï¼ˆå¹¶ä¸”è¿™äº›é—®é¢˜ä¸èƒ½åœ¨å…¥é˜Ÿæ—¶å‘ç°ï¼‰ï¼Œæˆ–æ˜¯å‘½ä»¤ç”¨åœ¨äº†é”™è¯¯ç±»å‹çš„é”®ä¸Šé¢ï¼šè¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œä»å®ç”¨æ€§çš„è§’åº¦æ¥è¯´ï¼Œ<strong>å¤±è´¥çš„å‘½ä»¤æ˜¯ç”±ç¼–ç¨‹é”™è¯¯é€ æˆçš„ï¼Œè€Œè¿™äº›é”™è¯¯åº”è¯¥åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­è¢«å‘ç°ï¼Œè€Œä¸åº”è¯¥å‡ºç°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­</strong>ã€‚</li>
<li>å› ä¸º<strong>ä¸éœ€è¦å¯¹å›æ»šè¿›è¡Œæ”¯æŒ</strong>ï¼Œæ‰€ä»¥ Redis çš„å†…éƒ¨å¯ä»¥ä¿æŒ<strong>ç®€å•ä¸”å¿«é€Ÿ</strong>ã€‚</li>
</ul>
<h5 id="4-å¸ƒéš†è¿‡æ»¤å™¨"><a href="#4-å¸ƒéš†è¿‡æ»¤å™¨" class="headerlink" title="4.å¸ƒéš†è¿‡æ»¤å™¨"></a>4.å¸ƒéš†è¿‡æ»¤å™¨</h5><p><a href="https://github.com/RedisBloom/RedisBloom">ç¬¬ä¸‰æ–¹å®ç°çš„redisçš„å¸ƒéš†è¿‡æ»¤å™¨</a></p>
<blockquote>
<p>ç¬¬ä¸‰æ–¹å®ç°redisçš„ç›¸å…³åŠŸèƒ½ï¼š <a href="https://redis.io/modules">https://redis.io/modules</a></p>
</blockquote>
<h5 id="5-redisçš„LRUï¼ˆLeast-Recently-Usedï¼‰æ·˜æ±°ç­–ç•¥"><a href="#5-redisçš„LRUï¼ˆLeast-Recently-Usedï¼‰æ·˜æ±°ç­–ç•¥" class="headerlink" title="5.redisçš„LRUï¼ˆLeast Recently Usedï¼‰æ·˜æ±°ç­–ç•¥"></a>5.redisçš„LRUï¼ˆLeast Recently Usedï¼‰æ·˜æ±°ç­–ç•¥</h5><p><a href="http://redis.cn/topics/lru-cache.html">å°†rediså½“åšä½¿ç”¨LRUç®—æ³•çš„ç¼“å­˜æ¥ä½¿ç”¨</a></p>
<p><strong>LRUæ˜¯Rediså”¯ä¸€æ”¯æŒçš„å›æ”¶æ–¹æ³•</strong>ï¼ŒRedisçš„<code>maxmemory</code>æŒ‡ä»¤ç”¨äºå°†å¯ç”¨å†…å­˜é™åˆ¶æˆä¸€ä¸ªå›ºå®šå¤§å°ï¼Œè¿˜åŒ…æ‹¬äº†Redisä½¿ç”¨çš„LRUç®—æ³•ï¼Œè¿™ä¸ªå®é™…ä¸Šåªæ˜¯è¿‘ä¼¼çš„LRUã€‚</p>
<p><strong>Redisçš„LRUç®—æ³•å¹¶éå®Œæ•´çš„å®ç°</strong>ã€‚è¿™æ„å‘³ç€<strong>Rediså¹¶æ²¡åŠæ³•é€‰æ‹©æœ€ä½³å€™é€‰æ¥è¿›è¡Œå›æ”¶</strong>ï¼Œä¹Ÿå°±æ˜¯æœ€ä¹…æœªè¢«è®¿é—®çš„é”®ã€‚ç›¸åå®ƒä¼šå°è¯•è¿è¡Œä¸€ä¸ªè¿‘ä¼¼LRUçš„ç®—æ³•ï¼Œ<strong>é€šè¿‡å¯¹å°‘é‡keysè¿›è¡Œå–æ ·ï¼Œç„¶åå›æ”¶å…¶ä¸­ä¸€ä¸ªæœ€å¥½çš„keyï¼ˆè¢«è®¿é—®æ—¶é—´è¾ƒæ—©çš„ï¼‰</strong>ã€‚</p>
<h6 id="å›æ”¶ç­–ç•¥"><a href="#å›æ”¶ç­–ç•¥" class="headerlink" title="å›æ”¶ç­–ç•¥"></a>å›æ”¶ç­–ç•¥</h6><p>ä»¥ä¸‹çš„ç­–ç•¥æ˜¯å¯ç”¨çš„:</p>
<ul>
<li><strong>noeviction</strong>:è¿”å›é”™è¯¯å½“å†…å­˜é™åˆ¶è¾¾åˆ°å¹¶ä¸”å®¢æˆ·ç«¯å°è¯•æ‰§è¡Œä¼šè®©æ›´å¤šå†…å­˜è¢«ä½¿ç”¨çš„å‘½ä»¤ï¼ˆå¤§éƒ¨åˆ†çš„å†™å…¥æŒ‡ä»¤ï¼Œä½†DELå’Œå‡ ä¸ªä¾‹å¤–ï¼‰</li>
<li><strong>allkeys-lru</strong>: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</li>
<li><strong>volatile-lru</strong>: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</li>
<li><strong>allkeys-random</strong>: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</li>
<li><strong>volatile-random</strong>: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®ã€‚</li>
<li><strong>volatile-ttl</strong>: å›æ”¶åœ¨è¿‡æœŸé›†åˆçš„é”®ï¼Œå¹¶ä¸”ä¼˜å…ˆå›æ”¶å­˜æ´»æ—¶é—´ï¼ˆTTLï¼‰è¾ƒçŸ­çš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</li>
</ul>
<h6 id="å›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œ"><a href="#å›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œ" class="headerlink" title="å›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œ"></a><strong>å›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œ</strong></h6><p>ç†è§£å›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œæ˜¯éå¸¸é‡è¦çš„:</p>
<ul>
<li>ä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚</li>
<li>Rediæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äºmaxmemoryçš„é™åˆ¶, åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚</li>
<li>ä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚</li>
<li>æ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚</li>
</ul>
<p>å¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚</p>
]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>redisæŒä¹…åŒ–</title>
    <url>/posts/dcfaa904/</url>
    <content><![CDATA[<h5 id="1-redisçš„æŒä¹…åŒ–æ–¹å¼"><a href="#1-redisçš„æŒä¹…åŒ–æ–¹å¼" class="headerlink" title="1. redisçš„æŒä¹…åŒ–æ–¹å¼"></a>1. redisçš„æŒä¹…åŒ–æ–¹å¼</h5><ol>
<li><p>RDBæŒä¹…åŒ–</p>
<p> åŸç†æ˜¯å°†<strong>Reidsåœ¨å†…å­˜ä¸­çš„æ•°æ®åº“è®°å½•å®šæ—¶dumpåˆ°ç£ç›˜ä¸Šçš„RDBæŒä¹…åŒ–</strong></p>
</li>
<li><p>AOFæŒä¹…åŒ–</p>
<p> åŸç†æ˜¯å°†<strong>Reidsçš„æ“ä½œæ—¥å¿—ä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥æ–‡ä»¶</strong></p>
<p> <a href="https://www.cnblogs.com/zxs117/p/11242026.html">ä¸¤ç§æŒä¹…åŒ–æ–¹å¼åŒºåˆ«</a></p>
<p> äºŒè€…é€‰æ‹©çš„æ ‡å‡†ï¼Œå°±æ˜¯çœ‹ç³»ç»Ÿæ˜¯æ„¿æ„ç‰ºç‰²ä¸€äº›æ€§èƒ½ï¼Œæ¢å–æ›´é«˜çš„ç¼“å­˜ä¸€è‡´æ€§ï¼ˆaofï¼‰ï¼Œè¿˜æ˜¯æ„¿æ„å†™æ“ä½œé¢‘ç¹çš„æ—¶å€™ï¼Œä¸å¯ç”¨å¤‡ä»½æ¥æ¢å–æ›´é«˜çš„æ€§èƒ½ï¼Œå¾…æ‰‹åŠ¨è¿è¡Œsaveçš„æ—¶å€™ï¼Œå†åšå¤‡ä»½ï¼ˆrdbï¼‰ã€‚rdbè¿™ä¸ªå°±æ›´æœ‰äº› eventually consistentçš„æ„æ€äº†ã€‚ä¸è¿‡ç”Ÿäº§ç¯å¢ƒå…¶å®æ›´å¤šéƒ½æ˜¯äºŒè€…ç»“åˆä½¿ç”¨çš„ã€‚</p>
</li>
</ol>
<h5 id="2-RDBæŒä¹…åŒ–"><a href="#2-RDBæŒä¹…åŒ–" class="headerlink" title="2.RDBæŒä¹…åŒ–"></a>2.RDBæŒä¹…åŒ–</h5><p><strong>åŸç†</strong> :åœ¨liunxç³»ç»Ÿç³»ç»Ÿä¸­ï¼Œ<strong>è¿›ç¨‹ä¹‹é—´çš„æ•°æ®æ˜¯éš”ç¦»çš„</strong>ï¼Œåœ¨ä½¿ç”¨exportçš„ç¯å¢ƒå˜é‡ï¼Œ<strong>çˆ¶å­è¿›ç¨‹çš„ä¿®æ”¹éƒ½ä¸ä¼šå½±å“åˆ°å…¶ä»–è¿›ç¨‹çš„æ•°æ®</strong></p>
<p>RDBæŒä¹…åŒ–æ˜¯æŒ‡åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œå®é™…æ“ä½œè¿‡ç¨‹æ˜¯<strong>forkä¸€ä¸ªå­è¿›ç¨‹</strong>ï¼Œå…ˆå°†<strong>æ•°æ®é›†å†™å…¥ä¸´æ—¶æ–‡ä»¶</strong>ï¼Œå†™å…¥æˆåŠŸåï¼Œå†æ›¿æ¢ä¹‹å‰çš„æ–‡ä»¶ï¼Œç”¨äºŒè¿›åˆ¶å‹ç¼©å­˜å‚¨ã€‚</p>
<h6 id="2-1-RDBçš„ä¼˜ç¼ºç‚¹"><a href="#2-1-RDBçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="2.1 RDBçš„ä¼˜ç¼ºç‚¹"></a>2.1 RDBçš„ä¼˜ç¼ºç‚¹</h6><p><strong>ä¼˜ç‚¹</strong>ï¼š </p>
<ol>
<li><strong>è¿˜åŸé€Ÿåº¦å¿«</strong>ï¼ˆç±»ä¼¼javaçš„å¯¹è±¡åºåˆ—åŒ–ï¼Œå¯å¿«é€Ÿè¿˜åŸï¼‰</li>
<li><strong>æ•´ä¸ªRedisæ•°æ®åº“å°†åªåŒ…å«ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™å¯¹äºæ–‡ä»¶å¤‡ä»½è€Œè¨€æ˜¯éå¸¸å®Œç¾çš„</strong>ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æ‰“ç®—æ¯ä¸ªå°æ—¶å½’æ¡£ä¸€æ¬¡æœ€è¿‘24å°æ—¶çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜è¦æ¯å¤©å½’æ¡£ä¸€æ¬¡æœ€è¿‘30å¤©çš„æ•°æ®ã€‚é€šè¿‡è¿™æ ·çš„å¤‡ä»½ç­–ç•¥ï¼Œä¸€æ—¦ç³»ç»Ÿå‡ºç°ç¾éš¾æ€§æ•…éšœï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸å®¹æ˜“çš„è¿›è¡Œæ¢å¤ã€‚</li>
</ol>
<p><strong>å¼Šç«¯</strong>ï¼š</p>
<ol>
<li>å¦‚æœä½ æƒ³ä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼Œå³æœ€å¤§é™åº¦çš„é¿å…æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆ<strong>RDBå°†ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚å› ä¸ºç³»ç»Ÿä¸€æ—¦åœ¨å®šæ—¶æŒä¹…åŒ–å®Œæˆä¹‹å‰å‡ºç°å®•æœºç°è±¡ï¼Œæ­¤å‰æ²¡æœ‰æ¥å¾—åŠå†™å…¥ç£ç›˜çš„æ•°æ®éƒ½å°†ä¸¢å¤±</strong>ã€‚</li>
<li> ç”±äºRDBæ˜¯é€šè¿‡forkå­è¿›ç¨‹æ¥ååŠ©å®Œæˆæ•°æ®æŒä¹…åŒ–å·¥ä½œçš„ï¼Œå› æ­¤ï¼Œ<strong>å¦‚æœå½“æ•°æ®é›†è¾ƒå¤§æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªæœåŠ¡å™¨åœæ­¢æœåŠ¡å‡ ç™¾æ¯«ç§’ï¼Œç”šè‡³æ˜¯1ç§’é’Ÿã€‚</strong></li>
</ol>
<blockquote>
<p>forkå‘½ä»¤åªæ˜¯åˆ›å»ºè¿›ç¨‹ï¼Œå¹¶ä¸ä¼šåœ¨æ­¤æ—¶è¿›è¡Œå¤åˆ¶ï¼Œå› æ­¤åˆ›å»ºè¿›ç¨‹çš„é€Ÿåº¦å˜å¿«</p>
<p>forkå‡ºæ¥çš„çˆ¶å­è¿›ç¨‹å…·æœ‰ <strong>ç›¸åŒä½†æ˜¯ç‹¬ç«‹çš„åœ°å€ç©ºé—´</strong>å› ä¸ºçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä»–ä»¬éƒ½æœ‰è‡ªå·±ç§æœ‰çš„åœ°å€ç©ºé—´ï¼Œå½“çˆ¶è¿›ç¨‹æˆ–è€…å­è¿›ç¨‹å•ç‹¬æ”¹å˜æ—¶ï¼Œä¸ä¼šå½±å“åˆ°å½¼æ­¤ï¼Œç±»ä¼¼äºc++çš„å†™å®æ‹·è´çš„å½¢å¼è‡ªå»ºä¸€ä¸ªå‰¯æœ¬</p>
<p><a href="https://blog.csdn.net/weixin_40853073/article/details/81873398?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control&dist_request_id=4254810a-f10f-43c5-8965-6b775b5a3682&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control">forkå‘½ä»¤è¯¦ç»†è¯´æ˜</a></p>
</blockquote>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113700.png" alt="image-20210221233300160"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226151043.png" alt="image-20210226151042967"></p>
<h5 id="3-AOFæŒä¹…åŒ–"><a href="#3-AOFæŒä¹…åŒ–" class="headerlink" title="3. AOFæŒä¹…åŒ–"></a>3. AOFæŒä¹…åŒ–</h5><p>AOFæŒä¹…åŒ–ä»¥<strong>æ—¥å¿—çš„å½¢å¼</strong>è®°å½•æœåŠ¡å™¨æ‰€å¤„ç†çš„<strong>æ¯ä¸€ä¸ªå†™ã€åˆ é™¤æ“ä½œ</strong>ï¼ŒæŸ¥è¯¢æ“ä½œä¸ä¼šè®°å½•ï¼Œä»¥æ–‡æœ¬çš„æ–¹å¼è®°å½•ï¼Œå¯ä»¥æ‰“å¼€æ–‡ä»¶çœ‹åˆ°è¯¦ç»†çš„æ“ä½œè®°å½•ã€‚</p>
<blockquote>
<p>å½“redisåŒæ—¶å¼€å¯RDBå’ŒAOFå¤‡ä»½ï¼Œredisæ¢å¤æ˜¯åªä¼šä¾æ®AOFçš„å¤‡ä»½ï¼ˆAOFçš„æ•°æ®ä¸¢å¤±è¾ƒå°‘ï¼‰</p>
</blockquote>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113653.png" alt="image-20210221233312115"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226151129.png" alt="image-20210226151129085"></p>
<h6 id="3-1-AOFçš„ä¼˜ç¼ºç‚¹"><a href="#3-1-AOFçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="3.1 AOFçš„ä¼˜ç¼ºç‚¹"></a>3.1 AOFçš„ä¼˜ç¼ºç‚¹</h6><p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<p>1). è¯¥æœºåˆ¶å¯ä»¥å¸¦æ¥<strong>æ›´é«˜çš„æ•°æ®å®‰å…¨æ€§ï¼Œå³æ•°æ®æŒä¹…æ€§</strong>ã€‚Redisä¸­æä¾›äº†3ä¸­åŒæ­¥ç­–ç•¥ï¼Œå³æ¯ç§’åŒæ­¥ã€æ¯ä¿®æ”¹åŒæ­¥å’Œä¸åŒæ­¥ã€‚äº‹å®ä¸Šï¼Œæ¯ç§’åŒæ­¥ä¹Ÿæ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œå…¶æ•ˆç‡ä¹Ÿæ˜¯éå¸¸é«˜çš„ï¼Œæ‰€å·®çš„æ˜¯ä¸€æ—¦ç³»ç»Ÿå‡ºç°å®•æœºç°è±¡ï¼Œé‚£ä¹ˆè¿™ä¸€ç§’é’Ÿä¹‹å†…ä¿®æ”¹çš„æ•°æ®å°†ä¼šä¸¢å¤±ã€‚è€Œæ¯ä¿®æ”¹åŒæ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºåŒæ­¥æŒä¹…åŒ–ï¼Œå³æ¯æ¬¡å‘ç”Ÿçš„æ•°æ®å˜åŒ–éƒ½ä¼šè¢«ç«‹å³è®°å½•åˆ°ç£ç›˜ä¸­ã€‚å¯ä»¥é¢„è§ï¼Œè¿™ç§æ–¹å¼åœ¨æ•ˆç‡ä¸Šæ˜¯æœ€ä½çš„ã€‚</p>
<p>2). ç”±äºè¯¥æœºåˆ¶å¯¹æ—¥å¿—æ–‡ä»¶çš„<strong>å†™å…¥æ“ä½œé‡‡ç”¨çš„æ˜¯appendæ¨¡å¼ï¼Œå› æ­¤åœ¨å†™å…¥è¿‡ç¨‹ä¸­å³ä½¿å‡ºç°å®•æœºç°è±¡ï¼Œä¹Ÿä¸ä¼šç ´åæ—¥å¿—æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨çš„å†…å®¹</strong>ã€‚ç„¶è€Œå¦‚æœæˆ‘ä»¬æœ¬æ¬¡æ“ä½œåªæ˜¯å†™å…¥äº†ä¸€åŠæ•°æ®å°±å‡ºç°äº†ç³»ç»Ÿå´©æºƒé—®é¢˜ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œåœ¨Redisä¸‹ä¸€æ¬¡å¯åŠ¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡redis-check-aofå·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬è§£å†³æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</strong></p>
<p>3). å¦‚æœ<strong>æ—¥å¿—è¿‡å¤§ï¼ŒRediså¯ä»¥è‡ªåŠ¨å¯ç”¨rewriteæœºåˆ¶</strong>ã€‚å³Redisä»¥appendæ¨¡å¼ä¸æ–­çš„å°†ä¿®æ”¹æ•°æ®å†™å…¥åˆ°è€çš„ç£ç›˜æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶Redisè¿˜ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç”¨äºè®°å½•æ­¤æœŸé—´æœ‰å“ªäº›ä¿®æ”¹å‘½ä»¤è¢«æ‰§è¡Œã€‚å› æ­¤åœ¨è¿›è¡Œrewriteåˆ‡æ¢æ—¶å¯ä»¥æ›´å¥½çš„ä¿è¯æ•°æ®å®‰å…¨æ€§ã€‚</p>
<blockquote>
<p>redis4.0ä»¥å‰ï¼šrewriteå…¶å®æ˜¯åˆ é™¤æŠµæ¶ˆçš„å‘½ä»¤ï¼ˆåˆ›å»ºå’Œåˆ é™¤ï¼‰ï¼Œåˆå¹¶é‡å¤çš„å‘½åã€‚æœ€ç»ˆä¼šç”Ÿæˆé‡å¤å‘½ä»¤</p>
<p>redis4.0ä»¥åï¼šå°†è€çš„æ•°æ®RDBåˆ°AOFä¸­ï¼Œå°†å¢é‡çš„ä»¥æŒ‡ä»¤çš„æ–¹å¼appendåˆ°aofä¸­ï¼ˆå®é™…å°±æ˜¯æ··åˆRDB+AOFçš„æŒä¹…åŒ–æ–¹å¼ï¼‰</p>
</blockquote>
<p>4). <strong>AOFåŒ…å«ä¸€ä¸ªæ ¼å¼æ¸…æ™°ã€æ˜“äºç†è§£çš„æ—¥å¿—æ–‡ä»¶ç”¨äºè®°å½•æ‰€æœ‰çš„ä¿®æ”¹æ“ä½œã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¯¥æ–‡ä»¶å®Œæˆæ•°æ®çš„é‡å»º</strong>ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<p>1). å¯¹äºç›¸åŒæ•°é‡çš„æ•°æ®é›†è€Œè¨€ï¼ŒAOFæ–‡ä»¶é€šå¸¸è¦å¤§äºRDBæ–‡ä»¶ã€‚<strong>RDB åœ¨æ¢å¤å¤§æ•°æ®é›†æ—¶çš„é€Ÿåº¦æ¯” AOF çš„æ¢å¤é€Ÿåº¦è¦å¿«ã€‚</strong></p>
<p>2). æ ¹æ®åŒæ­¥ç­–ç•¥çš„ä¸åŒï¼Œ<strong>AOFåœ¨è¿è¡Œæ•ˆç‡ä¸Šå¾€å¾€ä¼šæ…¢äºRDB</strong>ã€‚æ€»ä¹‹ï¼Œæ¯ç§’åŒæ­¥ç­–ç•¥çš„æ•ˆç‡æ˜¯æ¯”è¾ƒé«˜çš„ï¼ŒåŒæ­¥ç¦ç”¨ç­–ç•¥çš„æ•ˆç‡å’ŒRDBä¸€æ ·é«˜æ•ˆã€‚</p>
]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>redisé›†ç¾¤</title>
    <url>/posts/dcfaa904/</url>
    <content><![CDATA[<h5 id="1-å•èŠ‚ç‚¹redisçš„ç¼ºé™·"><a href="#1-å•èŠ‚ç‚¹redisçš„ç¼ºé™·" class="headerlink" title="1.å•èŠ‚ç‚¹redisçš„ç¼ºé™·"></a>1.å•èŠ‚ç‚¹redisçš„ç¼ºé™·</h5><ul>
<li>å•ç‚¹æ•…éšœå¯¼è‡´æœåŠ¡ä¸å¯ç”¨</li>
<li>redisçš„å®¹é‡ä¼˜å…ˆ</li>
<li>redisçš„æœåŠ¡å‹åŠ›</li>
</ul>
<h5 id="2-é›†ç¾¤çš„AKFåŸåˆ™"><a href="#2-é›†ç¾¤çš„AKFåŸåˆ™" class="headerlink" title="2. é›†ç¾¤çš„AKFåŸåˆ™"></a>2. é›†ç¾¤çš„AKFåŸåˆ™</h5><p><a href="https://www.cnblogs.com/-wenli/p/13584796.html">AKFåŸåˆ™</a></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113708.png" alt="image-20210222095931709"></p>
<blockquote>
<p>xè½´ï¼šå…¨é‡ï¼Œé•œåƒ</p>
<p>Yè½´ï¼šä¸šåŠ¡ï¼ŒåŠŸèƒ½</p>
<p>Zè½´ï¼šä¼˜å…ˆçº§ï¼Œé€»è¾‘å†æ‹†åˆ†</p>
</blockquote>
<h6 id="2-1-redisä½¿ç”¨AKFåŸåˆ™æ‰©å±•ä¸ºé›†ç¾¤äº§ç”Ÿçš„é—®é¢˜"><a href="#2-1-redisä½¿ç”¨AKFåŸåˆ™æ‰©å±•ä¸ºé›†ç¾¤äº§ç”Ÿçš„é—®é¢˜" class="headerlink" title="2.1 redisä½¿ç”¨AKFåŸåˆ™æ‰©å±•ä¸ºé›†ç¾¤äº§ç”Ÿçš„é—®é¢˜"></a>2.1 redisä½¿ç”¨AKFåŸåˆ™æ‰©å±•ä¸ºé›†ç¾¤äº§ç”Ÿçš„é—®é¢˜</h6><p>é€šè¿‡AKFä¸€å˜å¤š ï¼š<strong>æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong></p>
<p>â€‹                            </p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210223113717.png" alt="image-20210222102653774"></p>
<h5 id="3-CAPåŸåˆ™"><a href="#3-CAPåŸåˆ™" class="headerlink" title="3. CAPåŸåˆ™"></a>3. CAPåŸåˆ™</h5><p><a href="https://baike.baidu.com/item/CAP%E5%8E%9F%E5%88%99/5712863?fr=aladdin">CAPåŸåˆ™ç™¾ç§‘</a></p>
<p>CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ<a href="https://baike.baidu.com/item/%E4%B8%80%E8%87%B4%E6%80%A7/9840083">ä¸€è‡´æ€§</a>ï¼ˆConsistencyï¼‰ã€<a href="https://baike.baidu.com/item/%E5%8F%AF%E7%94%A8%E6%80%A7/109628">å¯ç”¨æ€§</a>ï¼ˆAvailabilityï¼‰ã€<a href="https://baike.baidu.com/item/%E5%88%86%E5%8C%BA%E5%AE%B9%E9%94%99%E6%80%A7/23734073">åˆ†åŒºå®¹é”™æ€§</a>ï¼ˆPartition toleranceï¼‰ã€‚CAP åŸåˆ™æŒ‡çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ª<a href="https://baike.baidu.com/item/%E8%A6%81%E7%B4%A0/5261200">è¦ç´ </a>æœ€å¤šåªèƒ½åŒæ—¶å®ç°ä¸¤ç‚¹ï¼Œä¸å¯èƒ½ä¸‰è€…å…¼é¡¾ã€‚</p>
<h5 id="4-Redisçš„å¤åˆ¶ï¼ˆåŒæ­¥ï¼‰"><a href="#4-Redisçš„å¤åˆ¶ï¼ˆåŒæ­¥ï¼‰" class="headerlink" title="4. Redisçš„å¤åˆ¶ï¼ˆåŒæ­¥ï¼‰"></a>4. Redisçš„å¤åˆ¶ï¼ˆåŒæ­¥ï¼‰</h5><p><a href="http://redis.cn/topics/replication.html">redisçš„å¤åˆ¶</a></p>
<p>Redisä½¿ç”¨é»˜è®¤çš„<strong>å¼‚æ­¥å¤åˆ¶</strong>ï¼Œå…¶ç‰¹ç‚¹æ˜¯ä½å»¶è¿Ÿå’Œé«˜æ€§èƒ½ï¼Œæ˜¯ç»å¤§å¤šæ•° Redis ç”¨ä¾‹çš„è‡ªç„¶å¤åˆ¶æ¨¡å¼ã€‚ä½†æ˜¯ï¼Œä» Redis æœåŠ¡å™¨ä¼šå¼‚æ­¥åœ°ç¡®è®¤å…¶ä»ä¸» Redis æœåŠ¡å™¨å‘¨æœŸæ¥æ”¶åˆ°çš„æ•°æ®é‡ã€‚</p>
<h6 id="4-1-rediså¤åˆ¶çš„é‡è¦ç»†èŠ‚"><a href="#4-1-rediså¤åˆ¶çš„é‡è¦ç»†èŠ‚" class="headerlink" title="4.1. rediså¤åˆ¶çš„é‡è¦ç»†èŠ‚"></a>4.1. rediså¤åˆ¶çš„é‡è¦ç»†èŠ‚</h6><ul>
<li>Redis ä½¿ç”¨å¼‚æ­¥å¤åˆ¶ï¼Œslave å’Œ master ä¹‹é—´å¼‚æ­¥åœ°ç¡®è®¤å¤„ç†çš„æ•°æ®é‡</li>
<li>ä¸€ä¸ª master å¯ä»¥æ‹¥æœ‰å¤šä¸ª slave</li>
<li>slave å¯ä»¥æ¥å—å…¶ä»– slave çš„è¿æ¥ã€‚é™¤äº†å¤šä¸ª slave å¯ä»¥è¿æ¥åˆ°åŒä¸€ä¸ª master ä¹‹å¤–ï¼Œ slave ä¹‹é—´ä¹Ÿå¯ä»¥åƒå±‚å çŠ¶çš„ç»“æ„ï¼ˆcascading-like structureï¼‰è¿æ¥åˆ°å…¶ä»– slave ã€‚è‡ª Redis 4.0 èµ·ï¼Œæ‰€æœ‰çš„ sub-slave å°†ä¼šä» master æ”¶åˆ°å®Œå…¨ä¸€æ ·çš„å¤åˆ¶æµã€‚</li>
<li>Redis å¤åˆ¶åœ¨ master ä¾§æ˜¯éé˜»å¡çš„ã€‚è¿™æ„å‘³ç€ master åœ¨ä¸€ä¸ªæˆ–å¤šä¸ª slave è¿›è¡Œåˆæ¬¡åŒæ­¥æˆ–è€…æ˜¯éƒ¨åˆ†é‡åŒæ­¥æ—¶ï¼Œå¯ä»¥ç»§ç»­å¤„ç†æŸ¥è¯¢è¯·æ±‚ã€‚</li>
<li>å¤åˆ¶åœ¨ slave ä¾§å¤§éƒ¨åˆ†ä¹Ÿæ˜¯éé˜»å¡çš„ã€‚å½“ slave è¿›è¡Œåˆæ¬¡åŒæ­¥æ—¶ï¼Œå®ƒå¯ä»¥ä½¿ç”¨æ—§æ•°æ®é›†å¤„ç†æŸ¥è¯¢è¯·æ±‚ï¼Œå‡è®¾ä½ åœ¨ redis.conf ä¸­é…ç½®äº†è®© Redis è¿™æ ·åšçš„è¯ã€‚å¦åˆ™ï¼Œä½ å¯ä»¥é…ç½®å¦‚æœå¤åˆ¶æµæ–­å¼€ï¼Œ Redis slave ä¼šè¿”å›ä¸€ä¸ª error ç»™å®¢æˆ·ç«¯ã€‚ä½†æ˜¯ï¼Œåœ¨åˆæ¬¡åŒæ­¥ä¹‹åï¼Œæ—§æ•°æ®é›†å¿…é¡»è¢«åˆ é™¤ï¼ŒåŒæ—¶åŠ è½½æ–°çš„æ•°æ®é›†ã€‚ slave åœ¨è¿™ä¸ªçŸ­æš‚çš„æ—¶é—´çª—å£å†…ï¼ˆå¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œä¼šæŒç»­è¾ƒé•¿æ—¶é—´ï¼‰ï¼Œä¼šé˜»å¡åˆ°æ¥çš„è¿æ¥è¯·æ±‚ã€‚è‡ª Redis 4.0 å¼€å§‹ï¼Œå¯ä»¥é…ç½® Redis ä½¿åˆ é™¤æ—§æ•°æ®é›†çš„æ“ä½œåœ¨å¦ä¸€ä¸ªä¸åŒçš„çº¿ç¨‹ä¸­è¿›è¡Œï¼Œä½†æ˜¯ï¼ŒåŠ è½½æ–°æ•°æ®é›†çš„æ“ä½œä¾ç„¶éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œå¹¶ä¸”ä¼šé˜»å¡ slave ã€‚</li>
<li>å¤åˆ¶æ—¢å¯ä»¥è¢«ç”¨åœ¨å¯ä¼¸ç¼©æ€§ï¼Œä»¥ä¾¿åªè¯»æŸ¥è¯¢å¯ä»¥æœ‰å¤šä¸ª slave è¿›è¡Œï¼ˆä¾‹å¦‚ O(N) å¤æ‚åº¦çš„æ…¢æ“ä½œå¯ä»¥è¢«ä¸‹æ”¾åˆ° slave ï¼‰ï¼Œæˆ–è€…ä»…ç”¨äºæ•°æ®å®‰å…¨ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨å¤åˆ¶æ¥é¿å… master å°†å…¨éƒ¨æ•°æ®é›†å†™å…¥ç£ç›˜é€ æˆçš„å¼€é”€ï¼šä¸€ç§å…¸å‹çš„æŠ€æœ¯æ˜¯é…ç½®ä½ çš„ master Redis.conf ä»¥é¿å…å¯¹ç£ç›˜è¿›è¡ŒæŒä¹…åŒ–ï¼Œç„¶åè¿æ¥ä¸€ä¸ª slave ï¼Œå…¶é…ç½®ä¸ºä¸å®šæœŸä¿å­˜æˆ–æ˜¯å¯ç”¨ AOFã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªè®¾ç½®å¿…é¡»å°å¿ƒå¤„ç†ï¼Œå› ä¸ºé‡æ–°å¯åŠ¨çš„ master ç¨‹åºå°†ä»ä¸€ä¸ªç©ºæ•°æ®é›†å¼€å§‹ï¼šå¦‚æœä¸€ä¸ª slave è¯•å›¾ä¸å®ƒåŒæ­¥ï¼Œé‚£ä¹ˆè¿™ä¸ª slave ä¹Ÿä¼šè¢«æ¸…ç©ºã€‚</li>
</ul>
<h6 id="Redis-å¤åˆ¶åŠŸèƒ½çš„ç»†èŠ‚è¿‡ç¨‹"><a href="#Redis-å¤åˆ¶åŠŸèƒ½çš„ç»†èŠ‚è¿‡ç¨‹" class="headerlink" title="Redis å¤åˆ¶åŠŸèƒ½çš„ç»†èŠ‚è¿‡ç¨‹"></a>Redis å¤åˆ¶åŠŸèƒ½çš„ç»†èŠ‚è¿‡ç¨‹</h6><p>master å¼€å¯ä¸€ä¸ª<strong>åå°ä¿å­˜è¿›ç¨‹ï¼Œä»¥ä¾¿äºç”Ÿäº§ä¸€ä¸ª RDB æ–‡ä»¶</strong>ã€‚åŒæ—¶å®ƒå¼€å§‹ç¼“å†²æ‰€æœ‰ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„æ–°çš„å†™å…¥å‘½ä»¤ã€‚å½“åå°ä¿å­˜å®Œæˆæ—¶ï¼Œ master å°†æ•°æ®é›†æ–‡ä»¶ä¼ è¾“ç»™ slaveï¼Œ slaveå°†ä¹‹ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œç„¶ååŠ è½½æ–‡ä»¶åˆ°å†…å­˜ã€‚å†ç„¶å master ä¼šå‘é€æ‰€æœ‰ç¼“å†²çš„å‘½ä»¤å‘ç»™ slaveã€‚è¿™ä¸ªè¿‡ç¨‹ä»¥æŒ‡ä»¤æµçš„å½¢å¼å®Œæˆå¹¶ä¸”å’Œ Redis åè®®æœ¬èº«çš„æ ¼å¼ç›¸åŒã€‚</p>
<p>ä½ å¯ä»¥ç”¨ telnet è‡ªå·±è¿›è¡Œå°è¯•ã€‚åœ¨æœåŠ¡å™¨æ­£åœ¨åšä¸€äº›å·¥ä½œçš„åŒæ—¶è¿æ¥åˆ° Redis ç«¯å£å¹¶å‘å‡º <a href="https://redis.io/commands/sync">SYNC</a> å‘½ä»¤ã€‚ä½ å°†ä¼šçœ‹åˆ°ä¸€ä¸ªæ‰¹é‡ä¼ è¾“ï¼Œå¹¶ä¸”ä¹‹åæ¯ä¸€ä¸ª master æ¥æ”¶åˆ°çš„å‘½ä»¤éƒ½å°†åœ¨ telnet å›è¯ä¸­è¢«é‡æ–°å‘å‡ºã€‚äº‹å®ä¸Š SYNC æ˜¯ä¸€ä¸ªæ—§åè®®ï¼Œåœ¨æ–°çš„ Redis å®ä¾‹ä¸­å·²ç»ä¸å†è¢«ä½¿ç”¨ï¼Œä½†æ˜¯å…¶ä»ç„¶å‘åå…¼å®¹ï¼šä½†å®ƒä¸å…è®¸éƒ¨åˆ†é‡åŒæ­¥ï¼Œæ‰€ä»¥ç°åœ¨ <strong>PSYNC</strong> è¢«ç”¨æ¥æ›¿ä»£ SYNCã€‚</p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226145730.png" alt="image-20210226145730728"></p>
<h5 id="5-Redisä¸­å“¨å…µsentinel"><a href="#5-Redisä¸­å“¨å…µsentinel" class="headerlink" title="5. Redisä¸­å“¨å…µsentinel"></a>5. Redisä¸­å“¨å…µsentinel</h5><p><a href="http://redis.cn/topics/sentinel.html">Redis çš„ Sentinel æ–‡æ¡£</a></p>
<p>Redis çš„ Sentinel ç³»ç»Ÿç”¨äºç®¡ç†å¤šä¸ª Redis æœåŠ¡å™¨ï¼ˆinstanceï¼‰ï¼Œ è¯¥ç³»ç»Ÿæ‰§è¡Œä»¥ä¸‹ä¸‰ä¸ªä»»åŠ¡ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoring</strong>ï¼‰ï¼š Sentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>
<li><strong>æé†’ï¼ˆNotificationï¼‰</strong>ï¼š å½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œ Sentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</li>
<li><strong>è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰</strong>ï¼š å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œ Sentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œ ä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚</li>
</ul>
<p>Redis Sentinel æ˜¯ä¸€ä¸ª<strong>åˆ†å¸ƒå¼ç³»ç»Ÿ</strong>ï¼Œ ä½ å¯ä»¥åœ¨ä¸€ä¸ªæ¶æ„ä¸­è¿è¡Œå¤šä¸ª Sentinel è¿›ç¨‹ï¼ˆprogressï¼‰ï¼Œ è¿™äº›è¿›ç¨‹ä½¿ç”¨<strong>æµè¨€åè®®ï¼ˆgossip protocols)**æ¥æ¥æ”¶å…³äºä¸»æœåŠ¡å™¨æ˜¯å¦ä¸‹çº¿çš„ä¿¡æ¯ï¼Œ å¹¶ä½¿ç”¨</strong>æŠ•ç¥¨åè®®**ï¼ˆagreement protocolsï¼‰æ¥å†³å®šæ˜¯å¦æ‰§è¡Œè‡ªåŠ¨æ•…éšœè¿ç§»ï¼Œ ä»¥åŠé€‰æ‹©å“ªä¸ªä»æœåŠ¡å™¨ä½œä¸ºæ–°çš„ä¸»æœåŠ¡å™¨</p>
<h6 id="å®¢è§‚ä¸‹çº¿å’Œä¸»è§‚ä¸‹çº¿"><a href="#å®¢è§‚ä¸‹çº¿å’Œä¸»è§‚ä¸‹çº¿" class="headerlink" title="å®¢è§‚ä¸‹çº¿å’Œä¸»è§‚ä¸‹çº¿"></a>å®¢è§‚ä¸‹çº¿å’Œä¸»è§‚ä¸‹çº¿</h6><ul>
<li>ä¸»è§‚ä¸‹çº¿ï¼ˆSubjectively Downï¼Œ ç®€ç§° SDOWNï¼‰æŒ‡çš„æ˜¯å•ä¸ª Sentinel å®ä¾‹å¯¹æœåŠ¡å™¨åšå‡ºçš„ä¸‹çº¿åˆ¤æ–­ã€‚</li>
<li>å®¢è§‚ä¸‹çº¿ï¼ˆObjectively Downï¼Œ ç®€ç§° ODOWNï¼‰æŒ‡çš„æ˜¯å¤šä¸ª Sentinel å®ä¾‹åœ¨å¯¹åŒä¸€ä¸ªæœåŠ¡å™¨åšå‡º SDOWN åˆ¤æ–­ï¼Œ å¹¶ä¸”é€šè¿‡ SENTINEL is-master-down-by-addr å‘½ä»¤äº’ç›¸äº¤æµä¹‹åï¼Œ å¾—å‡ºçš„æœåŠ¡å™¨ä¸‹çº¿åˆ¤æ–­ã€‚ ï¼ˆä¸€ä¸ª Sentinel å¯ä»¥é€šè¿‡å‘å¦ä¸€ä¸ª Sentinel å‘é€ SENTINEL is-master-down-by-addr å‘½ä»¤æ¥è¯¢é—®å¯¹æ–¹æ˜¯å¦è®¤ä¸ºç»™å®šçš„æœåŠ¡å™¨å·²ä¸‹çº¿ã€‚ï¼‰</li>
</ul>
<p>å®¢è§‚ä¸‹çº¿æ¡ä»¶<strong>åªé€‚ç”¨äºä¸»æœåŠ¡å™¨</strong>ï¼š å¯¹äºä»»ä½•å…¶ä»–ç±»å‹çš„ Redis å®ä¾‹ï¼Œ Sentinel åœ¨å°†å®ƒä»¬åˆ¤æ–­ä¸ºä¸‹çº¿å‰ä¸éœ€è¦è¿›è¡Œåå•†ï¼Œ æ‰€ä»¥ä»æœåŠ¡å™¨æˆ–è€…å…¶ä»– Sentinel æ°¸è¿œä¸ä¼šè¾¾åˆ°å®¢è§‚ä¸‹çº¿æ¡ä»¶ã€‚</p>
<p>ä»ä¸»è§‚ä¸‹çº¿çŠ¶æ€åˆ‡æ¢åˆ°å®¢è§‚ä¸‹çº¿çŠ¶æ€å¹¶æ²¡æœ‰ä½¿ç”¨ä¸¥æ ¼çš„æ³•å®šäººæ•°ç®—æ³•ï¼ˆstrong quorum algorithmï¼‰ï¼Œ è€Œæ˜¯ä½¿ç”¨äº†<strong>æµè¨€åè®®</strong>ï¼š å¦‚æœ <strong>Sentinel åœ¨ç»™å®šçš„æ—¶é—´èŒƒå›´å†…ï¼Œ ä»å…¶ä»– Sentinel é‚£é‡Œæ¥æ”¶åˆ°äº†è¶³å¤Ÿæ•°é‡çš„ä¸»æœåŠ¡å™¨ä¸‹çº¿æŠ¥å‘Šï¼Œ é‚£ä¹ˆ Sentinel å°±ä¼šå°†ä¸»æœåŠ¡å™¨çš„çŠ¶æ€ä»ä¸»è§‚ä¸‹çº¿æ”¹å˜ä¸ºå®¢è§‚ä¸‹çº¿</strong>ã€‚ å¦‚æœä¹‹åå…¶ä»– Sentinel ä¸å†æŠ¥å‘Šä¸»æœåŠ¡å™¨å·²ä¸‹çº¿ï¼Œ é‚£ä¹ˆå®¢è§‚ä¸‹çº¿çŠ¶æ€å°±ä¼šè¢«ç§»é™¤ã€‚</p>
<h5 id="6-Redisé›†ç¾¤"><a href="#6-Redisé›†ç¾¤" class="headerlink" title="6.Redisé›†ç¾¤"></a>6.Redisé›†ç¾¤</h5><p><a href="http://redis.cn/topics/cluster-tutorial.html">redisé›†ç¾¤æ•™ç¨‹</a></p>
<h6 id="Redisé›†ç¾¤çš„æ‹†åˆ†æ–¹æ¡ˆ"><a href="#Redisé›†ç¾¤çš„æ‹†åˆ†æ–¹æ¡ˆ" class="headerlink" title="Redisé›†ç¾¤çš„æ‹†åˆ†æ–¹æ¡ˆ"></a>Redisé›†ç¾¤çš„æ‹†åˆ†æ–¹æ¡ˆ</h6><ul>
<li>æ•°æ®å¯ä»¥åˆ†ç±»ï¼Œäº¤é›†ä¸å¤š</li>
<li>æ•°æ®æ²¡åŠæ³•æ‹†åˆ†,ç”¨ä¸€è‡´æ€§hashç®—æ³•è¿›è¡Œæ‹†åˆ†(redis-cluster)</li>
</ul>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226152546.png" alt="image-20210226152546200"></p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226153455.png" alt="image-20210226153454965"></p>
<h6 id="ä¸€è‡´æ€§hashç®—æ³•"><a href="#ä¸€è‡´æ€§hashç®—æ³•" class="headerlink" title="ä¸€è‡´æ€§hashç®—æ³•"></a>ä¸€è‡´æ€§hashç®—æ³•</h6><p>å¸Œç®—æ³•å°±æ˜¯å°†ä»»æ„é•¿åº¦çš„äºŒè¿›åˆ¶å€¼æ˜ å°„ä¸ºè¾ƒçŸ­çš„å›ºå®šé•¿åº¦çš„å”¯ä¸€çš„äºŒè¿›åˆ¶å€¼(å³å“ˆå¸Œå€¼)ã€‚æ•²é»‘æ¿ï¼Œå“ˆå¸Œç®—æ³•çš„å…¥å‚å¯ä»¥æ˜¯ä»»æ„é•¿åº¦ï¼Œè€Œå‡ºå‚æ˜¯å›ºå®šé•¿åº¦è€Œä¸”å”¯ä¸€ã€‚ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å°±æ˜¯ï¼Œå…ˆæ„é€ ä¸€ä¸ª0åˆ°2^32çš„æ•´æ•°ç¯(hashç¯ï¼Œjavaä¸­å¯ç”¨SortedMapå®ç°)ï¼Œæ ¹æ®ç¼“å­˜æœåŠ¡å™¨åç§°(ä¹Ÿå¯ä»¥æ˜¯ip:port)è®¡ç®—å‡ºhashå€¼ï¼Œæ ¹æ®å…¶hashå€¼å°†ç¼“å­˜æœåŠ¡å™¨æ”¾ç½®åœ¨hashç¯ä¸Šã€‚æ¯æ¬¡æ ¹æ®è¦ç¼“å­˜çš„keyè®¡ç®—å¾—åˆ°hashå€¼ï¼Œåœ¨hashç¯ä¸Šé¡ºæ—¶é’ˆæŸ¥æ‰¾è·ç¦»æœ€è¿‘çš„ç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹(SortedMap.tailMap(key)å®ç°)ï¼Œè¿›è¡Œset/setæ“ä½œ<br><img src="https://gitee.com/CNRF/image/raw/master/img/20210226153659.png" alt="image-20210226153659880"></p>
<p><strong>ä¸€è‡´æ€§hashç®—æ³•çš„é—®é¢˜</strong></p>
<p>1.åŠ å‡ç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹ä¼šé€ æˆhashç¯éƒ¨åˆ†æ•°æ®æ— æ³•å‘½ä¸­ï¼›</p>
<p>2.å°‘é‡ç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹æ—¶ï¼Œæ•°æ®åˆ†å¸ƒä¸å‡åŒ€ï¼ŒåŒæ—¶ç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹å˜åŒ–å°†å½±å“å¤§èŒƒå›´æ•°æ®;</p>
<p>3.æ™®é€šçš„ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒºéœ€è¦å¢åŠ ä¸€å€æˆ–å‡æ‰ä¸€åŠç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹æ‰èƒ½ä¿æŒæ•°æ®è´Ÿè½½å‡è¡¡ï¼›</p>
<p>å½“åªæœ‰å°‘é‡ç¼“å­˜æœåŠ¡å™¨åˆæƒ³å°½é‡ä¿è¯è´Ÿè½½å‡è¡¡æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡ç”¨ä¸‹é¢çš„åŠæ³•ï¼šå°†ä¸€ä¸ªç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹è™šæ‹Ÿæˆä¸€ç»„ï¼Œæ¯”å¦‚æŸå°ç¼“å­˜æœåŠ¡å™¨ä¸º192.168.2.1:6379ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶è™šæ‹Ÿæˆä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹æ•°ç»„ï¼Œä¸º192.168.2.1:6379-1ï¼Œ192.168.2.1:6379-2ï¼Œ192.168.2.1:6379-3â€¦â€¦ç„¶ååˆ†åˆ«è®¡ç®—æ•°ç»„é‡Œçš„å…ƒç´ çš„hashå€¼å¹¶æ˜ å°„åˆ°hashç¯ä¸Šï¼Œæ¯å°ç¼“å­˜æœåŠ¡å™¨éƒ½å¦‚æ­¤å¤„ç†ã€‚å½“ä¸åŒkeyçš„ç¼“å­˜è·¯ç”±åˆ°è™šæ‹ŸèŠ‚ç‚¹æ—¶ï¼Œæœ€ç»ˆéƒ½æ˜¯æŒ‡å‘çœŸå®çš„ç¼“å­˜æœåŠ¡å™¨èŠ‚ç‚¹ã€‚é€šè¿‡è¿™æ ·å¢åŠ èŠ‚ç‚¹çš„æ–¹å¼ï¼Œå¯ä»¥ä¸€å®šæ¦‚ç‡ä¸Šä½¿æ•°æ®è·¯ç”±å‡è¡¡</p>
<h6 id="redis-cluster"><a href="#redis-cluster" class="headerlink" title="redis-cluster"></a>redis-cluster</h6><p> Redis-Clusteré‡‡ç”¨æ— ä¸­å¿ƒç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çŠ¶æ€,æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ã€‚</p>
<p> å…¶ç»“æ„ç‰¹ç‚¹ï¼š<br> 1ã€æ‰€æœ‰çš„redisèŠ‚ç‚¹å½¼æ­¤äº’è”(PING-PONGæœºåˆ¶),å†…éƒ¨ä½¿ç”¨äºŒè¿›åˆ¶åè®®ä¼˜åŒ–ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½ã€‚<br> 2ã€èŠ‚ç‚¹çš„failæ˜¯é€šè¿‡é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ£€æµ‹å¤±æ•ˆæ—¶æ‰ç”Ÿæ•ˆã€‚<br> 3ã€å®¢æˆ·ç«¯ä¸redisèŠ‚ç‚¹ç›´è¿,ä¸éœ€è¦ä¸­é—´proxyå±‚.å®¢æˆ·ç«¯ä¸éœ€è¦è¿æ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹,è¿æ¥é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹å³å¯ã€‚<br> 4ã€redis-clusteræŠŠæ‰€æœ‰çš„ç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°[0-16383]slotä¸Šï¼ˆä¸ä¸€å®šæ˜¯å¹³å‡åˆ†é…ï¼‰,cluster è´Ÿè´£ç»´æŠ¤node&lt;-&gt;slot&lt;-&gt;valueã€‚<br> 5ã€Redisé›†ç¾¤é¢„åˆ†å¥½16384ä¸ªæ¡¶ï¼Œå½“éœ€è¦åœ¨ Redis é›†ç¾¤ä¸­æ”¾ç½®ä¸€ä¸ª key-value æ—¶ï¼Œæ ¹æ® CRC16(key) mod 16384çš„å€¼ï¼Œå†³å®šå°†ä¸€ä¸ªkeyæ”¾åˆ°å“ªä¸ªæ¡¶ä¸­ã€‚</p>
<p><strong>a.redis clusterèŠ‚ç‚¹åˆ†é…</strong><br> ç°åœ¨æˆ‘ä»¬æ˜¯ä¸‰ä¸ªä¸»èŠ‚ç‚¹åˆ†åˆ«æ˜¯ï¼šA, B, C ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸€å°æœºå™¨ä¸Šçš„ä¸‰ä¸ªç«¯å£ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸‰å°ä¸åŒçš„æœåŠ¡å™¨ã€‚é‚£ä¹ˆï¼Œé‡‡ç”¨å“ˆå¸Œæ§½ (hash slot)çš„æ–¹å¼æ¥åˆ†é…16384ä¸ªslot çš„è¯ï¼Œå®ƒä»¬ä¸‰ä¸ªèŠ‚ç‚¹åˆ†åˆ«æ‰¿æ‹…çš„slot åŒºé—´æ˜¯ï¼š</p>
<ul>
<li><p>èŠ‚ç‚¹Aè¦†ç›–0ï¼5460;</p>
</li>
<li><p>èŠ‚ç‚¹Bè¦†ç›–5461ï¼10922;</p>
</li>
<li><p>èŠ‚ç‚¹Cè¦†ç›–10923ï¼16383.</p>
<p>  è·å–æ•°æ®:<br>   å¦‚æœå­˜å…¥ä¸€ä¸ªå€¼ï¼ŒæŒ‰ç…§redis clusterå“ˆå¸Œæ§½çš„<a href="http://lib.csdn.net/base/datastructure">ç®—æ³•</a>ï¼š CRC16(â€˜keyâ€™)384 = 6782ã€‚ é‚£ä¹ˆå°±ä¼šæŠŠè¿™ä¸ªkey çš„å­˜å‚¨åˆ†é…åˆ° B ä¸Šäº†ã€‚åŒæ ·ï¼Œå½“æˆ‘è¿æ¥(A,B,C)ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹æƒ³è·å–â€™keyâ€™è¿™ä¸ªkeyæ—¶ï¼Œä¹Ÿä¼šè¿™æ ·çš„ç®—æ³•ï¼Œç„¶åå†…éƒ¨è·³è½¬åˆ°BèŠ‚ç‚¹ä¸Šè·å–æ•°æ®</p>
<p>  æ–°å¢ä¸€ä¸ªä¸»èŠ‚ç‚¹:<br>   æ–°å¢ä¸€ä¸ªèŠ‚ç‚¹Dï¼Œredis clusterçš„è¿™ç§åšæ³•æ˜¯ä»å„ä¸ªèŠ‚ç‚¹çš„å‰é¢å„æ‹¿å–ä¸€éƒ¨åˆ†slotåˆ°Dä¸Šï¼Œæˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„å®è·µä¸­å®éªŒã€‚å¤§è‡´å°±ä¼šå˜æˆè¿™æ ·ï¼š</p>
</li>
<li><p>èŠ‚ç‚¹Aè¦†ç›–1365-5460</p>
</li>
<li><p>èŠ‚ç‚¹Bè¦†ç›–6827-10922</p>
</li>
<li><p>èŠ‚ç‚¹Cè¦†ç›–12288-16383</p>
</li>
<li><p>èŠ‚ç‚¹Dè¦†ç›–0-1364,5461-6826,10923-12287</p>
</li>
</ul>
<p>åŒæ ·åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œç§»åŠ¨å®Œæˆåå°±å¯ä»¥åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹äº†ã€‚</p>
<p><strong>b.Redis Clusterä¸»ä»æ¨¡å¼</strong><br> redis cluster ä¸ºäº†ä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼ŒåŠ å…¥äº†ä¸»ä»æ¨¡å¼ï¼Œä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹æä¾›æ•°æ®å­˜å–ï¼Œä»èŠ‚ç‚¹åˆ™æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–æ•°æ®å¤‡ä»½ï¼Œå½“è¿™ä¸ªä¸»èŠ‚ç‚¹æŒ‚æ‰åï¼Œå°±ä¼šæœ‰è¿™ä¸ªä»èŠ‚ç‚¹é€‰å–ä¸€ä¸ªæ¥å……å½“ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯é›†ç¾¤ä¸ä¼šæŒ‚æ‰</p>
<p>ä¸Šé¢é‚£ä¸ªä¾‹å­é‡Œ, é›†ç¾¤æœ‰ABCä¸‰ä¸ªä¸»èŠ‚ç‚¹, å¦‚æœè¿™3ä¸ªèŠ‚ç‚¹éƒ½æ²¡æœ‰åŠ å…¥ä»èŠ‚ç‚¹ï¼Œå¦‚æœBæŒ‚æ‰äº†ï¼Œæˆ‘ä»¬å°±æ— æ³•è®¿é—®æ•´ä¸ªé›†ç¾¤äº†ã€‚Aå’ŒCçš„slotä¹Ÿæ— æ³•è®¿é—®ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨é›†ç¾¤å»ºç«‹çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ·»åŠ äº†ä»èŠ‚ç‚¹, æ¯”å¦‚åƒè¿™æ ·, é›†ç¾¤åŒ…å«ä¸»èŠ‚ç‚¹Aã€Bã€C, ä»¥åŠä»èŠ‚ç‚¹A1ã€B1ã€C1, é‚£ä¹ˆå³ä½¿BæŒ‚æ‰ç³»ç»Ÿä¹Ÿå¯ä»¥ç»§ç»­æ­£ç¡®å·¥ä½œã€‚</p>
<p>B1èŠ‚ç‚¹æ›¿ä»£äº†BèŠ‚ç‚¹ï¼Œæ‰€ä»¥Redisé›†ç¾¤å°†ä¼šé€‰æ‹©B1èŠ‚ç‚¹ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œé›†ç¾¤å°†ä¼šç»§ç»­æ­£ç¡®åœ°æä¾›æœåŠ¡ã€‚ å½“Bé‡æ–°å¼€å¯åï¼Œå®ƒå°±ä¼šå˜æˆB1çš„ä»èŠ‚ç‚¹ã€‚</p>
<p>ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå¦‚æœ<strong>èŠ‚ç‚¹Bå’ŒB1åŒæ—¶æŒ‚äº†ï¼ŒRedisé›†ç¾¤å°±æ— æ³•ç»§ç»­æ­£ç¡®åœ°æä¾›æœåŠ¡äº†</strong>ã€‚</p>
<h5 id="8-Redisé›†ç¾¤çš„ä»£ç†"><a href="#8-Redisé›†ç¾¤çš„ä»£ç†" class="headerlink" title="8.Redisé›†ç¾¤çš„ä»£ç†"></a>8.Redisé›†ç¾¤çš„ä»£ç†</h5><p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226154729.png" alt="image-20210226154729661"></p>
<p><a href="https://blog.csdn.net/qq_34944535/article/details/106803261?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-5.control&dist_request_id=46a127bd-e7dd-4660-b485-d998c0726304&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-5.control">redis clusterä»£ç†</a></p>
<p>ç›®å‰å¸‚é¢ä¸Šä¸»æµçš„ä»£ç†åŒ…å«ï¼špredixyã€twemproxyã€codisã€redis-cerberuså››æ¬¾ï¼Œè¿™å››æ¬¾å„æœ‰å„çš„ä¼˜åŠ¿ï¼Œæˆ‘ä»¬é€ä¸ªå¯¹æ¯”è¿›è¡Œå¯¹æ¯”åˆ†æã€‚</p>
<div class="table-box"><table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td><strong>ç‰¹æ€§</strong></td><td><strong>predixy</strong></td><td><strong>twemproxy</strong></td><td><strong>codis</strong></td><td><strong>redis-cerberus</strong></td></tr><tr><td>é«˜å¯ç”¨</td><td>Redis Sentinelæˆ–Redis Cluster</td><td>ä¸€è‡´æ€§å“ˆå¸Œ</td><td>Redis Sentinel</td><td>Redis Cluster</td></tr><tr><td>å¯æ‰©å±•</td><td>Keyå“ˆå¸Œåˆ†å¸ƒæˆ–Redis Cluster</td><td>Keyå“ˆå¸Œåˆ†å¸ƒ</td><td>Keyå“ˆå¸Œåˆ†å¸ƒ</td><td>Redis Cluster</td></tr><tr><td>å¼€å‘è¯­è¨€</td><td>C++</td><td>C</td><td>GO</td><td>C++</td></tr><tr><td>å¤šçº¿ç¨‹</td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td></tr><tr><td>äº‹åŠ¡</td><td>Redis Sentinelæ¨¡å¼å•Redisç»„ä¸‹æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>BLPOP/BRPOP/BLPOPRPUSH</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>Pub/Sub</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>Script</td><td>æ”¯æŒload</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>Scan</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>Select DB</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td><td>Redis Clusteråªæœ‰ä¸€ä¸ªDB</td></tr><tr><td>Auth</td><td>æ”¯æŒå®šä¹‰å¤šä¸ªå¯†ç ï¼Œç»™äºˆä¸åŒè¯»å†™åŠç®¡ç†æƒé™å’ŒKeyè®¿é—®ç©ºé—´</td><td>ä¸æ”¯æŒ</td><td>åŒredis</td><td>ä¸æ”¯æŒ</td></tr><tr><td>è¯»ä»èŠ‚ç‚¹</td><td>æ”¯æŒï¼Œå¯å®šä¹‰ä¸°å¯Œè§„åˆ™è¯»æŒ‡å®šçš„ä»èŠ‚ç‚¹</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒï¼Œç®€å•è§„åˆ™</td><td>æ”¯æŒï¼Œç®€å•è§„åˆ™</td></tr><tr><td>å¤šæœºæˆ¿æ”¯æŒ</td><td>æ”¯æŒï¼Œå¯å®šä¹‰ä¸°å¯Œè§„åˆ™è°ƒåº¦æµé‡</td><td>ä¸æ”¯æŒ</td><td>æœ‰é™æ”¯æŒ</td><td>æœ‰é™æ”¯æŒ</td></tr><tr><td>ç»Ÿè®¡ä¿¡æ¯</td><td>ä¸°å¯Œ</td><td>ä¸°å¯Œ</td><td>ä¸°å¯Œ</td><td>ç®€å•</td></tr></tbody></table></div>

]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis çš„å‡»ç©¿ï¼Œç©¿é€ï¼Œé›ªå´©ï¼Œåˆ†å¸ƒå¼é”ï¼Œç¼“å­˜ä¸€è‡´æ€§</title>
    <url>/posts/dcfaa904/</url>
    <content><![CDATA[<h5 id="1-Redis-çš„å‡»ç©¿ï¼Œç©¿é€ï¼Œé›ªå´©"><a href="#1-Redis-çš„å‡»ç©¿ï¼Œç©¿é€ï¼Œé›ªå´©" class="headerlink" title="1. Redis çš„å‡»ç©¿ï¼Œç©¿é€ï¼Œé›ªå´©"></a>1. Redis çš„å‡»ç©¿ï¼Œç©¿é€ï¼Œé›ªå´©</h5><h6 id="1-1-Redis-å‡»ç©¿"><a href="#1-1-Redis-å‡»ç©¿" class="headerlink" title="1.1 Redis å‡»ç©¿"></a>1.1 Redis å‡»ç©¿</h6><p><strong>äº§ç”ŸåŸå› </strong>ï¼šåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œåœ¨æŸä¸€æ—¶é—´ç‚¹ï¼Œ<strong>åœ¨é«˜é¢‘è·å–çš„keyåœ¨æ­¤æ—¶è¿‡æœŸï¼Œå¤§é‡è¯·æ±‚ç›´æ¥è¯·æ±‚åˆ°æœåŠ¡å™¨ä¸Š</strong>ï¼Œå¯¼è‡´ç¼“å­˜å‡»ç©¿</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li><p>å¯ä»¥å°†<strong>çƒ­ç‚¹æ•°æ®è®¾ç½®ä¸ºæ°¸è¿œä¸è¿‡æœŸ</strong>ï¼›</p>
</li>
<li><p>åŸºäº <strong>redis</strong> or <strong>zookeeper</strong> å®ç°äº’æ–¥é”ï¼Œç­‰å¾…ç¬¬ä¸€ä¸ªè¯·æ±‚æ„å»ºå®Œç¼“å­˜ä¹‹åï¼Œå†é‡Šæ”¾é”ï¼Œè¿›è€Œå…¶å®ƒè¯·æ±‚æ‰èƒ½é€šè¿‡è¯¥ key è®¿é—®æ•°æ®ã€‚</p>
<blockquote>
<p>redisçš„åˆ†å¸ƒå¼é”ä¸»è¦æ˜¯é€šè¿‡  setnx å‘½ä»¤ï¼Œè®¾ç½®é”çš„è¿‡æœŸæ—¶é—´ï¼Œåªæœ‰è¿”å›æ˜¯okçš„æ‰èƒ½å»æ•°æ®åº“ä¸­è·å–æ•°æ®</p>
<p><strong>äº§ç”Ÿé—®é¢˜</strong>ï¼šåœ¨dbç«¯è¶…æ—¶å¯¼è‡´é”è¿‡æœŸ </p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š é€šè¿‡<strong>zookeeper</strong> å®ç°åˆ†å¸ƒå¼é”</p>
</blockquote>
</li>
</ul>
<h6 id="1-2-Redisç©¿é€"><a href="#1-2-Redisç©¿é€" class="headerlink" title="1.2 Redisç©¿é€"></a>1.2 Redisç©¿é€</h6><p>  ä¸€èˆ¬æ˜¯å‡ºç°è¿™ç§æƒ…å†µæ˜¯å› ä¸ºæ¶æ„é¢‘ç¹æŸ¥è¯¢æ‰ä¼šå¯¹ç³»ç»Ÿé€ æˆå¾ˆå¤§çš„é—®é¢˜: <strong>keyç¼“å­˜å¹¶ä¸”æ•°æ®åº“ä¸å­˜åœ¨</strong>ï¼Œæ‰€ä»¥<strong>æ¯æ¬¡æŸ¥è¯¢éƒ½ä¼šæŸ¥è¯¢æ•°æ®åº“ä»è€Œå¯¼è‡´æ•°æ®åº“å´©æºƒ</strong>ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨</p>
<blockquote>
<p>å¸ƒéš†è¿‡æ»¤å™¨ç¼ºç‚¹ï¼šåªèƒ½å¢åŠ ä¸èƒ½åˆ é™¤</p>
<p>å¯ä½¿ç”¨å¸ƒè°·é¸Ÿè¿‡æ»¤å™¨ ï¼Œè®¾ç½®ç©ºkey</p>
</blockquote>
<h6 id="1-3-Redisé›ªå´©"><a href="#1-3-Redisé›ªå´©" class="headerlink" title="1.3 Redisé›ªå´©"></a>1.3 Redisé›ªå´©</h6><p>é›ªå´©æŒ‡çš„æ˜¯<strong>å¤šä¸ªkey</strong>æŸ¥è¯¢å¹¶ä¸”å‡ºç°<strong>é«˜å¹¶å‘</strong>ï¼Œç¼“å­˜ä¸­å¤±æ•ˆæˆ–è€…æŸ¥ä¸åˆ°ï¼Œç„¶åéƒ½å»dbæŸ¥è¯¢ï¼Œä»è€Œå¯¼è‡´dbå‹åŠ›çªç„¶é£™å‡ï¼Œä»è€Œå´©æºƒã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li><p> æ—¶ç‚¹æ€§æ— å…³:<strong>å‡åŒ€çš„è®¾è®¡è¿‡æœŸæ—¶é—´</strong></p>
</li>
<li><p>æ—¶ç‚¹æ€§æœ‰å…³:<strong>å¼ºä¾èµ–å‡»ç©¿çš„æ–¹æ¡ˆ</strong></p>
<p>â€‹                    ä¹Ÿå¯åœ¨<strong>ç¨‹åºè®¾è®¡çš„æ—¶å€™åœ¨ä¸šåŠ¡å±‚è¿›è¡Œæ—¶ç‚¹è¿›è¡Œè¯·æ±‚å»¶æ—¶æ“ä½œ</strong></p>
<p>â€‹                    å½“çŸ¥é“<strong>æ—¶ç‚¹ä¹‹åçš„æ•°æ®ä¹Ÿå¯ä»¥è¿›è¡Œé¢„åŠ è½½å·¥ä½œ</strong></p>
</li>
<li><p>äº‹å‰ï¼šredis é«˜å¯ç”¨ï¼Œä¸»ä»+å“¨å…µï¼Œredis clusterï¼Œé¿å…å…¨ç›˜å´©æºƒã€‚</p>
</li>
<li><p> äº‹ä¸­ï¼šæœ¬åœ° ehcache ç¼“å­˜ + hystrix é™æµ&amp;é™çº§ï¼Œé¿å… MySQL è¢«æ‰“æ­»ã€‚</p>
</li>
<li><p>äº‹åï¼šredis æŒä¹…åŒ–ï¼Œä¸€æ—¦é‡å¯ï¼Œè‡ªåŠ¨ä»ç£ç›˜ä¸ŠåŠ è½½æ•°æ®ï¼Œå¿«é€Ÿæ¢å¤ç¼“å­˜æ•°æ®ã€‚</p>
<blockquote>
<p>æ—¶ç‚¹æ€§æœ‰å…³æŒ‡<strong>æŸä¸€ä¸ªæ—¶é—´æ®µæŸäº›keyå¿…é¡»è¦è¿‡æœŸä½¿ç”¨æ–°æ•°æ®</strong></p>
</blockquote>
</li>
</ul>
<h5 id="2-Redis-çš„åˆ†å¸ƒå¼é”å®ç°"><a href="#2-Redis-çš„åˆ†å¸ƒå¼é”å®ç°" class="headerlink" title="2. Redis  çš„åˆ†å¸ƒå¼é”å®ç°"></a>2. Redis  çš„åˆ†å¸ƒå¼é”å®ç°</h5><p>æœ€å¥½æ˜¯ä½¿ç”¨zookeeperå®ç°åˆ†å¸ƒå¼é”</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åŸç†éœ€è¦ä¸‰ä¸ªå…³é”®å…ƒç´ </span><br><span class="line">1. setnx</span><br><span class="line">2.è¿‡æœŸæ—¶é—´</span><br><span class="line">3.å¤šçº¿ç¨‹ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼Œå»¶é•¿è¿‡æœŸ</span><br></pre></td></tr></table></figure>

<h6 id="2-1-RedisåŠ é”å®ç°"><a href="#2-1-RedisåŠ é”å®ç°" class="headerlink" title="2.1 RedisåŠ é”å®ç°"></a>2.1 RedisåŠ é”å®ç°</h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTool</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LOCK_SUCCESS = <span class="string">&quot;OK&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SET_IF_NOT_EXIST = <span class="string">&quot;NX&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SET_WITH_EXPIRE_TIME = <span class="string">&quot;PX&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°è¯•è·å–åˆ†å¸ƒå¼é”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jedis Rediså®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lockKey é”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestId è¯·æ±‚æ ‡è¯†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expireTime è¶…æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦è·å–æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">tryGetDistributedLock</span><span class="params">(Jedis jedis, String lockKey, String requestId, <span class="keyword">int</span> expireTime)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result = jedis.set(lockKey, requestId, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, expireTime);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (LOCK_SUCCESS.equals(result)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="2-2-redis-è§£é”ä»£ç "><a href="#2-2-redis-è§£é”ä»£ç " class="headerlink" title="2.2 redis è§£é”ä»£ç "></a>2.2 redis è§£é”ä»£ç </h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTool</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Long RELEASE_SUCCESS = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡Šæ”¾åˆ†å¸ƒå¼é”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jedis Rediså®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lockKey é”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestId è¯·æ±‚æ ‡è¯†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦é‡Šæ”¾æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">releaseDistributedLock</span><span class="params">(Jedis jedis, String lockKey, String requestId)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String script = <span class="string">&quot;if redis.call(&#x27;get&#x27;, KEYS[1]) == ARGV[1] then return redis.call(&#x27;del&#x27;, KEYS[1]) else return 0 end&quot;</span>;</span><br><span class="line">        Object result = jedis.eval(script, Collections.singletonList(lockKey), Collections.singletonList(requestId));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (RELEASE_SUCCESS.equals(result)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Redisçš„å¼Šç«¯"><a href="#Redisçš„å¼Šç«¯" class="headerlink" title="Redisçš„å¼Šç«¯"></a>Redisçš„å¼Šç«¯</h6><ul>
<li>æ•°æ®åº“äº‹åŠ¡è¶…æ—¶ï¼Œå¯¼è‡´é”è¿‡æœŸ</li>
<li><code>redis cluster</code>é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œå‡å¦‚ç°åœ¨<code>Aå®¢æˆ·ç«¯</code>æƒ³è¦åŠ é”ï¼Œå®ƒä¼šæ ¹æ®è·¯ç”±è§„åˆ™é€‰æ‹©ä¸€å°<code>master</code>èŠ‚ç‚¹å†™å…¥<code>key</code> <code>mylock</code>ï¼Œåœ¨åŠ é”æˆåŠŸåï¼Œ<code>master</code>èŠ‚ç‚¹ä¼šæŠŠ<code>key</code>å¼‚æ­¥å¤åˆ¶ç»™å¯¹åº”çš„<code>slave</code>èŠ‚ç‚¹ã€‚å¦‚æœæ­¤æ—¶<code>redis master</code>èŠ‚ç‚¹å®•æœºï¼Œä¸ºä¿è¯é›†ç¾¤å¯ç”¨æ€§ï¼Œä¼šè¿›è¡Œ<code>ä¸»å¤‡åˆ‡æ¢</code>ï¼Œ<code>slave</code>å˜ä¸ºäº†<code>redis master</code>ã€‚<code>Bå®¢æˆ·ç«¯</code>åœ¨æ–°çš„<code>master</code>èŠ‚ç‚¹ä¸ŠåŠ é”æˆåŠŸï¼Œè€Œ<code>Aå®¢æˆ·ç«¯</code>ä¹Ÿä»¥ä¸ºè‡ªå·±è¿˜æ˜¯æˆåŠŸåŠ äº†é”çš„ã€‚æ­¤æ—¶å°±ä¼šå¯¼è‡´åŒä¸€æ—¶é—´å†…å¤šä¸ªå®¢æˆ·ç«¯å¯¹ä¸€ä¸ªåˆ†å¸ƒå¼é”å®Œæˆäº†åŠ é”ï¼Œå¯¼è‡´å„ç§è„æ•°æ®çš„äº§ç”Ÿã€‚</li>
</ul>
<h5 id="Redis-ç¼“å­˜ä¸€è‡´æ€§"><a href="#Redis-ç¼“å­˜ä¸€è‡´æ€§" class="headerlink" title="Redis ç¼“å­˜ä¸€è‡´æ€§"></a>Redis ç¼“å­˜ä¸€è‡´æ€§</h5><h6 id="å‡ºç°åœºæ™¯"><a href="#å‡ºç°åœºæ™¯" class="headerlink" title="å‡ºç°åœºæ™¯"></a>å‡ºç°åœºæ™¯</h6><p>åœ¨<strong>é«˜å¹¶å‘çš„æƒ…å†µ</strong>ä¸‹æ¶‰åŠåˆ°æ•°æ®æ›´æ–°ï¼šæ•°æ®åº“å’Œç¼“å­˜æ›´æ–°ï¼Œå°±å®¹æ˜“å‡ºç°<strong>ç¼“å­˜(Redis)å’Œæ•°æ®åº“ï¼ˆMySQLï¼‰é—´çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong>ã€‚</p>
<p>ä¸ç®¡æ˜¯å…ˆå†™MySQLæ•°æ®åº“ï¼Œå†åˆ é™¤Redisç¼“å­˜ï¼›è¿˜æ˜¯å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†å†™åº“ï¼Œéƒ½æœ‰å¯èƒ½å‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>1.å¦‚æœåˆ é™¤äº†ç¼“å­˜Redisï¼Œè¿˜æ²¡æœ‰æ¥å¾—åŠå†™åº“MySQLï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±æ¥è¯»å–ï¼Œå‘ç°ç¼“å­˜ä¸ºç©ºï¼Œåˆ™å»æ•°æ®åº“ä¸­è¯»å–æ•°æ®å†™å…¥ç¼“å­˜ï¼Œæ­¤æ—¶ç¼“å­˜ä¸­ä¸ºè„æ•°æ®ã€‚</p>
<p>2.å¦‚æœå…ˆå†™äº†åº“ï¼Œåœ¨åˆ é™¤ç¼“å­˜å‰ï¼Œå†™åº“çš„çº¿ç¨‹å®•æœºäº†ï¼Œæ²¡æœ‰åˆ é™¤æ‰ç¼“å­˜ï¼Œåˆ™ä¹Ÿä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´æƒ…å†µã€‚</p>
<p>å› ä¸º<strong>å†™å’Œè¯»æ˜¯å¹¶å‘</strong>çš„ï¼Œæ²¡æ³•ä¿è¯é¡ºåº,å°±ä¼šå‡ºç°ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>
<h6 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h6><p><strong>1.ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šé‡‡ç”¨å»¶æ—¶åŒåˆ ç­–ç•¥</strong></p>
<p>åœ¨å†™åº“å‰åéƒ½è¿›è¡Œredis.del(key)æ“ä½œï¼Œå¹¶ä¸”è®¾å®šåˆç†çš„è¶…æ—¶æ—¶é—´ã€‚</p>
<p>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(String key,Object data)</span></span>&#123;</span><br><span class="line"> redis.delKey(key);</span><br><span class="line"> db.updateData(data);</span><br><span class="line"> Thread.sleep(<span class="number">500</span>);</span><br><span class="line"> redis.delKey(key);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>å…·ä½“çš„æ­¥éª¤å°±æ˜¯ï¼š</strong></p>
<ul>
<li>å…ˆåˆ é™¤ç¼“å­˜ï¼›</li>
<li>å†å†™æ•°æ®åº“ï¼›</li>
<li>ä¼‘çœ 500æ¯«ç§’ï¼›</li>
<li>å†æ¬¡åˆ é™¤ç¼“å­˜</li>
</ul>
<p><strong>è¯¥æ–¹æ¡ˆçš„å¼Šç«¯</strong></p>
<p>ç»“åˆ<strong>åŒåˆ ç­–ç•¥+ç¼“å­˜è¶…æ—¶è®¾ç½®</strong>ï¼Œè¿™æ ·<strong>æœ€å·®çš„æƒ…å†µå°±æ˜¯åœ¨è¶…æ—¶æ—¶é—´å†…æ•°æ®å­˜åœ¨ä¸ä¸€è‡´ï¼Œè€Œä¸”åˆå¢åŠ äº†å†™è¯·æ±‚çš„è€—æ—¶ã€‚</strong></p>
<p><strong>2ã€ç¬¬äºŒç§æ–¹æ¡ˆï¼šå¼‚æ­¥æ›´æ–°ç¼“å­˜(åŸºäºè®¢é˜…binlogçš„åŒæ­¥æœºåˆ¶)</strong></p>
<p>MySQL binlogå¢é‡è®¢é˜…æ¶ˆè´¹+æ¶ˆæ¯é˜Ÿåˆ—+å¢é‡æ•°æ®æ›´æ–°åˆ°redis</p>
<ul>
<li><strong>è¯»Redis</strong>ï¼šçƒ­æ•°æ®åŸºæœ¬éƒ½åœ¨Redis</li>
<li><strong>å†™MySQL</strong>:å¢åˆ æ”¹éƒ½æ˜¯æ“ä½œMySQL</li>
<li><strong>æ›´æ–°Redisæ•°æ®</strong>ï¼šMySQçš„æ•°æ®æ“ä½œbinlogï¼Œæ¥æ›´æ–°åˆ°Redis</li>
</ul>
<p><strong>1ï¼‰æ•°æ®æ“ä½œä¸»è¦åˆ†ä¸ºä¸¤å¤§å—ï¼š</strong></p>
<ul>
<li>ä¸€ä¸ªæ˜¯å…¨é‡(å°†å…¨éƒ¨æ•°æ®ä¸€æ¬¡å†™å…¥åˆ°redis)</li>
<li>ä¸€ä¸ªæ˜¯å¢é‡ï¼ˆå®æ—¶æ›´æ–°ï¼‰</li>
</ul>
<p>è¿™é‡Œè¯´çš„æ˜¯å¢é‡,æŒ‡çš„æ˜¯mysqlçš„updateã€insertã€delateå˜æ›´æ•°æ®ã€‚</p>
<p><strong>2ï¼‰è¯»å–binlogååˆ†æ ï¼Œåˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—,æ¨é€æ›´æ–°å„å°çš„redisç¼“å­˜æ•°æ®ã€‚</strong></p>
<p>è¿™æ ·ä¸€æ—¦MySQLä¸­äº§ç”Ÿäº†æ–°çš„å†™å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œï¼Œå°±å¯ä»¥æŠŠbinlogç›¸å…³çš„æ¶ˆæ¯æ¨é€è‡³Redisï¼ŒRediså†æ ¹æ®binlogä¸­çš„è®°å½•ï¼Œå¯¹Redisè¿›è¡Œæ›´æ–°ã€‚</p>
<p>å…¶å®è¿™ç§æœºåˆ¶ï¼Œå¾ˆç±»ä¼¼MySQLçš„ä¸»ä»å¤‡ä»½æœºåˆ¶ï¼Œå› ä¸ºMySQLçš„ä¸»å¤‡ä¹Ÿæ˜¯é€šè¿‡binlogæ¥å®ç°çš„æ•°æ®ä¸€è‡´æ€§ã€‚</p>
<p><strong>æ¶ˆæ¯æ¨é€å·¥å…·</strong>ä½ ä¹Ÿå¯ä»¥é‡‡ç”¨åˆ«çš„ç¬¬ä¸‰æ–¹ï¼škafkaã€rabbitMQç­‰æ¥å®ç°æ¨é€æ›´æ–°Redisã€‚</p>
]]></content>
      <categories>
        <category>Redis</category>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>Redis</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoåšå®¢ä¼˜åŒ–Next7ä¸»é¢˜ä¼˜åŒ–</title>
    <url>/posts/33ffdf26/</url>
    <content><![CDATA[<h5 id="1-è®¾ç½®ç«™ç‚¹åç­‰"><a href="#1-è®¾ç½®ç«™ç‚¹åç­‰" class="headerlink" title="1.è®¾ç½®ç«™ç‚¹åç­‰"></a>1.è®¾ç½®ç«™ç‚¹åç­‰</h5><p>æ‰“å¼€<strong>æ ¹ç›®å½•ä¸‹çš„<code>_config.yml</code></strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">ä¸‰æ‰ç”Ÿçš„ä¸ªäººç¬”è®°</span>   <span class="comment">#æ ‡é¢˜</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">ä¸‰æ‰ç”Ÿçš„ä¸ªäººç¬”è®°</span>  <span class="comment">#æ ‡é¢˜</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">ä¸‰æ‰ç”Ÿçš„ä¸ªäººç¬”è®°</span> <span class="comment">#æ ‡é¢˜</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">CNRF</span>     <span class="comment">#ä½œè€…åç§°</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span>  <span class="comment">#è®¾ç½®ç®€ä½“ä¸­æ–‡</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">UTC</span>	<span class="comment">#è®¾ç½®æ—¶åŒº</span></span><br></pre></td></tr></table></figure>



<h5 id="2-é€‰æ‹©scheme"><a href="#2-é€‰æ‹©scheme" class="headerlink" title="2.é€‰æ‹©scheme"></a>2.é€‰æ‹©scheme</h5><p>åœ¨ä¸»ç›®å½•çš„\source_data\next.ymlä¸­ï¼Œ,æŸ¥æ‰¾<code>scheme</code></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure>

<h5 id="3-è®¾ç½®èœå•åŠå¯¹åº”é¡µé¢"><a href="#3-è®¾ç½®èœå•åŠå¯¹åº”é¡µé¢" class="headerlink" title="3. è®¾ç½®èœå•åŠå¯¹åº”é¡µé¢"></a>3. è®¾ç½®èœå•åŠå¯¹åº”é¡µé¢</h5><p>åœ¨ä¸»ç›®å½•çš„\source_data\next.ymlä¸­ï¼ŒæŸ¥æ‰¾<code>menu</code></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="attr">commonweal:</span> <span class="string">/404/</span> <span class="string">||</span> <span class="string">heartbeat</span></span><br></pre></td></tr></table></figure>

<p>å»æ‰<code>#</code>æ³¨é‡Šå³å¯æ˜¾ç¤ºå¯¹åº”çš„èœå•é¡¹ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ–°çš„èœå•é¡¹ã€‚ <code>||</code>ä¹‹å‰çš„å€¼æ˜¯ç›®æ ‡é“¾æ¥ï¼Œä¹‹åçš„æ˜¯åˆ†ç±»é¡µé¢çš„å›¾æ ‡ï¼Œå›¾æ ‡åç§°æ¥è‡ªäºFontAwesome iconã€‚è‹¥æ²¡æœ‰é…ç½®å›¾æ ‡ï¼Œé»˜è®¤ä¼šä½¿ç”¨é—®å·å›¾æ ‡ã€‚</p>
<p>æ–°æ·»åŠ çš„èœå•éœ€è¦ç¿»è¯‘å¯¹åº”çš„ä¸­æ–‡<br>æ‰“å¼€<code>hexo/theme/next/languages/zh-CN.yml</code>ï¼Œåœ¨menuä¸‹è‡ªå®šä¹‰ï¼Œå¦‚ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">resources:</span> <span class="string">èµ„æº</span></span><br></pre></td></tr></table></figure>

<p>é…ç½®æ–°å¢çš„èœå•</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">hexo new page &quot;commonweal&quot;</span><br></pre></td></tr></table></figure>

<p>åœ¨<strong>ä¸»ç›®å½•ä¸‹source</strong>æ–°å»º404.html</p>
<blockquote>
<p><strong>Hexo é»˜è®¤ä¼šæ¸²æŸ“æ‰€æœ‰çš„ HTML å’Œ Markdown æ–‡ä»¶</strong>ã€‚</p>
</blockquote>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥ç®€å•åœ°åœ¨æ–‡ä»¶å¼€å¤´åŠ ä¸Š <code>layout: false</code> ä¸€è¡Œæ¥é¿å…æ¸²æŸ“ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">+layout: false</span><br><span class="line">+---</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>404<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">homePageUrl</span>=<span class="string">&quot;/&quot;</span> <span class="attr">homePageName</span>=<span class="string">&quot;è¿”å›&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="4-è®¾å®šç«™ç‚¹å»ºç«‹æ—¶é—´"><a href="#4-è®¾å®šç«™ç‚¹å»ºç«‹æ—¶é—´" class="headerlink" title="4. è®¾å®šç«™ç‚¹å»ºç«‹æ—¶é—´"></a>4. è®¾å®šç«™ç‚¹å»ºç«‹æ—¶é—´</h5><p>æ‰“å¼€**<code>themes/next/</code>ä¸‹çš„<code>_config.yml</code>**ï¼ŒæŸ¥æ‰¾<code>since</code></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment"># Specify the date when the site was setup.</span></span><br><span class="line">  <span class="comment"># If not defined, current year will be used.</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2015</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¦‚æœä¸è®¾ç½®ï¼Œé»˜è®¤æ˜¾ç¤ºå½“å‰å¹´ä»½</strong>ã€‚</p>
<h5 id="5-è®¾ç½®å¤´åƒ"><a href="#5-è®¾ç½®å¤´åƒ" class="headerlink" title="5.è®¾ç½®å¤´åƒ"></a>5.è®¾ç½®å¤´åƒ</h5><p>æ‰“å¼€<code>themes/next/</code>ä¸‹çš„<code>_config.yml</code>ï¼ŒæŸ¥æ‰¾<code>avatar</code></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Sidebar Avatar</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/avatar111.png</span>  <span class="comment"># è®¾ç½®å¤´åƒèµ„æºçš„ä½ç½®</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">true</span>            <span class="comment"># å¼€å¯åœ†å½¢å¤´åƒ</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">1</span>               <span class="comment"># ä¸é€æ˜çš„æ¯”ä¾‹ï¼š0å°±æ˜¯å®Œå…¨é€æ˜</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span>           <span class="comment"># ä¸å¼€å¯æ—‹è½¬</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224210106.png" alt="image-20210224210106776"></p>
<p><code>avatar</code>çš„å€¼æ˜¯<strong>å›¾ç‰‡çš„é“¾æ¥åœ°å€</strong>(å®Œæ•´çš„URI æˆ–è€… ç«™å†…çš„ç›¸å¯¹åœ°å€çš†å¯)</p>
<table>
<thead>
<tr>
<th>åœ°å€</th>
<th>å€¼</th>
</tr>
</thead>
<tbody><tr>
<td>å®Œæ•´çš„URI</td>
<td><a href="http://example.com/avatar.png">http://example.com/avatar.png</a></td>
</tr>
<tr>
<td>ç«™ç‚¹å†…åœ°å€</td>
<td>å›¾ç‰‡æ”¾è‡³<code>themes/next/source/images/</code>é…ç½®ä¸ºï¼š<code>avatar: /images/å›¾ç‰‡å</code></td>
</tr>
<tr>
<td>ç«™ç‚¹å†…åœ°å€</td>
<td>å›¾ç‰‡æ”¾è‡³<strong>æ ¹ç›®å½•ä¸‹</strong><code>source/uploads/</code>(åˆå§‹æ— uploadsæ–‡ä»¶å¤¹ï¼Œè‡ªè¡Œåˆ›å»º)ç›®å½•ä¸‹é…ç½®ä¸ºï¼š<code>avatar: /uploads/å›¾ç‰‡å</code></td>
</tr>
</tbody></table>
<h5 id="6-ç½‘ç«™å›¾æ ‡è®¾ç½®"><a href="#6-ç½‘ç«™å›¾æ ‡è®¾ç½®" class="headerlink" title="6. ç½‘ç«™å›¾æ ‡è®¾ç½®"></a>6. ç½‘ç«™å›¾æ ‡è®¾ç½®</h5><ul>
<li><p>å›¾æ ‡ç´ æç½‘ç«™ï¼š<a href="https://www.iconfont.cn/">iconfont</a>ï¼›<a href="https://www.easyicon.net/">easyicon</a></p>
</li>
<li><p>ä¸‹è½½16x16ä»¥åŠ32x32å¤§å°çš„<strong>PNGæ ¼å¼å›¾æ ‡</strong>ï¼Œç½®äº<code>/themes/next/source/images/</code>ä¸‹</p>
</li>
<li><p>æ‰“å¼€**<code>source/_data</code>ä¸‹çš„<code>next.yml</code>**ï¼ŒæŸ¥æ‰¾<code>favicon</code></p>
  <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">/images/favicon-16x16-next.png</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">/images/favicon-32x32-next.png</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/images/apple-touch-icon-next.png</span></span><br><span class="line">  <span class="attr">safari_pinned_tab:</span> <span class="string">/images/logo.svg</span></span><br><span class="line">  <span class="comment">#android_manifest: /images/manifest.json</span></span><br><span class="line">  <span class="comment">#ms_browserconfig: /images/browserconfig.xml</span></span><br></pre></td></tr></table></figure>

<p>  ä¿®æ”¹smallå’Œmediumçš„è·¯å¾„ä¸ºä¸‹è½½çš„å›¾æ ‡è·¯å¾„</p>
</li>
</ul>
<h5 id="7-é…ç½®hexoæœ¬åœ°æœç´¢"><a href="#7-é…ç½®hexoæœ¬åœ°æœç´¢" class="headerlink" title="7.é…ç½®hexoæœ¬åœ°æœç´¢"></a>7.é…ç½®hexoæœ¬åœ°æœç´¢</h5><h6 id="7-1-æœ¬åœ°æœç´¢çš„åŸç†"><a href="#7-1-æœ¬åœ°æœç´¢çš„åŸç†" class="headerlink" title="7.1 æœ¬åœ°æœç´¢çš„åŸç†"></a>7.1 æœ¬åœ°æœç´¢çš„åŸç†</h6><p>å¯¹äºåŠ¨æ€ç½‘ç«™æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ php å®ç°ã€‚ä½†æ˜¯ï¼ŒHexo åšå®¢æ˜¯é™æ€ç½‘ç«™ï¼Œç”¨ä¸äº† phpã€‚</p>
<p>NexT ä¸»é¢˜å·²ç»å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒç”¨äº† Hexo çš„æ‹“å±•åŒ… <code>hexo-generator-searchdb</code>ï¼Œé¢„å…ˆç”Ÿæˆäº†ä¸€ä¸ªæ–‡æœ¬åº“ <code>search.xml</code>ï¼Œç„¶åä¼ åˆ°äº†ç½‘ç«™é‡Œé¢ã€‚åœ¨æœ¬åœ°æœç´¢çš„æ—¶å€™ï¼ŒNexT ç›´æ¥ç”¨ javascript è°ƒç”¨äº†è¿™ä¸ªæ–‡ä»¶ï¼Œä»è€Œå®ç°äº†é™æ€ç½‘ç«™çš„æœ¬åœ°æœç´¢ã€‚</p>
<h6 id="7-2-è®¾ç½®è¿‡ç¨‹"><a href="#7-2-è®¾ç½®è¿‡ç¨‹" class="headerlink" title="7.2 è®¾ç½®è¿‡ç¨‹"></a>7.2 è®¾ç½®è¿‡ç¨‹</h6><p>å®‰è£…æ’ä»¶:</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-search --save #å®‰è£… hexo-generator-search</span><br><span class="line">npm install hexo-generator-searchdb --save #å®‰è£… hexo-generator-searchdb</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬ä¿®æ”¹ç«™ç‚¹é…ç½®<code>_config.yml</code> æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœ¬åœ°æœç´¢</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>

<ul>
<li>pathï¼šç´¢å¼•æ–‡ä»¶çš„è·¯å¾„ï¼Œç›¸å¯¹äºç«™ç‚¹æ ¹ç›®å½•</li>
<li>fieldï¼šæœç´¢èŒƒå›´ï¼Œé»˜è®¤æ˜¯ postï¼Œè¿˜å¯ä»¥é€‰æ‹© pageã€allï¼Œè®¾ç½®æˆ all è¡¨ç¤ºæœç´¢æ‰€æœ‰é¡µé¢</li>
<li>limitï¼šé™åˆ¶æœç´¢çš„æ¡ç›®æ•°</li>
</ul>
<p>ç„¶åä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶next.yml`ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Local Search</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/hexo-generator-searchdb</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, trigger search by changing input.</span></span><br><span class="line">  <span class="comment"># If manual, trigger search by pressing enter key or search button.</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Show top n results per article, show all results by setting to -1</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># Unescape html strings to the readable one.</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Preload the search data when the page loads.</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h5 id="8-é…ç½®-hexo-ç«™ç‚¹çš„-footer-ä¿¡æ¯"><a href="#8-é…ç½®-hexo-ç«™ç‚¹çš„-footer-ä¿¡æ¯" class="headerlink" title="8 é…ç½® hexo ç«™ç‚¹çš„ footer ä¿¡æ¯"></a>8 é…ç½® hexo ç«™ç‚¹çš„ footer ä¿¡æ¯</h5><p>åº•éƒ¨ <code>footer</code> å¯ä»¥å¼€å…³æ˜¾ç¤º hexo ä¿¡æ¯ã€theme ä¿¡æ¯ã€å»ºç«™æ—¶é—´ç­‰ä¸ªæ€§åŒ–é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2018</span>        <span class="comment"># å»ºç«™å¼€å§‹æ—¶é—´</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">user</span>       <span class="comment"># è®¾ç½® å»ºç«™åˆå§‹æ—¶é—´å’Œè‡³ä»Šæ—¶é—´ä¸­é—´çš„å›¾æ ‡ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ª&#x27;å°äººåƒ&#x27;ï¼Œæ›´æ”¹userä¸ºheartå¯ä»¥å˜æˆä¸€ä¸ªå¿ƒ</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;#808080&quot;</span> <span class="comment"># æ›´æ”¹å›¾æ ‡çš„é¢œè‰²ï¼Œçº¢è‰²ä¸º&#x27;#ff0000&#x27;</span></span><br><span class="line">  <span class="attr">powered:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>     <span class="comment"># å¼€å¯hexoé©±åŠ¨</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">true</span>    <span class="comment"># å¼€å¯hexoç‰ˆæœ¬å·</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>     <span class="comment"># å¼€å¯ä¸»é¢˜é©±åŠ¨</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">true</span>    <span class="comment"># å¼€å¯ä¸»é¢˜ç‰ˆæœ¬å·</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="string">Hosted</span> <span class="string">by</span> <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">rel=&quot;external</span> <span class="string">nofollow&quot;</span> <span class="string">href=&quot;https://pages.coding.me&quot;&gt;&lt;b&gt;Coding</span> <span class="string">Pages&lt;/b&gt;&lt;/a&gt;</span> <span class="comment"># è¿™é‡Œçš„åº•éƒ¨æ ‡è¯†æ˜¯ä¸ºäº†æ·»åŠ coding pageæœåŠ¡æ—¶çš„ç‰ˆæƒå£°æ˜ æ‰“å¼€æ³¨é‡Šå°±å¯ä»¥çœ‹åˆ°åº•éƒ¨æœ‰ä¸€ä¸ª hosted by coding pages</span></span><br></pre></td></tr></table></figure>

<h6 id="9-é¦–é¡µæ–‡ç« ä¸å±•ç¤ºå…¨æ–‡æ˜¾ç¤ºæ‘˜è¦"><a href="#9-é¦–é¡µæ–‡ç« ä¸å±•ç¤ºå…¨æ–‡æ˜¾ç¤ºæ‘˜è¦" class="headerlink" title="9. é¦–é¡µæ–‡ç« ä¸å±•ç¤ºå…¨æ–‡æ˜¾ç¤ºæ‘˜è¦"></a>9. é¦–é¡µæ–‡ç« ä¸å±•ç¤ºå…¨æ–‡æ˜¾ç¤ºæ‘˜è¦</h6><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">scroll_to_more:</span> <span class="literal">true</span>      <span class="comment"># ç‚¹å‡»é˜…è¯»å…¨æ–‡åæ˜¯å¦è·³åˆ°&lt;!--more--&gt;æ ‡è®°å¤„,è®¾ä¸ºfalseæ—¶ç‚¹å‡»é˜…è¯»å…¨æ–‡å¯ä»¥ä»å¤´é˜…è¯»</span></span><br><span class="line"></span><br><span class="line"><span class="attr">save_scroll:</span> <span class="literal">false</span>        <span class="comment"># è‡ªåŠ¨ä¿å­˜æ¯ç¯‡æ–‡ç« æˆ–é¡µé¢ä¸Šä¸€æ¬¡æ»šåŠ¨çš„åœ°æ–¹</span></span><br><span class="line"></span><br><span class="line"><span class="attr">excerpt_description:</span> <span class="literal">true</span> <span class="comment"># è‡ªåŠ¨åœ¨é¦–é¡µå¯¹æ–‡ç« è¿›è¡Œæ‘˜è¦æè¿°ä½œä¸ºå‰è¨€æ–‡æœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="attr">auto_excerpt:</span>   <span class="comment"># æ˜¯å¦è‡ªåŠ¨æˆªå–æ‘˜è¦</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment"># è®¾ç½®ä¸ºtrueåˆ™è‡ªåŠ¨æˆªå–150å­—å½“åšé¦–é¡µæ‘˜è¦</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span>   <span class="comment"># è‡ªåŠ¨æˆªå–çš„å­—æ•°</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„éœ€è¦åœ¨mdæ–‡ä»¶å‰é¢åŠ <strong>yaml front matter</strong>ä¸­ç›¸å…³å…ƒç´ </p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">centoså®‰è£…redis</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2021-01 23:47:44</span> </span><br><span class="line"><span class="attr">categories:</span> <span class="string">&quot;redis&quot;</span> </span><br><span class="line"><span class="attr">tags:</span> </span><br><span class="line">     <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">æ ‡ç­¾äºŒ</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&quot;centos7 å®‰è£…redis&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="9-é¦–é¡µæ–‡ç« å±æ€§"><a href="#9-é¦–é¡µæ–‡ç« å±æ€§" class="headerlink" title="9. é¦–é¡µæ–‡ç« å±æ€§"></a>9. é¦–é¡µæ–‡ç« å±æ€§</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_meta:</span></span><br><span class="line">  <span class="attr">item_text:</span> <span class="literal">false</span>    <span class="comment"># è®¾ä¸ºtrue å¯ä»¥ä¸€è¡Œæ˜¾ç¤ºï¼Œæ–‡ç« çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">  <span class="attr">created_at:</span> <span class="literal">true</span>    <span class="comment"># æ˜¾ç¤ºåˆ›å»ºæ—¶é—´</span></span><br><span class="line">  <span class="attr">updated_at:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span>     <span class="comment"># æ˜¾ç¤ºä¿®æ”¹çš„æ—¶é—´</span></span><br><span class="line">    <span class="attr">another_day:</span> <span class="literal">true</span> <span class="comment"># è®¾trueæ—¶ï¼Œå¦‚æœåˆ›å»ºæ—¶é—´å’Œä¿®æ”¹æ—¶é—´ä¸€æ ·åˆ™æ˜¾ç¤ºä¸€ä¸ªæ—¶é—´</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">true</span>    <span class="comment"># æ˜¾ç¤ºåˆ†ç±»ä¿¡æ¯</span></span><br></pre></td></tr></table></figure>

<h5 id="10-é¡µé¢é˜…è¯»ç»Ÿè®¡"><a href="#10-é¡µé¢é˜…è¯»ç»Ÿè®¡" class="headerlink" title="10. é¡µé¢é˜…è¯»ç»Ÿè®¡"></a>10. é¡µé¢é˜…è¯»ç»Ÿè®¡</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span>              <span class="comment"># è®¾true å¼€å¯</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span>       <span class="comment"># æ€»é˜…è¯»äººæ•°ï¼ˆuvæ•°ï¼‰</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">user</span>  <span class="comment"># é˜…è¯»æ€»äººæ•°çš„å›¾æ ‡</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span>          <span class="comment"># æ€»é˜…è¯»æ¬¡æ•°ï¼ˆpvæ•°ï¼‰</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">eye</span>      <span class="comment"># é˜…è¯»æ€»æ¬¡æ•°çš„å›¾æ ‡</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span>           <span class="comment"># å¼€å¯å†…å®¹é˜…è¯»æ¬¡æ•°</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">eye</span>       <span class="comment"># å†…å®¹é¡µé˜…è¯»æ•°çš„å›¾æ ‡</span></span><br></pre></td></tr></table></figure>

<h5 id="11-å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿"><a href="#11-å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿" class="headerlink" title="11. å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿"></a>11. å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿</h5><p>é¦–å…ˆå®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">npm install hexo-symbols-count-<span class="built_in">time</span> --save #è¿è¡Œä¸€æ¬¡ä¼šæŠ¥é”™å¯¼è‡´é…ç½®ä¸ç”Ÿæ•ˆ</span><br><span class="line">npm install hexo-symbols-count-<span class="built_in">time</span> --save</span><br></pre></td></tr></table></figure>

<p>ä¸»é¢˜é…ç½®æ–‡ä»¶<code>_config.yml</code> ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span>  <span class="comment"># falseä¼šæ˜¾ç¤ºä¸€è¡Œ</span></span><br><span class="line">  <span class="attr">item_text_post:</span> <span class="literal">true</span>  <span class="comment"># æ˜¾ç¤ºå±æ€§åç§°,è®¾ä¸ºfalseååªæ˜¾ç¤ºå›¾æ ‡å’Œç»Ÿè®¡æ•°å­—,ä¸æ˜¾ç¤ºå±æ€§çš„æ–‡å­—</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">true</span> <span class="comment"># åº•éƒ¨footeræ˜¯å¦æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡å±æ€§æ–‡å­—</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">4</span>                <span class="comment"># è®¡ç®—å­—æ•°çš„ä¸€ä¸ªè®¾ç½®,æ²¡è®¾ç½®è¿‡</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span>              <span class="comment"># ä¸€åˆ†é’Ÿé˜…è¯»çš„å­—æ•°</span></span><br></pre></td></tr></table></figure>

<p>ç«™ç‚¹é…ç½®æ–‡ä»¶<code>next.yml</code> æ–°å¢å¦‚ä¸‹ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line"> <span class="comment">#æ–‡ç« å†…æ˜¯å¦æ˜¾ç¤º</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span></span><br><span class="line"> <span class="comment"># ç½‘é¡µåº•éƒ¨æ˜¯å¦æ˜¾ç¤º</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h5 id="12-å†…å®¹é¡µé‡Œçš„ä»£ç å—æ–°å¢å¤åˆ¶æŒ‰é’®"><a href="#12-å†…å®¹é¡µé‡Œçš„ä»£ç å—æ–°å¢å¤åˆ¶æŒ‰é’®" class="headerlink" title="12. å†…å®¹é¡µé‡Œçš„ä»£ç å—æ–°å¢å¤åˆ¶æŒ‰é’®"></a>12. å†…å®¹é¡µé‡Œçš„ä»£ç å—æ–°å¢å¤åˆ¶æŒ‰é’®</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line">  <span class="attr">copy_button:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span>      <span class="comment"># å¢åŠ å¤åˆ¶æŒ‰é’®çš„å¼€å…³</span></span><br><span class="line">    <span class="attr">show_result:</span> <span class="literal">false</span> <span class="comment"># ç‚¹å‡»å¤åˆ¶å®Œåæ˜¯å¦æ˜¾ç¤º å¤åˆ¶æˆåŠŸ ç»“æœæç¤º</span></span><br></pre></td></tr></table></figure>

<h5 id="13-é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ"><a href="#13-é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ" class="headerlink" title="13. é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ"></a>13. é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ</h5><p>é¼ æ ‡çš„ç‚¹å‡»çº¢å¿ƒç‰¹æ•ˆ<br>åœ¨/themes/next/source/js/srcä¸‹æ–°å»ºæ–‡ä»¶clicklove.js ï¼Œæ¥ç€æŠŠä¸‹é¢çš„ä»£ç æ‹·è´ç²˜è´´åˆ° clicklove.js æ–‡ä»¶ä¸­ï¼š7.8 nextæ²¡æœ‰srcæ–‡ä»¶å¤¹ï¼Œå…ˆå»ºä¸€ä¸ªsrcæ–‡ä»¶å¤¹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e,t,a</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>)</span>&#123;c(<span class="string">&quot;.heart&#123;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);&#125;.heart:after,.heart:before&#123;content: &#x27;&#x27;;width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;&#125;.heart:after&#123;top: -5px;&#125;.heart:before&#123;left: -5px;&#125;&quot;</span>),o(),r()&#125;<span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>;e&lt;d.length;e++)d[e].alpha&lt;=<span class="number">0</span>?(t.body.removeChild(d[e].el),d.splice(e,<span class="number">1</span>)):(d[e].y--,d[e].scale+=<span class="number">.004</span>,d[e].alpha-=<span class="number">.013</span>,d[e].el.style.cssText=<span class="string">&quot;left:&quot;</span>+d[e].x+<span class="string">&quot;px;top:&quot;</span>+d[e].y+<span class="string">&quot;px;opacity:&quot;</span>+d[e].alpha+<span class="string">&quot;;transform:scale(&quot;</span>+d[e].scale+<span class="string">&quot;,&quot;</span>+d[e].scale+<span class="string">&quot;) rotate(45deg);background:&quot;</span>+d[e].color+<span class="string">&quot;;z-index:99999&quot;</span>);requestAnimationFrame(r)&#125;<span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> t=<span class="string">&quot;function&quot;</span>==<span class="keyword">typeof</span> e.onclick&amp;&amp;e.onclick;e.onclick=<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;t&amp;&amp;t(),i(e)&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> a=t.createElement(<span class="string">&quot;div&quot;</span>);a.className=<span class="string">&quot;heart&quot;</span>,d.push(&#123;<span class="attr">el</span>:a,<span class="attr">x</span>:e.clientX-<span class="number">5</span>,<span class="attr">y</span>:e.clientY-<span class="number">5</span>,<span class="attr">scale</span>:<span class="number">1</span>,<span class="attr">alpha</span>:<span class="number">1</span>,<span class="attr">color</span>:s()&#125;),t.body.appendChild(a)&#125;<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> a=t.createElement(<span class="string">&quot;style&quot;</span>);a.type=<span class="string">&quot;text/css&quot;</span>;<span class="keyword">try</span>&#123;a.appendChild(t.createTextNode(e))&#125;<span class="keyword">catch</span>(t)&#123;a.styleSheet.cssText=e&#125;t.getElementsByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>].appendChild(a)&#125;<span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">&quot;rgb(&quot;</span>+~~(<span class="number">255</span>*<span class="built_in">Math</span>.random())+<span class="string">&quot;,&quot;</span>+~~(<span class="number">255</span>*<span class="built_in">Math</span>.random())+<span class="string">&quot;,&quot;</span>+~~(<span class="number">255</span>*<span class="built_in">Math</span>.random())+<span class="string">&quot;)&quot;</span>&#125;<span class="keyword">var</span> d=[];e.requestAnimationFrame=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="built_in">setTimeout</span>(e,<span class="number">1e3</span>/<span class="number">60</span>)&#125;&#125;(),n()&#125;(<span class="built_in">window</span>,<span class="built_in">document</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨\themes\next\layout_layout.swigæ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;/js/src/clicklove.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224214118.png" alt="image-20210224214118864"></p>
<h5 id="14-æ·»åŠ ç½‘é¡µé¡¶éƒ¨è¿›åº¦åŠ è½½æ¡"><a href="#14-æ·»åŠ ç½‘é¡µé¡¶éƒ¨è¿›åº¦åŠ è½½æ¡" class="headerlink" title="14. æ·»åŠ ç½‘é¡µé¡¶éƒ¨è¿›åº¦åŠ è½½æ¡"></a>14. æ·»åŠ ç½‘é¡µé¡¶éƒ¨è¿›åº¦åŠ è½½æ¡</h5><p>åœ¨ä¸»ç›®å½•ä¸‹è½½å®‰è£…Progress moduleï¼Œå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;theme-next-pace source&#x2F;lib&#x2F;pace</span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pace:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Themes list:</span></span><br><span class="line">  <span class="comment"># big-counter | bounce | barber-shop | center-atom | center-circle | center-radar | center-simple</span></span><br><span class="line">  <span class="comment"># corner-indicator | fill-left | flat-top | flash | loading-bar | mac-osx | material | minimal</span></span><br><span class="line">  <span class="comment">#theme: minimal</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">pace-theme-minimal</span></span><br></pre></td></tr></table></figure>

<h5 id="15-Footer-é¡µè„šè®¾ç½®"><a href="#15-Footer-é¡µè„šè®¾ç½®" class="headerlink" title="15. Footer / é¡µè„šè®¾ç½®"></a>15. Footer / é¡µè„šè®¾ç½®</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment"># Specify the date when the site was setup. If not defined, current year will be used.</span></span><br><span class="line">  <span class="comment">#since: 2015</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Icon between year and copyright info.</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="comment"># Icon name in Font Awesome. See: https://fontawesome.com/v4.7.0/icons/</span></span><br><span class="line">    <span class="comment"># `heart` is recommended with animation in red (#ff0000).</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">user</span></span><br><span class="line">    <span class="comment"># If you want to animate the icon, set it to true.</span></span><br><span class="line">    <span class="comment">## å›¾æ ‡çš„ä¸€ä¸ªåŠ¨ç”»æ•ˆæœï¼Œç±»ä¼¼äºå¿ƒè·³</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Change the color of icon, using Hex Code.</span></span><br><span class="line">    <span class="comment"># å›¾æ ‡é¢œè‰²ï¼Œå¯æ ¼å±€éœ€è¦è‡ªè¡Œä¿®æ”¹</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;#808080&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If not defined, `author` from Hexo `_config.yml` will be used.</span></span><br><span class="line">  <span class="attr">copyright:</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Powered by Hexo å­—æ ·ï¼Œä¸å–œæ¬¢å¯ä»¥è®¾ç½®ä¸º false</span></span><br><span class="line">  <span class="attr">powered:</span></span><br><span class="line">    <span class="comment"># Hexo link (Powered by Hexo).</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Version info of Hexo after Hexo link (vX.X.X).</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># ä¸»é¢˜å­—æ ·ï¼Œä¸å–œæ¬¢å¯ä»¥ false</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="comment"># Theme &amp; scheme info link (Theme - NexT.scheme).</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Version info of NexT after scheme info (vX.X.X).</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Beian ICP and gongan information for Chinese users. See: http://www.beian.miit.gov.cn, http://www.beian.gov.cn</span></span><br><span class="line">  <span class="comment"># å¤‡æ¡ˆä¿¡æ¯ï¼Œå¦‚æœç½‘ç«™æœ‰å¤‡æ¡ˆå·ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¡«å†™å¤‡æ¡ˆå·</span></span><br><span class="line">  <span class="attr">beian:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">icp:</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="16-Creative-Commons-æ–‡ç« ç‰ˆæƒ"><a href="#16-Creative-Commons-æ–‡ç« ç‰ˆæƒ" class="headerlink" title="16. Creative Commons / æ–‡ç« ç‰ˆæƒ"></a>16. Creative Commons / æ–‡ç« ç‰ˆæƒ</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Creative Commons 4.0 International License.</span></span><br><span class="line"><span class="comment"># See: https://creativecommons.org/share-your-work/licensing-types-examples</span></span><br><span class="line"><span class="comment"># Available values of license: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</span></span><br><span class="line"><span class="comment"># You can set a language value if you prefer a translated version of CC license, e.g. deed.zh</span></span><br><span class="line"><span class="comment"># CC licenses are available in 39 languages, you can find the specific and correct abbreviation you need on https://creativecommons.org</span></span><br><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ–‡ç«  .md æ–‡ä»¶ä¸­çš„ä¸Šéƒ¨ï¼Œæ·»åŠ  copyright: trueã€‚</p>
<h5 id="17-å¼€å¯æ–‡ç« ç›®å½•"><a href="#17-å¼€å¯æ–‡ç« ç›®å½•" class="headerlink" title="17.å¼€å¯æ–‡ç« ç›®å½•"></a>17.å¼€å¯æ–‡ç« ç›®å½•</h5><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶<strong>next.ym</strong>l</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Table of Contents in the Sidebar</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Automatically add list number to toc.</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If true, all words will placed on next lines if header width longer then sidebar width.</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If true, all level of TOC in a post will be displayed, rather than the activated part of it.</span></span><br><span class="line">  <span class="attr">expand_all:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Maximum heading depth of generated toc. You can set it in one post through `toc_max_depth` in Front-matter.</span></span><br><span class="line">  <span class="attr">max_depth:</span> <span class="number">6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="18-GitHub-Fork-Me"><a href="#18-GitHub-Fork-Me" class="headerlink" title="18. GitHub Fork Me"></a>18. GitHub Fork Me</h5><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶<strong>next.ym</strong>l</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># `Follow me on GitHub` banner in the top-right corner.</span></span><br><span class="line"><span class="attr">github_banner:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">permalink:</span> <span class="string">https://github.com/CNRF</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Follow</span> <span class="string">me</span> <span class="string">on</span> <span class="string">GitHub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="19-bookmark"><a href="#19-bookmark" class="headerlink" title="19.bookmark"></a>19.bookmark</h5><p>Bookmarkæ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œå…è®¸ç”¨æˆ·ä¿å­˜ä»–ä»¬çš„é˜…è¯»è¿›åº¦ã€‚ç”¨æˆ·åªéœ€å•å‡»é¡µé¢å·¦ä¸Šè§’çš„ä¹¦ç­¾å›¾æ ‡å³å¯ä¿å­˜æ»šåŠ¨ä½ç½®ã€‚å½“ä»–ä»¬ä¸‹æ¬¡è®¿é—®æ‚¨çš„åšå®¢æ—¶ï¼Œä»–ä»¬å¯ä»¥è‡ªåŠ¨æ¢å¤æ¯ä¸ªé¡µé¢çš„æœ€åæ»šåŠ¨ä½ç½®ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">bookmark:</span>	</span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Customize the color of the bookmark.	</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#222&quot;</span>	</span><br><span class="line">  <span class="comment"># If auto, save the reading progress when closing the page or clicking the bookmark-icon.	</span></span><br><span class="line">  <span class="comment"># If manual, only save it by clicking the bookmark-icon.	</span></span><br><span class="line">  <span class="attr">save:</span> <span class="string">auto</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="20-æ·»åŠ lazyload"><a href="#20-æ·»åŠ lazyload" class="headerlink" title="20. æ·»åŠ lazyload"></a>20. æ·»åŠ lazyload</h5><p>å¯¹äºå›¾ç‰‡è¿›è¡Œå»¶è¿ŸåŠ è½½ï¼Œè®¿é—®åˆ°å›¾ç‰‡ä½ç½®æ—¶æ‰å»è¯·æ±‚å›¾ç‰‡èµ„æºï¼Œè¿™æ ·å¯ä»¥æé«˜åšå®¢çš„è®¿é—®é€Ÿåº¦ï¼ŒèŠ‚çœæµé‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;theme-next-jquery-lazyload source&#x2F;lib&#x2F;jquery_lazyload</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="21-æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦"><a href="#21-æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦" class="headerlink" title="21.æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦"></a>21.æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦</h5><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶<strong>next.ym</strong>l</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Scroll percent label in b2t button.# # æ˜¯å¦æ˜¾ç¤ºé¡µé¢æµè§ˆç™¾åˆ†æ¯”</span></span><br><span class="line"><span class="attr">scrollpercent:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224220253.png" alt="image-20210224220253001"></p>
<h5 id="22-æ”¯æŒæ•°å­¦å…¬å¼"><a href="#22-æ”¯æŒæ•°å­¦å…¬å¼" class="headerlink" title="22. æ”¯æŒæ•°å­¦å…¬å¼"></a>22. æ”¯æŒæ•°å­¦å…¬å¼</h5><p>å¯èƒ½åœ¨ä¸€äº›æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªå…¬å¼ï¼Œmakdownæ˜¯æ”¯æŒçš„ï¼Œnextä¹Ÿæ”¯æŒã€‚</p>
<p>Next ä¸»é¢˜æä¾›äº†ä¸¤ä¸ªæ¸²æŸ“å¼•æ“ï¼Œåˆ†åˆ«æ˜¯ mathjax å’Œkatexï¼Œåè€…ç›¸å¯¹å‰è€…æ¥è¯´æ¸²æŸ“é€Ÿåº¦æ›´å¿«ï¼Œè€Œä¸”ä¸éœ€è¦ JavaScript çš„é¢å¤–æ”¯æŒï¼Œä½†åè€…æ”¯æŒçš„åŠŸèƒ½ç°åœ¨è¿˜ä¸å¦‚å‰è€…ä¸°å¯Œï¼Œå…·ä½“çš„å¯¹æ¯”å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://theme-next.org/docs/third-party-services/math-equations%E3%80%82">https://theme-next.org/docs/third-party-services/math-equationsã€‚</a></p>
<p>è¿™é‡Œé€‰æ‹© mathjax ,é€šè¿‡ä¿®æ”¹é…ç½®å³å¯å¯ç”¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm uninstall hexo-renderer-marked --save</span><br><span class="line">sudo npm install hexo-renderer-kramed --save</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šä½¿ç”¨çš„æ—¶å€™éœ€è¦åœ¨ <strong>æ–‡ç« å¼€å¤´åŠ ä¸Šmathjax: true</strong></p>
<h5 id="23-æ·»åŠ éŸ³ä¹å’Œè§†é¢‘"><a href="#23-æ·»åŠ éŸ³ä¹å’Œè§†é¢‘" class="headerlink" title="23.æ·»åŠ éŸ³ä¹å’Œè§†é¢‘"></a>23.æ·»åŠ éŸ³ä¹å’Œè§†é¢‘</h5><h6 id="2-3-2-ç½‘æ˜“äº‘"><a href="#2-3-2-ç½‘æ˜“äº‘" class="headerlink" title="2.3.2 ç½‘æ˜“äº‘"></a>2.3.2 ç½‘æ˜“äº‘</h6><p>æ‰“å¼€ç½‘æ˜“äº‘ï¼Œæ‰¾åˆ°ä½ æƒ³è¦æ·»åŠ çš„æ­Œæ›²æˆ–è€…æ­Œå•ï¼Œç‚¹ç”Ÿæˆ<code>å¤–é“¾æ’­æ”¾å™¨</code> ç„¶åå¤åˆ¶ä»£ç </p>
<p>å°†ä»£ç æ”¾åˆ°â€¦<code>/themes/hexo-theme-next/layout/_macro/sidebar.swig</code>æ–‡ä»¶ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--æ–°å¢163æ’­æ”¾å™¨--&gt;</span><br><span class="line">&lt;iframe frameborder&#x3D;&quot;no&quot; border&#x3D;&quot;0&quot; marginwidth&#x3D;&quot;0&quot; marginheight&#x3D;&quot;0&quot; width&#x3D;298 height&#x3D;52 src&#x3D;&quot;&#x2F;&#x2F;music.163.com&#x2F;outchain&#x2F;player?type&#x3D;0&amp;id&#x3D;756579097&amp;auto&#x3D;0&amp;height&#x3D;32&quot;&gt;&lt;&#x2F;iframe&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210225094310.png" alt="image-20210225094310438"></p>
<h6 id="2-3-1-è§†é¢‘"><a href="#2-3-1-è§†é¢‘" class="headerlink" title="2.3.1 è§†é¢‘"></a>2.3.1 è§†é¢‘</h6><p>1ï¼‰ç›´æ¥ç”¨ HTML çš„æ ‡ç­¾ï¼Œå†™æ³•å¦‚ä¸‹ï¼š</p>
<p>å¤åˆ¶<br>Your browser does not support the video tag.<br>2ï¼‰ç”¨æ’ä»¶ï¼Œå¯æ”¯æŒå¼¹å¹•ï¼Œé¦–å…ˆåœ¨ç«™ç‚¹æ–‡ä»¶å¤¹æ ¹ç›®å½•å®‰è£…æ’ä»¶ï¼š</p>
<p>å¤åˆ¶<br>npm install hexo-tag-dplayer â€“save<br>ç„¶åæ–‡ç« ä¸­çš„å†™æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% dplayer â€œurl&#x3D;https:&#x2F;&#x2F;ä»€ä¹ˆä»€ä¹ˆä»€ä¹ˆ.mp4â€ â€œhttps:&#x2F;&#x2F;å°é¢å›¾.jpgâ€ â€œapi&#x3D;https:&#x2F;&#x2F;api.prprpr.me&#x2F;dplayer&#x2F;â€ â€œid&#x3D;â€ â€œloop&#x3D;falseâ€ %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% dplayer &quot;url&#x3D;https:&#x2F;&#x2F;moeplayer.b0.upaiyun.com&#x2F;dplayer&#x2F;hikarunara.mp4&quot; &quot;api&#x3D;https:&#x2F;&#x2F;api.prprpr.me&#x2F;dplayer3&#x2F;&quot; &quot;addition&#x3D;https:&#x2F;&#x2F;api.prprpr.me&#x2F;dplayer3&#x2F;v2&#x2F;bilibili?aid&#x3D;120040&quot; &quot;pic&#x3D;https:&#x2F;&#x2F;moeplayer.b0.upaiyun.com&#x2F;dplayer&#x2F;hikarunara.jpg&quot; &quot;id&#x3D;9E2E3368B56CDBB4&quot; &quot;loop&#x3D;yes&quot; &quot;theme&#x3D;#FADFA3&quot; &quot;autoplay&#x3D;false&quot; &quot;token&#x3D;tokendemo&quot; %&#125;  </span><br><span class="line">&#123;% dplayer &#39;url&#x3D;some.mp4&#39; &quot;id&#x3D;someid&quot; &quot;api&#x3D;https:&#x2F;&#x2F;api.prprpr.me&#x2F;dplayer&#x2F;&quot; &quot;addition&#x3D;&#x2F;some.json&quot; &#39;code&#x3D;player.on(&quot;loadstart&quot;,function()&#123;console.log(&quot;loadstart&quot;)&#125;)&#39; &quot;autoplay&quot; %&#125;</span><br></pre></td></tr></table></figure>

<p>è¦ä½¿ç”¨å¼¹å¹•ï¼Œå¿…é¡»æœ‰apiå’Œidä¸¤é¡¹ï¼Œå¹¶ä¸”è‹¥ä½¿ç”¨çš„æ˜¯å®˜æ–¹çš„ api åœ°å€ï¼ˆå³ä¸Šé¢çš„ï¼‰ï¼Œid çš„å€¼ä¸èƒ½ä¸è¿™ä¸ªåˆ—è¡¨çš„å€¼ä¸€æ ·ã€‚id çš„å€¼è‡ªå·±éšä¾¿å–ï¼Œå”¯ä¸€è¦æ±‚å°±æ˜¯å‰é¢è¿™ç‚¹ã€‚å¦‚æœå”¯ä¸€è¦æ±‚éš¾å€’äº†ä½ ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·å°†ä¸€æ®µä¸ä¼—ä¸åŒçš„æ–‡å­—?ç”Ÿæˆä¸€æ®µçœ‹èµ·æ¥æ¯«æ— æ„ä¹‰çš„å“ˆå¸Œå€¼ï¼Œè¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¥½å¤šäº†ã€‚</p>
<p>è¦ä½¿ç”¨å¼¹å¹•ï¼Œå¿…é¡»æœ‰apiå’Œidä¸¤é¡¹ï¼Œå¹¶ä¸”è‹¥ä½¿ç”¨çš„æ˜¯å®˜æ–¹çš„ api åœ°å€ï¼ˆå³ä¸Šé¢çš„ï¼‰ï¼Œid çš„å€¼ä¸èƒ½ä¸è¿™ä¸ªåˆ—è¡¨çš„å€¼ä¸€æ ·ã€‚id çš„å€¼è‡ªå·±éšä¾¿å–ï¼Œå”¯ä¸€è¦æ±‚å°±æ˜¯å‰é¢è¿™ç‚¹ã€‚å¦‚æœå”¯ä¸€è¦æ±‚éš¾å€’äº†ä½ ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·å°†ä¸€æ®µä¸ä¼—ä¸åŒçš„æ–‡å­—?ç”Ÿæˆä¸€æ®µçœ‹èµ·æ¥æ¯«æ— æ„ä¹‰çš„å“ˆå¸Œå€¼ï¼Œè¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¥½å¤šäº†ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™ä¸ªæ’ä»¶çš„åŠŸèƒ½è¿˜æœ‰å¾ˆå¤šï¼Œå¯ä»¥å» README å’Œè¿™æ’ä»¶çš„ã€Œæ¯äº²ã€Dplayer çš„å®˜æ–¹æ–‡æ¡£çœ‹çœ‹ã€‚</p>
<h5 id="24-æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°"><a href="#24-æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°" class="headerlink" title="24. æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°"></a>24. æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°</h5><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶<strong>next.ym</strong>l</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="attr">postBodyEnd:</span> <span class="string">source/_data/post-body-end.swig</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è·¯å¾„ /source/_data ä¸‹åˆ›å»º/ä¿®æ”¹ post-body-end.swigæ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% <span class="keyword">if</span> not is_index %&#125;</span><br><span class="line">        &lt;div style=<span class="string">&quot;text-align:center;color: #ccc;font-size:14px;&quot;</span>&gt;-------------æœ¬æ–‡ç»“æŸ&lt;i class=<span class="string">&quot;fa fa-paw&quot;</span>&gt;&lt;/i&gt;æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------&lt;/div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h5 id="25-ä¸»é¢˜åŠæ ‡é¢˜æ èƒŒæ™¯å›¾"><a href="#25-ä¸»é¢˜åŠæ ‡é¢˜æ èƒŒæ™¯å›¾" class="headerlink" title="25.ä¸»é¢˜åŠæ ‡é¢˜æ èƒŒæ™¯å›¾"></a>25.ä¸»é¢˜åŠæ ‡é¢˜æ èƒŒæ™¯å›¾</h5><p>é¦–å…ˆä¸»é¢˜é…ç½®æ–‡ä»¶å–æ¶ˆæ³¨é‡Š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">custom_file_path:</span><br><span class="line">  style: <span class="built_in">source</span>/_data/styles.styl</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸»ç›®å½•source/_dataåˆ›å»º/ä¿®æ”¹ <strong>styles.styl</strong>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  background: url(https://source.unsplash.com/random/1600x900?wallpapers);//è‡ªå·±å–œæ¬¢çš„å›¾ç‰‡åœ°å€</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">background-attachment</span>:fixed; <span class="comment">//ä¸é‡å¤</span></span><br><span class="line">  <span class="attribute">background-size</span>: cover;      <span class="comment">//å¡«å……</span></span><br><span class="line">  <span class="attribute">background-position</span>:<span class="number">50%</span> <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åšå®¢å†…å®¹é€æ˜åŒ–</span></span><br><span class="line"><span class="comment">//æ–‡ç« å†…å®¹çš„é€æ˜åº¦è®¾ç½®</span></span><br><span class="line"><span class="selector-class">.content-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¾§è¾¹æ¡†çš„é€æ˜åº¦è®¾ç½®</span></span><br><span class="line"><span class="selector-class">.sidebar</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//èœå•æ çš„é€æ˜åº¦è®¾ç½®</span></span><br><span class="line"><span class="selector-class">.header-inner</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: rgba(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœç´¢æ¡†ï¼ˆlocal-searchï¼‰çš„é€æ˜åº¦è®¾ç½®</span></span><br><span class="line"><span class="selector-class">.popup</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="26-ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„-å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡"><a href="#26-ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„-å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡" class="headerlink" title="26.  ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„#å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡"></a>26.  ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„#å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡</h5><p>ä¿®æ”¹æ¨¡æ¿<code>/themes/next/layout/_macro/post.swig</code></p>
<p>æœç´¢ rel=â€tagâ€ï¼Œä¿®æ”¹æ­¤è¡Œä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- &lt;a href&#x3D;&quot;&#123;&#123; url_for(tag.path) &#125;&#125;&quot; rel&#x3D;&quot;tag&quot;&gt;&#123;&#123; tag_indicate &#125;&#125; &#123;&#123; tag.name &#125;&#125;&lt;&#x2F;a&gt;</span><br><span class="line">æ›¿æ¢ä¸º</span><br><span class="line"> &lt;a href&#x3D;&quot;&#123;&#123; url_for(tag.path) &#125;&#125;&quot; rel&#x3D;&quot;tag&quot;&gt;&lt;i class&#x3D;&quot;fa fa-tag&quot;&gt;&lt;&#x2F;i&gt; &#123;&#123; tag.name &#125;&#125;&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<h5 id="27-ä¿®æ”¹æ–‡ç« é“¾æ¥"><a href="#27-ä¿®æ”¹æ–‡ç« é“¾æ¥" class="headerlink" title="27.ä¿®æ”¹æ–‡ç« é“¾æ¥"></a>27.ä¿®æ”¹æ–‡ç« é“¾æ¥</h5><p>åœ¨åšæ¬¡ä¼˜åŒ–ä¹‹å‰ï¼Œhexo-nextæ–‡ç« é“¾æ¥é»˜è®¤çš„ç”Ÿæˆè§„åˆ™æ˜¯ï¼š<code>:year/:month/:day/:title</code>ï¼Œæ˜¯æŒ‰ç…§å¹´ã€æœˆã€æ—¥ã€æ ‡é¢˜æ¥ç”Ÿæˆçš„ã€‚<br>æ¯”å¦‚ï¼š<code>https://zxiaoxuan.github.io/2019/08/12/hello-world/</code> è¿™æ ·ï¼Œå¦‚æœæ–‡ç« æ ‡é¢˜æ˜¯ä¸­æ–‡çš„è¯ï¼ŒURLé“¾æ¥æ˜¯ä¹Ÿä¼šæ˜¯ä¸­æ–‡ï¼Œ</p>
<p><strong>å®‰è£…æ’ä»¶</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰§è¡Œæ­¤å‘½ä»¤å¯èƒ½ä¼šä¸æˆåŠŸï¼Œæç¤ºä½ ç¼ºå°‘ç›¸åº”çš„ä¾èµ–ï¼Œæ¯”å¦‚babel-eslintã€mini-css-extract-pluginã€webpack-cliâ€¦<br>ä½¿ç”¨npmå‘½ä»¤å®‰è£…å³å¯ï¼Œæ¯”å¦‚npm install <a href="mailto:&#101;&#115;&#108;&#105;&#x6e;&#116;&#x40;&#x34;&#46;&#x78;">&#101;&#115;&#108;&#105;&#x6e;&#116;&#x40;&#x34;&#46;&#x78;</a> babel-eslint@8 â€“save-dev</p>
</blockquote>
<p>ä¿®æ”¹æ ¹ç›®å½•ç«™ç‚¹é…ç½®æ–‡ä»¶<code>config.yml</code>ï¼Œæ”¹ä¸ºï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink/</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line">	<span class="attr">alg:</span> <span class="string">crc32</span>   <span class="comment">#ç®—æ³•ï¼š crc16(default) and crc32</span></span><br><span class="line">	<span class="attr">rep:</span> <span class="string">hex</span>     <span class="comment">#è¿›åˆ¶ï¼š dec(default) and hex</span></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„é“¾æ¥å°†ä¼šæ˜¯è¿™æ ·çš„(å®˜æ–¹æ ·ä¾‹)ï¼š<br><strong>å››ç§å¯ä¾›é€‰æ‹©</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crc16 &amp; hex</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;posts&#x2F;66c8.html</span><br><span class="line"></span><br><span class="line">crc16 &amp; dec</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;posts&#x2F;65535.html</span><br><span class="line">crc32 &amp; hex</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;posts&#x2F;8ddf18fb.html</span><br><span class="line"></span><br><span class="line">crc32 &amp; dec</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;posts&#x2F;1690090958.html</span><br><span class="line">12345678910</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆå®Œåï¼ŒåŸ<code>md</code>æ–‡ä»¶çš„<code>Front-matter</code> å†…ä¼šå¢åŠ <code>abbrlink</code> å­—æ®µï¼Œå€¼ä¸ºç”Ÿæˆçš„ID ã€‚è¿™ä¸ªå­—æ®µç¡®ä¿äº†åœ¨æˆ‘ä»¬ä¿®æ”¹äº†Front-matter å†…çš„åšå®¢æ ‡é¢˜titleæˆ–åˆ›å»ºæ—¥æœŸdateå­—æ®µä¹‹åè€Œä¸ä¼šæ”¹å˜é“¾æ¥åœ°å€ã€‚</p>
<h5 id="28-è®¾ç½®tagç•Œé¢å½©è‰²æ ‡ç­¾"><a href="#28-è®¾ç½®tagç•Œé¢å½©è‰²æ ‡ç­¾" class="headerlink" title="28. è®¾ç½®tagç•Œé¢å½©è‰²æ ‡ç­¾"></a>28. è®¾ç½®tagç•Œé¢å½©è‰²æ ‡ç­¾</h5><p>åœ¨<code>/themes/next/layout/</code>ç›®å½•ä¸‹ï¼Œæ–°å¢<code>tag-color.swig</code>æ–‡ä»¶ï¼ŒåŠ å…¥ä¸‹æ–¹ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">     <span class="keyword">var</span> alltags = <span class="built_in">document</span>.getElementsByClassName(<span class="string">&#x27;tag-cloud-tags&#x27;</span>);</span><br><span class="line">     <span class="keyword">var</span> tags = alltags[<span class="number">0</span>].getElementsByTagName(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> i = tags.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">       <span class="keyword">var</span> r=<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*<span class="number">75</span>+<span class="number">130</span>);</span><br><span class="line">       <span class="keyword">var</span> g=<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*<span class="number">75</span>+<span class="number">100</span>);</span><br><span class="line">       <span class="keyword">var</span> b=<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*<span class="number">75</span>+<span class="number">80</span>);</span><br><span class="line">       tags[i].style.background = <span class="string">&quot;rgb(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+g+<span class="string">&quot;,&quot;</span>+b+<span class="string">&quot;)&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .tag-cloud-tags&#123;</span><br><span class="line">    <span class="comment">/*font-family: Helvetica, Tahoma, Arial;*/</span></span><br><span class="line">    <span class="comment">/*font-weight: 100;*/</span></span><br><span class="line">    text-align: center;</span><br><span class="line">    counter-reset: tags;</span><br><span class="line">  &#125;</span><br><span class="line">  .tag-cloud-tags a&#123;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    padding-right: 5px;</span><br><span class="line">    padding-left: 5px;</span><br><span class="line">    margin: 8px 5px 0px 0px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tag-cloud-tags a:hover&#123;</span><br><span class="line">     box-shadow: 0px 5px 15px 0px rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">.4</span>);</span><br><span class="line">     transform: scale(<span class="number">1.1</span>);</span><br><span class="line">     <span class="comment">/*box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);*/</span></span><br><span class="line">     transition-duration: <span class="number">0.</span>15s;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨/themes/next/layout/page.swig/ä¸­å¼•å…¥tag-color.swigï¼š</p>
<p>åœ¨ä¸‹æ–¹åŠ ä¸Š <code>&#123;% include 'tag-color.swig' %&#125;</code> ä»£ç </p>
<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224235234.png" alt="image-20210224235234310"></p>
<h6 id="æŠŠæ ‡ç­¾æ”¾åˆ°é¦–é¡µ"><a href="#æŠŠæ ‡ç­¾æ”¾åˆ°é¦–é¡µ" class="headerlink" title="æŠŠæ ‡ç­¾æ”¾åˆ°é¦–é¡µ"></a>æŠŠæ ‡ç­¾æ”¾åˆ°é¦–é¡µ</h6><p>åœ¨è·¯å¾„ï¼š<code>/themes/next/layout/index.swig</code> ä¸­<code>&#123;% block content %&#125;</code>ä¸‹é¢æ·»åŠ ä¸‹æ–¹ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;tag-cloud&quot;&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;tag-cloud-tags&quot; id&#x3D;&quot;tags&quot;&gt;</span><br><span class="line">	&#123;&#123; tagcloud(&#123;min_font: 16, max_font: 16, amount: 300, color: true, start_color: &#39;#fff&#39;, end_color: &#39;#fff&#39;&#125;) &#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&#123;% include &#39;tag-color.swig&#39; %&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210224235556.png" alt="image-20210224235556099"></p>
<h5 id="29-å½’æ¡£é¡µé¢å¢åŠ æœˆä»½å½’æ¡£"><a href="#29-å½’æ¡£é¡µé¢å¢åŠ æœˆä»½å½’æ¡£" class="headerlink" title="29.å½’æ¡£é¡µé¢å¢åŠ æœˆä»½å½’æ¡£"></a>29.å½’æ¡£é¡µé¢å¢åŠ æœˆä»½å½’æ¡£</h5><p>åœ¨==themes/next/source/css/_common/components/post/post-collapse.styl==æ–°å¢ä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è®¾ç½®ä¹Ÿæœˆä»½æ ·å¼</span></span><br><span class="line">.collection-month &#123; <span class="comment">//å±æ€§ä¸ä¸€å®šæ˜¯è¿™ä¸ªåå­—ï¼Œå…·ä½“å’Œä½ åœ¨swigæ–‡ä»¶ä¸­ä¸ºå…¶é…ç½®çš„classå€¼æœ‰å…³ï¼Œç…§ç€å®ƒæ¥</span></span><br><span class="line">  font-size: $font-size-largest;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  margin: 60px <span class="number">0</span>;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  &amp;::before &#123;</span><br><span class="line">    background: $grey;</span><br><span class="line">    border-radius: <span class="number">50</span>%;</span><br><span class="line">    content: <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    height: 8px;</span><br><span class="line">    left: <span class="number">0</span>;</span><br><span class="line">    margin-left: -4px;</span><br><span class="line">    margin-top: -4px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: <span class="number">50</span>%;</span><br><span class="line">    width: 8px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨==themes/next/layout/_macro/post-collapse.swig==ä¸­æ–°å¢ä»£ç ï¼Œä½ç½®å¦‚å›¾</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">===========================================</span><br><span class="line">     &#123;%- set current_month = <span class="string">&#x27;0&#x27;</span> %&#125;</span><br><span class="line">===========================================</span><br><span class="line"> &#123;%- set month = date(post.date, <span class="string">&#x27;MMM&#x27;</span>) %&#125;</span><br><span class="line">  &#123;%- <span class="keyword">if</span> month !== current_month %&#125;</span><br><span class="line">    &#123;%- set current_month = month %&#125;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;collection-month&quot;</span>&gt;</span><br><span class="line">      &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;collection-header&quot;</span>&gt;&#123;&#123; current_month &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &#123;%- endif %&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/CNRF/image/raw/master/img/20210226093409.png" alt="image-20210226093408957"></p>
]]></content>
      <categories>
        <category>Hexo</category>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Next</tag>
      </tags>
  </entry>
</search>
